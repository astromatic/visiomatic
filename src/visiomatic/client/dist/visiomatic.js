(()=>{var If=Object.create;var Ma=Object.defineProperty;var Of=Object.getOwnPropertyDescriptor;var Df=Object.getOwnPropertyNames;var Rf=Object.getPrototypeOf,zf=Object.prototype.hasOwnProperty;var Ff=(e,t,n)=>t in e?Ma(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Vr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Kn=(e,t)=>{for(var n in t)Ma(e,n,{get:t[n],enumerable:!0})},Nf=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Df(t))!zf.call(e,a)&&a!==n&&Ma(e,a,{get:()=>t[a],enumerable:!(s=Of(t,a))||s.enumerable});return e};var Bt=(e,t,n)=>(n=e!=null?If(Rf(e)):{},Nf(t||!e||!e.__esModule?Ma(n,"default",{value:e,enumerable:!0}):n,e));var st=(e,t,n)=>(Ff(e,typeof t!="symbol"?t+"":t,n),n);var Vt=Vr((Sa,th)=>{(function(e,t){typeof Sa=="object"&&typeof th<"u"?t(Sa):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.leaflet={}))})(Sa,function(e){"use strict";var t="1.9.4";function n(o){var h,p,g,b;for(p=1,g=arguments.length;p<g;p++){b=arguments[p];for(h in b)o[h]=b[h]}return o}var s=Object.create||function(){function o(){}return function(h){return o.prototype=h,new o}}();function a(o,h){var p=Array.prototype.slice;if(o.bind)return o.bind.apply(o,p.call(arguments,1));var g=p.call(arguments,2);return function(){return o.apply(h,g.length?g.concat(p.call(arguments)):arguments)}}var r=0;function l(o){return"_leaflet_id"in o||(o._leaflet_id=++r),o._leaflet_id}function u(o,h,p){var g,b,S,O;return O=function(){g=!1,b&&(S.apply(p,b),b=!1)},S=function(){g?b=arguments:(o.apply(p,arguments),setTimeout(O,h),g=!0)},S}function f(o,h,p){var g=h[1],b=h[0],S=g-b;return o===g&&p?o:((o-b)%S+S)%S+b}function m(){return!1}function _(o,h){if(h===!1)return o;var p=Math.pow(10,h===void 0?6:h);return Math.round(o*p)/p}function v(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function y(o){return v(o).split(/\s+/)}function w(o,h){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?s(o.options):{});for(var p in h)o.options[p]=h[p];return o.options}function k(o,h,p){var g=[];for(var b in o)g.push(encodeURIComponent(p?b.toUpperCase():b)+"="+encodeURIComponent(o[b]));return(!h||h.indexOf("?")===-1?"?":"&")+g.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function E(o,h){return o.replace(A,function(p,g){var b=h[g];if(b===void 0)throw new Error("No value provided for variable "+p);return typeof b=="function"&&(b=b(h)),b})}var D=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function z(o,h){for(var p=0;p<o.length;p++)if(o[p]===h)return p;return-1}var V="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var H=0;function X(o){var h=+new Date,p=Math.max(0,16-(h-H));return H=h+p,window.setTimeout(o,p)}var $=window.requestAnimationFrame||W("RequestAnimationFrame")||X,G=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function B(o,h,p){if(p&&$===X)o.call(h);else return $.call(window,a(o,h))}function ot(o){o&&G.call(window,o)}var ut={__proto__:null,extend:n,create:s,bind:a,get lastId(){return r},stamp:l,throttle:u,wrapNum:f,falseFn:m,formatNum:_,trim:v,splitWords:y,setOptions:w,getParamString:k,template:E,isArray:D,indexOf:z,emptyImageUrl:V,requestFn:$,cancelFn:G,requestAnimFrame:B,cancelAnimFrame:ot};function Q(){}Q.extend=function(o){var h=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=h.__super__=this.prototype,g=s(p);g.constructor=h,h.prototype=g;for(var b in this)Object.prototype.hasOwnProperty.call(this,b)&&b!=="prototype"&&b!=="__super__"&&(h[b]=this[b]);return o.statics&&n(h,o.statics),o.includes&&($t(o.includes),n.apply(null,[g].concat(o.includes))),n(g,o),delete g.statics,delete g.includes,g.options&&(g.options=p.options?s(p.options):{},n(g.options,o.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var S=0,O=g._initHooks.length;S<O;S++)g._initHooks[S].call(this)}},h},Q.include=function(o){var h=this.prototype.options;return n(this.prototype,o),o.options&&(this.prototype.options=h,this.mergeOptions(o.options)),this},Q.mergeOptions=function(o){return n(this.prototype.options,o),this},Q.addInitHook=function(o){var h=Array.prototype.slice.call(arguments,1),p=typeof o=="function"?o:function(){this[o].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function $t(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=D(o)?o:[o];for(var h=0;h<o.length;h++)o[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var St={on:function(o,h,p){if(typeof o=="object")for(var g in o)this._on(g,o[g],h);else{o=y(o);for(var b=0,S=o.length;b<S;b++)this._on(o[b],h,p)}return this},off:function(o,h,p){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var g in o)this._off(g,o[g],h);else{o=y(o);for(var b=arguments.length===1,S=0,O=o.length;S<O;S++)b?this._off(o[S]):this._off(o[S],h,p)}return this},_on:function(o,h,p,g){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(o,h,p)===!1){p===this&&(p=void 0);var b={fn:h,ctx:p};g&&(b.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(b)}},_off:function(o,h,p){var g,b,S;if(!!this._events&&(g=this._events[o],!!g)){if(arguments.length===1){if(this._firingCount)for(b=0,S=g.length;b<S;b++)g[b].fn=m;delete this._events[o];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var O=this._listens(o,h,p);if(O!==!1){var F=g[O];this._firingCount&&(F.fn=m,this._events[o]=g=g.slice()),g.splice(O,1)}}},fire:function(o,h,p){if(!this.listens(o,p))return this;var g=n({},h,{type:o,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var b=this._events[o];if(b){this._firingCount=this._firingCount+1||1;for(var S=0,O=b.length;S<O;S++){var F=b[S],j=F.fn;F.once&&this.off(o,j,F.ctx),j.call(F.ctx||this,g)}this._firingCount--}}return p&&this._propagateEvent(g),this},listens:function(o,h,p,g){typeof o!="string"&&console.warn('"string" type argument expected');var b=h;typeof h!="function"&&(g=!!h,b=void 0,p=void 0);var S=this._events&&this._events[o];if(S&&S.length&&this._listens(o,b,p)!==!1)return!0;if(g){for(var O in this._eventParents)if(this._eventParents[O].listens(o,h,p,g))return!0}return!1},_listens:function(o,h,p){if(!this._events)return!1;var g=this._events[o]||[];if(!h)return!!g.length;p===this&&(p=void 0);for(var b=0,S=g.length;b<S;b++)if(g[b].fn===h&&g[b].ctx===p)return b;return!1},once:function(o,h,p){if(typeof o=="object")for(var g in o)this._on(g,o[g],h,!0);else{o=y(o);for(var b=0,S=o.length;b<S;b++)this._on(o[b],h,p,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[l(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[l(o)],this},_propagateEvent:function(o){for(var h in this._eventParents)this._eventParents[h].fire(o.type,n({layer:o.target,propagatedFrom:o.target},o),!0)}};St.addEventListener=St.on,St.removeEventListener=St.clearAllEventListeners=St.off,St.addOneTimeEventListener=St.once,St.fireEvent=St.fire,St.hasEventListeners=St.listens;var kt=Q.extend(St);function tt(o,h,p){this.x=p?Math.round(o):o,this.y=p?Math.round(h):h}var At=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};tt.prototype={clone:function(){return new tt(this.x,this.y)},add:function(o){return this.clone()._add(nt(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(nt(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new tt(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new tt(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=At(this.x),this.y=At(this.y),this},distanceTo:function(o){o=nt(o);var h=o.x-this.x,p=o.y-this.y;return Math.sqrt(h*h+p*p)},equals:function(o){return o=nt(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=nt(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function nt(o,h,p){return o instanceof tt?o:D(o)?new tt(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new tt(o.x,o.y):new tt(o,h,p)}function wt(o,h){if(!!o)for(var p=h?[o,h]:o,g=0,b=p.length;g<b;g++)this.extend(p[g])}wt.prototype={extend:function(o){var h,p;if(!o)return this;if(o instanceof tt||typeof o[0]=="number"||"x"in o)h=p=nt(o);else if(o=te(o),h=o.min,p=o.max,!h||!p)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=p.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(o){return nt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return nt(this.min.x,this.max.y)},getTopRight:function(){return nt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var h,p;return typeof o[0]=="number"||o instanceof tt?o=nt(o):o=te(o),o instanceof wt?(h=o.min,p=o.max):h=p=o,h.x>=this.min.x&&p.x<=this.max.x&&h.y>=this.min.y&&p.y<=this.max.y},intersects:function(o){o=te(o);var h=this.min,p=this.max,g=o.min,b=o.max,S=b.x>=h.x&&g.x<=p.x,O=b.y>=h.y&&g.y<=p.y;return S&&O},overlaps:function(o){o=te(o);var h=this.min,p=this.max,g=o.min,b=o.max,S=b.x>h.x&&g.x<p.x,O=b.y>h.y&&g.y<p.y;return S&&O},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var h=this.min,p=this.max,g=Math.abs(h.x-p.x)*o,b=Math.abs(h.y-p.y)*o;return te(nt(h.x-g,h.y-b),nt(p.x+g,p.y+b))},equals:function(o){return o?(o=te(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function te(o,h){return!o||o instanceof wt?o:new wt(o,h)}function Dt(o,h){if(!!o)for(var p=h?[o,h]:o,g=0,b=p.length;g<b;g++)this.extend(p[g])}Dt.prototype={extend:function(o){var h=this._southWest,p=this._northEast,g,b;if(o instanceof Pt)g=o,b=o;else if(o instanceof Dt){if(g=o._southWest,b=o._northEast,!g||!b)return this}else return o?this.extend(Mt(o)||Ct(o)):this;return!h&&!p?(this._southWest=new Pt(g.lat,g.lng),this._northEast=new Pt(b.lat,b.lng)):(h.lat=Math.min(g.lat,h.lat),h.lng=Math.min(g.lng,h.lng),p.lat=Math.max(b.lat,p.lat),p.lng=Math.max(b.lng,p.lng)),this},pad:function(o){var h=this._southWest,p=this._northEast,g=Math.abs(h.lat-p.lat)*o,b=Math.abs(h.lng-p.lng)*o;return new Dt(new Pt(h.lat-g,h.lng-b),new Pt(p.lat+g,p.lng+b))},getCenter:function(){return new Pt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Pt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Pt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof Pt||"lat"in o?o=Mt(o):o=Ct(o);var h=this._southWest,p=this._northEast,g,b;return o instanceof Dt?(g=o.getSouthWest(),b=o.getNorthEast()):g=b=o,g.lat>=h.lat&&b.lat<=p.lat&&g.lng>=h.lng&&b.lng<=p.lng},intersects:function(o){o=Ct(o);var h=this._southWest,p=this._northEast,g=o.getSouthWest(),b=o.getNorthEast(),S=b.lat>=h.lat&&g.lat<=p.lat,O=b.lng>=h.lng&&g.lng<=p.lng;return S&&O},overlaps:function(o){o=Ct(o);var h=this._southWest,p=this._northEast,g=o.getSouthWest(),b=o.getNorthEast(),S=b.lat>h.lat&&g.lat<p.lat,O=b.lng>h.lng&&g.lng<p.lng;return S&&O},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,h){return o?(o=Ct(o),this._southWest.equals(o.getSouthWest(),h)&&this._northEast.equals(o.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Ct(o,h){return o instanceof Dt?o:new Dt(o,h)}function Pt(o,h,p){if(isNaN(o)||isNaN(h))throw new Error("Invalid LatLng object: ("+o+", "+h+")");this.lat=+o,this.lng=+h,p!==void 0&&(this.alt=+p)}Pt.prototype={equals:function(o,h){if(!o)return!1;o=Mt(o);var p=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return p<=(h===void 0?1e-9:h)},toString:function(o){return"LatLng("+_(this.lat,o)+", "+_(this.lng,o)+")"},distanceTo:function(o){return jt.distance(this,Mt(o))},wrap:function(){return jt.wrapLatLng(this)},toBounds:function(o){var h=180*o/40075017,p=h/Math.cos(Math.PI/180*this.lat);return Ct([this.lat-h,this.lng-p],[this.lat+h,this.lng+p])},clone:function(){return new Pt(this.lat,this.lng,this.alt)}};function Mt(o,h,p){return o instanceof Pt?o:D(o)&&typeof o[0]!="object"?o.length===3?new Pt(o[0],o[1],o[2]):o.length===2?new Pt(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new Pt(o.lat,"lng"in o?o.lng:o.lon,o.alt):h===void 0?null:new Pt(o,h,p)}var Se={latLngToPoint:function(o,h){var p=this.projection.project(o),g=this.scale(h);return this.transformation._transform(p,g)},pointToLatLng:function(o,h){var p=this.scale(h),g=this.transformation.untransform(o,p);return this.projection.unproject(g)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var h=this.projection.bounds,p=this.scale(o),g=this.transformation.transform(h.min,p),b=this.transformation.transform(h.max,p);return new wt(g,b)},infinite:!1,wrapLatLng:function(o){var h=this.wrapLng?f(o.lng,this.wrapLng,!0):o.lng,p=this.wrapLat?f(o.lat,this.wrapLat,!0):o.lat,g=o.alt;return new Pt(p,h,g)},wrapLatLngBounds:function(o){var h=o.getCenter(),p=this.wrapLatLng(h),g=h.lat-p.lat,b=h.lng-p.lng;if(g===0&&b===0)return o;var S=o.getSouthWest(),O=o.getNorthEast(),F=new Pt(S.lat-g,S.lng-b),j=new Pt(O.lat-g,O.lng-b);return new Dt(F,j)}},jt=n({},Se,{wrapLng:[-180,180],R:6371e3,distance:function(o,h){var p=Math.PI/180,g=o.lat*p,b=h.lat*p,S=Math.sin((h.lat-o.lat)*p/2),O=Math.sin((h.lng-o.lng)*p/2),F=S*S+Math.cos(g)*Math.cos(b)*O*O,j=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F));return this.R*j}}),Ei=6378137,Kt={R:Ei,MAX_LATITUDE:85.0511287798,project:function(o){var h=Math.PI/180,p=this.MAX_LATITUDE,g=Math.max(Math.min(p,o.lat),-p),b=Math.sin(g*h);return new tt(this.R*o.lng*h,this.R*Math.log((1+b)/(1-b))/2)},unproject:function(o){var h=180/Math.PI;return new Pt((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*h,o.x*h/this.R)},bounds:function(){var o=Ei*Math.PI;return new wt([-o,-o],[o,o])}()};function _e(o,h,p,g){if(D(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=h,this._c=p,this._d=g}_e.prototype={transform:function(o,h){return this._transform(o.clone(),h)},_transform:function(o,h){return h=h||1,o.x=h*(this._a*o.x+this._b),o.y=h*(this._c*o.y+this._d),o},untransform:function(o,h){return h=h||1,new tt((o.x/h-this._b)/this._a,(o.y/h-this._d)/this._c)}};function Pe(o,h,p,g){return new _e(o,h,p,g)}var Ii=n({},jt,{code:"EPSG:3857",projection:Kt,transformation:function(){var o=.5/(Math.PI*Kt.R);return Pe(o,.5,-o,.5)}()}),Fe=n({},Ii,{code:"EPSG:900913"});function Ne(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Yi(o,h){var p="",g,b,S,O,F,j;for(g=0,S=o.length;g<S;g++){for(F=o[g],b=0,O=F.length;b<O;b++)j=F[b],p+=(b?"L":"M")+j.x+" "+j.y;p+=h?it.svg?"z":"x":""}return p||"M0 0"}var Be=document.documentElement.style,Ue="ActiveXObject"in window,Fs=Ue&&!document.addEventListener,wn="msLaunchUri"in navigator&&!("documentMode"in document),di=ve("webkit"),je=ve("android"),Ns=ve("android 2")||ve("android 3"),ds=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_o=je&&ve("Google")&&ds<537&&!("AudioNode"in window),fs=!!window.opera,ps=!wn&&ve("chrome"),ms=ve("gecko")&&!di&&!fs&&!Ue,xi=!ps&&ve("safari"),Xi=ve("phantom"),Gi="OTransition"in Be,Ae=navigator.platform.indexOf("Win")===0,Mn=Ue&&"transition"in Be,Wn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ns,P="MozPerspective"in Be,C=!window.L_DISABLE_3D&&(Mn||Wn||P)&&!Gi&&!Xi,x=typeof orientation<"u"||ve("mobile"),R=x&&di,Z=x&&Wn,q=!window.PointerEvent&&window.MSPointerEvent,ct=!!(window.PointerEvent||q),_t="ontouchstart"in window||!!window.TouchEvent,mt=!window.L_NO_TOUCH&&(_t||ct),Wt=x&&fs,Ft=x&&ms,Ht=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ue=function(){var o=!1;try{var h=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",m,h),window.removeEventListener("testPassiveEventSupport",m,h)}catch{}return o}(),He=function(){return!!document.createElement("canvas").getContext}(),qe=!!(document.createElementNS&&Ne("svg").createSVGRect),qt=!!qe&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),wi=!qe&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var h=o.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),fi=navigator.platform.indexOf("Mac")===0,Un=navigator.platform.indexOf("Linux")===0;function ve(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var it={ie:Ue,ielt9:Fs,edge:wn,webkit:di,android:je,android23:Ns,androidStock:_o,opera:fs,chrome:ps,gecko:ms,safari:xi,phantom:Xi,opera12:Gi,win:Ae,ie3d:Mn,webkit3d:Wn,gecko3d:P,any3d:C,mobile:x,mobileWebkit:R,mobileWebkit3d:Z,msPointer:q,pointer:ct,touch:mt,touchNative:_t,mobileOpera:Wt,mobileGecko:Ft,retina:Ht,passiveEvents:ue,canvas:He,svg:qe,vml:wi,inlineSvg:qt,mac:fi,linux:Un},Oi=it.msPointer?"MSPointerDown":"pointerdown",ii=it.msPointer?"MSPointerMove":"pointermove",Di=it.msPointer?"MSPointerUp":"pointerup",rn=it.msPointer?"MSPointerCancel":"pointercancel",Ri={touchstart:Oi,touchmove:ii,touchend:Di,touchcancel:rn},Ye={touchstart:Xn,touchmove:Yn,touchend:Yn,touchcancel:Yn},$i={},qn=!1;function Sn(o,h,p){return h==="touchstart"&&Pn(),Ye[h]?(p=Ye[h].bind(this,p),o.addEventListener(Ri[h],p,!1),p):(console.warn("wrong event specified:",h),m)}function Ee(o,h,p){if(!Ri[h]){console.warn("wrong event specified:",h);return}o.removeEventListener(Ri[h],p,!1)}function ni(o){$i[o.pointerId]=o}function dt(o){$i[o.pointerId]&&($i[o.pointerId]=o)}function yt(o){delete $i[o.pointerId]}function Pn(){qn||(document.addEventListener(Oi,ni,!0),document.addEventListener(ii,dt,!0),document.addEventListener(Di,yt,!0),document.addEventListener(rn,yt,!0),qn=!0)}function Yn(o,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var p in $i)h.touches.push($i[p]);h.changedTouches=[h],o(h)}}function Xn(o,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&Xt(h),Yn(o,h)}function zi(o){var h={},p,g;for(g in o)p=o[g],h[g]=p&&p.bind?p.bind(o):p;return o=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var Ie=200;function Mi(o,h){o.addEventListener("dblclick",h);var p=0,g;function b(S){if(S.detail!==1){g=S.detail;return}if(!(S.pointerType==="mouse"||S.sourceCapabilities&&!S.sourceCapabilities.firesTouchEvents)){var O=Ji(S);if(!(O.some(function(j){return j instanceof HTMLLabelElement&&j.attributes.for})&&!O.some(function(j){return j instanceof HTMLInputElement||j instanceof HTMLSelectElement}))){var F=Date.now();F-p<=Ie?(g++,g===2&&h(zi(S))):g=1,p=F}}}return o.addEventListener("click",b),{dblclick:h,simDblclick:b}}function Fi(o,h){o.removeEventListener("dblclick",h.dblclick),o.removeEventListener("click",h.simDblclick)}var Xe=oi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ge=oi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Te=Ge==="webkitTransition"||Ge==="OTransition"?Ge+"End":"transitionend";function si(o){return typeof o=="string"?document.getElementById(o):o}function Ki(o,h){var p=o.style[h]||o.currentStyle&&o.currentStyle[h];if((!p||p==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(o,null);p=g?g[h]:null}return p==="auto"?null:p}function Et(o,h,p){var g=document.createElement(o);return g.className=h||"",p&&p.appendChild(g),g}function Zt(o){var h=o.parentNode;h&&h.removeChild(o)}function Le(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function $e(o){var h=o.parentNode;h&&h.lastChild!==o&&h.appendChild(o)}function pi(o){var h=o.parentNode;h&&h.firstChild!==o&&h.insertBefore(o,h.firstChild)}function Tn(o,h){if(o.classList!==void 0)return o.classList.contains(h);var p=ne(o);return p.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(p)}function gt(o,h){if(o.classList!==void 0)for(var p=y(h),g=0,b=p.length;g<b;g++)o.classList.add(p[g]);else if(!Tn(o,h)){var S=ne(o);be(o,(S?S+" ":"")+h)}}function Tt(o,h){o.classList!==void 0?o.classList.remove(h):be(o,v((" "+ne(o)+" ").replace(" "+h+" "," ")))}function be(o,h){o.className.baseVal===void 0?o.className=h:o.className.baseVal=h}function ne(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function oe(o,h){"opacity"in o.style?o.style.opacity=h:"filter"in o.style&&ln(o,h)}function ln(o,h){var p=!1,g="DXImageTransform.Microsoft.Alpha";try{p=o.filters.item(g)}catch{if(h===1)return}h=Math.round(h*100),p?(p.Enabled=h!==100,p.Opacity=h):o.style.filter+=" progid:"+g+"(opacity="+h+")"}function oi(o){for(var h=document.documentElement.style,p=0;p<o.length;p++)if(o[p]in h)return o[p];return!1}function Ni(o,h,p){var g=h||new tt(0,0);o.style[Xe]=(it.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(p?" scale("+p+")":"")}function Ut(o,h){o._leaflet_pos=h,it.any3d?Ni(o,h):(o.style.left=h.x+"px",o.style.top=h.y+"px")}function Ke(o){return o._leaflet_pos||new tt(0,0)}var M,T,I;if("onselectstart"in document)M=function(){xt(window,"selectstart",Xt)},T=function(){Yt(window,"selectstart",Xt)};else{var N=oi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);M=function(){if(N){var o=document.documentElement.style;I=o[N],o[N]="none"}},T=function(){N&&(document.documentElement.style[N]=I,I=void 0)}}function U(){xt(window,"dragstart",Xt)}function J(){Yt(window,"dragstart",Xt)}var vt,ae;function re(o){for(;o.tabIndex===-1;)o=o.parentNode;!o.style||(le(),vt=o,ae=o.style.outlineStyle,o.style.outlineStyle="none",xt(window,"keydown",le))}function le(){!vt||(vt.style.outlineStyle=ae,vt=void 0,ae=void 0,Yt(window,"keydown",le))}function ai(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function Bs(o){var h=o.getBoundingClientRect();return{x:h.width/o.offsetWidth||1,y:h.height/o.offsetHeight||1,boundingClientRect:h}}var oa={__proto__:null,TRANSFORM:Xe,TRANSITION:Ge,TRANSITION_END:Te,get:si,getStyle:Ki,create:Et,remove:Zt,empty:Le,toFront:$e,toBack:pi,hasClass:Tn,addClass:gt,removeClass:Tt,setClass:be,getClass:ne,setOpacity:oe,testProp:oi,setTransform:Ni,setPosition:Ut,getPosition:Ke,get disableTextSelection(){return M},get enableTextSelection(){return T},disableImageDrag:U,enableImageDrag:J,preventOutline:re,restoreOutline:le,getSizedParentNode:ai,getScale:Bs};function xt(o,h,p,g){if(h&&typeof h=="object")for(var b in h)js(o,b,h[b],p);else{h=y(h);for(var S=0,O=h.length;S<O;S++)js(o,h[S],p,g)}return this}var mi="_leaflet_events";function Yt(o,h,p,g){if(arguments.length===1)aa(o),delete o[mi];else if(h&&typeof h=="object")for(var b in h)Hs(o,b,h[b],p);else if(h=y(h),arguments.length===2)aa(o,function(F){return z(h,F)!==-1});else for(var S=0,O=h.length;S<O;S++)Hs(o,h[S],p,g);return this}function aa(o,h){for(var p in o[mi]){var g=p.split(/\d/)[0];(!h||h(g))&&Hs(o,g,null,null,p)}}var Ln={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function js(o,h,p,g){var b=h+l(p)+(g?"_"+l(g):"");if(o[mi]&&o[mi][b])return this;var S=function(F){return p.call(g||o,F||window.event)},O=S;!it.touchNative&&it.pointer&&h.indexOf("touch")===0?S=Sn(o,h,S):it.touch&&h==="dblclick"?S=Mi(o,S):"addEventListener"in o?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?o.addEventListener(Ln[h]||h,S,it.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(S=function(F){F=F||window.event,Qi(o,F)&&O(F)},o.addEventListener(Ln[h],S,!1)):o.addEventListener(h,O,!1):o.attachEvent("on"+h,S),o[mi]=o[mi]||{},o[mi][b]=S}function Hs(o,h,p,g,b){b=b||h+l(p)+(g?"_"+l(g):"");var S=o[mi]&&o[mi][b];if(!S)return this;!it.touchNative&&it.pointer&&h.indexOf("touch")===0?Ee(o,h,S):it.touch&&h==="dblclick"?Fi(o,S):"removeEventListener"in o?o.removeEventListener(Ln[h]||h,S,!1):o.detachEvent("on"+h,S),o[mi][b]=null}function Ve(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function Vs(o){return js(o,"wheel",Ve),this}function gi(o){return xt(o,"mousedown touchstart dblclick contextmenu",Ve),o._leaflet_disable_click=!0,this}function Xt(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function Cn(o){return Xt(o),Ve(o),this}function Ji(o){if(o.composedPath)return o.composedPath();for(var h=[],p=o.target;p;)h.push(p),p=p.parentNode;return h}function cn(o,h){if(!h)return new tt(o.clientX,o.clientY);var p=Bs(h),g=p.boundingClientRect;return new tt((o.clientX-g.left)/p.x-h.clientLeft,(o.clientY-g.top)/p.y-h.clientTop)}var la=it.linux&&it.chrome?window.devicePixelRatio:it.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Bi(o){return it.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/la:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function Qi(o,h){var p=h.relatedTarget;if(!p)return!0;try{for(;p&&p!==o;)p=p.parentNode}catch{return!1}return p!==o}var kr={__proto__:null,on:xt,off:Yt,stopPropagation:Ve,disableScrollPropagation:Vs,disableClickPropagation:gi,preventDefault:Xt,stop:Cn,getPropagationPath:Ji,getMousePosition:cn,getWheelDelta:Bi,isExternalTarget:Qi,addListener:xt,removeListener:Yt},ca=kt.extend({run:function(o,h,p,g){this.stop(),this._el=o,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=Ke(o),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(o){var h=+new Date-this._startTime,p=this._duration*1e3;h<p?this._runFrame(this._easeOut(h/p),o):(this._runFrame(1),this._complete())},_runFrame:function(o,h){var p=this._startPos.add(this._offset.multiplyBy(o));h&&p._round(),Ut(this._el,p),this.fire("step")},_complete:function(){ot(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Rt=kt.extend({options:{crs:Ii,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,h){h=w(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(Mt(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ge&&it.any3d&&!it.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),xt(this._proxy,Te,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,h,p){if(h=h===void 0?this._zoom:this._limitZoom(h),o=this._limitCenter(Mt(o),h,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=n({animate:p.animate},p.zoom),p.pan=n({animate:p.animate,duration:p.duration},p.pan));var g=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,h,p.zoom):this._tryAnimatedPan(o,p.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(o,h,p.pan&&p.pan.noMoveStart),this},setZoom:function(o,h){return this._loaded?this.setView(this.getCenter(),o,{zoom:h}):(this._zoom=o,this)},zoomIn:function(o,h){return o=o||(it.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,h)},zoomOut:function(o,h){return o=o||(it.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,h)},setZoomAround:function(o,h,p){var g=this.getZoomScale(h),b=this.getSize().divideBy(2),S=o instanceof tt?o:this.latLngToContainerPoint(o),O=S.subtract(b).multiplyBy(1-1/g),F=this.containerPointToLatLng(b.add(O));return this.setView(F,h,{zoom:p})},_getBoundsCenterZoom:function(o,h){h=h||{},o=o.getBounds?o.getBounds():Ct(o);var p=nt(h.paddingTopLeft||h.padding||[0,0]),g=nt(h.paddingBottomRight||h.padding||[0,0]),b=this.getBoundsZoom(o,!1,p.add(g));if(b=typeof h.maxZoom=="number"?Math.min(h.maxZoom,b):b,b===1/0)return{center:o.getCenter(),zoom:b};var S=g.subtract(p).divideBy(2),O=this.project(o.getSouthWest(),b),F=this.project(o.getNorthEast(),b),j=this.unproject(O.add(F).divideBy(2).add(S),b);return{center:j,zoom:b}},fitBounds:function(o,h){if(o=Ct(o),!o.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(o,h);return this.setView(p.center,p.zoom,h)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,h){return this.setView(o,this._zoom,{pan:h})},panBy:function(o,h){if(o=nt(o).round(),h=h||{},!o.x&&!o.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ca,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){gt(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,p,h.duration||.25,h.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,h,p){if(p=p||{},p.animate===!1||!it.any3d)return this.setView(o,h,p);this._stop();var g=this.project(this.getCenter()),b=this.project(o),S=this.getSize(),O=this._zoom;o=Mt(o),h=h===void 0?O:h;var F=Math.max(S.x,S.y),j=F*this.getZoomScale(O,h),Y=b.distanceTo(g)||1,et=1.42,ft=et*et;function It(ye){var wa=ye?-1:1,Cf=ye?j:F,kf=j*j-F*F+wa*ft*ft*Y*Y,Af=2*Cf*ft*Y,Hr=kf/Af,Qc=Math.sqrt(Hr*Hr+1)-Hr,Ef=Qc<1e-9?-18:Math.log(Qc);return Ef}function li(ye){return(Math.exp(ye)-Math.exp(-ye))/2}function Oe(ye){return(Math.exp(ye)+Math.exp(-ye))/2}function Zi(ye){return li(ye)/Oe(ye)}var _i=It(0);function Xs(ye){return F*(Oe(_i)/Oe(_i+et*ye))}function Sf(ye){return F*(Oe(_i)*Zi(_i+et*ye)-li(_i))/ft}function Pf(ye){return 1-Math.pow(1-ye,1.5)}var Tf=Date.now(),Kc=(It(1)-_i)/et,Lf=p.duration?1e3*p.duration:1e3*Kc*.8;function Jc(){var ye=(Date.now()-Tf)/Lf,wa=Pf(ye)*Kc;ye<=1?(this._flyToFrame=B(Jc,this),this._move(this.unproject(g.add(b.subtract(g).multiplyBy(Sf(wa)/Y)),O),this.getScaleZoom(F/Xs(wa),O),{flyTo:!0})):this._move(o,h)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),Jc.call(this),this},flyToBounds:function(o,h){var p=this._getBoundsCenterZoom(o,h);return this.flyTo(p.center,p.zoom,h)},setMaxBounds:function(o){return o=Ct(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var h=this.options.minZoom;return this.options.minZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var h=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,h){this._enforcingBounds=!0;var p=this.getCenter(),g=this._limitCenter(p,this._zoom,Ct(o));return p.equals(g)||this.panTo(g,h),this._enforcingBounds=!1,this},panInside:function(o,h){h=h||{};var p=nt(h.paddingTopLeft||h.padding||[0,0]),g=nt(h.paddingBottomRight||h.padding||[0,0]),b=this.project(this.getCenter()),S=this.project(o),O=this.getPixelBounds(),F=te([O.min.add(p),O.max.subtract(g)]),j=F.getSize();if(!F.contains(S)){this._enforcingBounds=!0;var Y=S.subtract(F.getCenter()),et=F.extend(S).getSize().subtract(j);b.x+=Y.x<0?-et.x:et.x,b.y+=Y.y<0?-et.y:et.y,this.panTo(this.unproject(b),h),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=n({animate:!1,pan:!0},o===!0?{animate:!0}:o);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),g=h.divideBy(2).round(),b=p.divideBy(2).round(),S=g.subtract(b);return!S.x&&!S.y?this:(o.animate&&o.pan?this.panBy(S):(o.pan&&this._rawPanBy(S),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=n({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=a(this._handleGeolocationResponse,this),p=a(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,p,o):navigator.geolocation.getCurrentPosition(h,p,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(!!this._container._leaflet_id){var h=o.code,p=o.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(o){if(!!this._container._leaflet_id){var h=o.coords.latitude,p=o.coords.longitude,g=new Pt(h,p),b=g.toBounds(o.coords.accuracy*2),S=this._locateOptions;if(S.setView){var O=this.getBoundsZoom(b);this.setView(g,S.maxZoom?Math.min(O,S.maxZoom):O)}var F={latlng:g,bounds:b,timestamp:o.timestamp};for(var j in o.coords)typeof o.coords[j]=="number"&&(F[j]=o.coords[j]);this.fire("locationfound",F)}},addHandler:function(o,h){if(!h)return this;var p=this[o]=new h(this);return this._handlers.push(p),this.options[o]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Zt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ot(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)Zt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,h){var p="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),g=Et("div",p,h||this._mapPane);return o&&(this._panes[o]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),h=this.unproject(o.getBottomLeft()),p=this.unproject(o.getTopRight());return new Dt(h,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,h,p){o=Ct(o),p=nt(p||[0,0]);var g=this.getZoom()||0,b=this.getMinZoom(),S=this.getMaxZoom(),O=o.getNorthWest(),F=o.getSouthEast(),j=this.getSize().subtract(p),Y=te(this.project(F,g),this.project(O,g)).getSize(),et=it.any3d?this.options.zoomSnap:1,ft=j.x/Y.x,It=j.y/Y.y,li=h?Math.max(ft,It):Math.min(ft,It);return g=this.getScaleZoom(li,g),et&&(g=Math.round(g/(et/100))*(et/100),g=h?Math.ceil(g/et)*et:Math.floor(g/et)*et),Math.max(b,Math.min(S,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new tt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,h){var p=this._getTopLeftPoint(o,h);return new wt(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,h){var p=this.options.crs;return h=h===void 0?this._zoom:h,p.scale(o)/p.scale(h)},getScaleZoom:function(o,h){var p=this.options.crs;h=h===void 0?this._zoom:h;var g=p.zoom(o*p.scale(h));return isNaN(g)?1/0:g},project:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(Mt(o),h)},unproject:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(nt(o),h)},layerPointToLatLng:function(o){var h=nt(o).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(o){var h=this.project(Mt(o))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(Mt(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(Ct(o))},distance:function(o,h){return this.options.crs.distance(Mt(o),Mt(h))},containerPointToLayerPoint:function(o){return nt(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return nt(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var h=this.containerPointToLayerPoint(nt(o));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Mt(o)))},mouseEventToContainerPoint:function(o){return cn(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var h=this._container=si(o);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");xt(h,"scroll",this._onScroll,this),this._containerId=l(h)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&it.any3d,gt(o,"leaflet-container"+(it.touch?" leaflet-touch":"")+(it.retina?" leaflet-retina":"")+(it.ielt9?" leaflet-oldie":"")+(it.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=Ki(o,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ut(this._mapPane,new tt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(gt(o.markerPane,"leaflet-zoom-hide"),gt(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,h,p){Ut(this._mapPane,new tt(0,0));var g=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var b=this._zoom!==h;this._moveStart(b,p)._move(o,h)._moveEnd(b),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(o,h){return o&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(o,h,p,g){h===void 0&&(h=this._zoom);var b=this._zoom!==h;return this._zoom=h,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),g?p&&p.pinch&&this.fire("zoom",p):((b||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ot(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){Ut(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[l(this._container)]=this;var h=o?Yt:xt;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),it.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ot(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,h){for(var p=[],g,b=h==="mouseout"||h==="mouseover",S=o.target||o.srcElement,O=!1;S;){if(g=this._targets[l(S)],g&&(h==="click"||h==="preclick")&&this._draggableMoved(g)){O=!0;break}if(g&&g.listens(h,!0)&&(b&&!Qi(S,o)||(p.push(g),b))||S===this._container)break;S=S.parentNode}return!p.length&&!O&&!b&&this.listens(h,!0)&&(p=[this]),p},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var h=o.target||o.srcElement;if(!(!this._loaded||h._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(h))){var p=o.type;p==="mousedown"&&re(h),this._fireDOMEvent(o,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,h,p){if(o.type==="click"){var g=n({},o);g.type="preclick",this._fireDOMEvent(g,g.type,p)}var b=this._findEventTargets(o,h);if(p){for(var S=[],O=0;O<p.length;O++)p[O].listens(h,!0)&&S.push(p[O]);b=S.concat(b)}if(!!b.length){h==="contextmenu"&&Xt(o);var F=b[0],j={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var Y=F.getLatLng&&(!F._radius||F._radius<=10);j.containerPoint=Y?this.latLngToContainerPoint(F.getLatLng()):this.mouseEventToContainerPoint(o),j.layerPoint=this.containerPointToLayerPoint(j.containerPoint),j.latlng=Y?F.getLatLng():this.layerPointToLatLng(j.layerPoint)}for(O=0;O<b.length;O++)if(b[O].fire(h,j,!0),j.originalEvent._stopped||b[O].options.bubblingMouseEvents===!1&&z(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,h=this._handlers.length;o<h;o++)this._handlers[o].disable()},whenReady:function(o,h){return this._loaded?o.call(h||this,{target:this}):this.on("load",o,h),this},_getMapPanePos:function(){return Ke(this._mapPane)||new tt(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,h){var p=o&&h!==void 0?this._getNewPixelOrigin(o,h):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,h){var p=this.getSize()._divideBy(2);return this.project(o,h)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,h,p){var g=this._getNewPixelOrigin(p,h);return this.project(o,h)._subtract(g)},_latLngBoundsToNewLayerBounds:function(o,h,p){var g=this._getNewPixelOrigin(p,h);return te([this.project(o.getSouthWest(),h)._subtract(g),this.project(o.getNorthWest(),h)._subtract(g),this.project(o.getSouthEast(),h)._subtract(g),this.project(o.getNorthEast(),h)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,h,p){if(!p)return o;var g=this.project(o,h),b=this.getSize().divideBy(2),S=new wt(g.subtract(b),g.add(b)),O=this._getBoundsOffset(S,p,h);return Math.abs(O.x)<=1&&Math.abs(O.y)<=1?o:this.unproject(g.add(O),h)},_limitOffset:function(o,h){if(!h)return o;var p=this.getPixelBounds(),g=new wt(p.min.add(o),p.max.add(o));return o.add(this._getBoundsOffset(g,h))},_getBoundsOffset:function(o,h,p){var g=te(this.project(h.getNorthEast(),p),this.project(h.getSouthWest(),p)),b=g.min.subtract(o.min),S=g.max.subtract(o.max),O=this._rebound(b.x,-S.x),F=this._rebound(b.y,-S.y);return new tt(O,F)},_rebound:function(o,h){return o+h>0?Math.round(o-h)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(h))},_limitZoom:function(o){var h=this.getMinZoom(),p=this.getMaxZoom(),g=it.any3d?this.options.zoomSnap:1;return g&&(o=Math.round(o/g)*g),Math.max(h,Math.min(p,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,h){var p=this._getCenterOffset(o)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,h),!0)},_createAnimProxy:function(){var o=this._proxy=Et("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(h){var p=Xe,g=this._proxy.style[p];Ni(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),g===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Zt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),h=this.getZoom();Ni(this._proxy,this.project(o,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,h,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(h),b=this._getCenterOffset(o)._divideBy(1-1/g);return p.animate!==!0&&!this.getSize().contains(b)?!1:(B(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(o,h,!0)},this),!0)},_animateZoom:function(o,h,p,g){!this._mapPane||(p&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=h,gt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:h,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&Tt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ha(o,h){return new Rt(o,h)}var Si=Q.extend({options:{position:"topright"},initialize:function(o){w(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var h=this._map;return h&&h.removeControl(this),this.options.position=o,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var h=this._container=this.onAdd(o),p=this.getPosition(),g=o._controlCorners[p];return gt(h,"leaflet-control"),p.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Zt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),hn=function(o){return new Si(o)};Rt.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},h="leaflet-",p=this._controlContainer=Et("div",h+"control-container",this._container);function g(b,S){var O=h+b+" "+h+S;o[b+S]=Et("div",O,p)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)Zt(this._controlCorners[o]);Zt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var K=Si.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,h,p,g){return p<g?-1:g<p?1:0}},initialize:function(o,h,p){w(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in o)this._addLayer(o[g],g);for(g in h)this._addLayer(h[g],g,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Si.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,h){return this._addLayer(o,h),this._map?this._update():this},addOverlay:function(o,h){return this._addLayer(o,h,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var h=this._getLayer(l(o));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){gt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(gt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):Tt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",h=this._container=Et("div",o),p=this.options.collapsed;h.setAttribute("aria-haspopup",!0),gi(h),Vs(h);var g=this._section=Et("section",o+"-list");p&&(this._map.on("click",this.collapse,this),xt(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var b=this._layersLink=Et("a",o+"-toggle",h);b.href="#",b.title="Layers",b.setAttribute("role","button"),xt(b,{keydown:function(S){S.keyCode===13&&this._expandSafely()},click:function(S){Xt(S),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=Et("div",o+"-base",g),this._separator=Et("div",o+"-separator",g),this._overlaysList=Et("div",o+"-overlays",g),h.appendChild(g)},_getLayer:function(o){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&l(this._layers[h].layer)===o)return this._layers[h]},_addLayer:function(o,h,p){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:h,overlay:p}),this.options.sortLayers&&this._layers.sort(a(function(g,b){return this.options.sortFunction(g.layer,b.layer,g.name,b.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Le(this._baseLayersList),Le(this._overlaysList),this._layerControlInputs=[];var o,h,p,g,b=0;for(p=0;p<this._layers.length;p++)g=this._layers[p],this._addItem(g),h=h||g.overlay,o=o||!g.overlay,b+=g.overlay?0:1;return this.options.hideSingleBase&&(o=o&&b>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=h&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var h=this._getLayer(l(o.target)),p=h.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;p&&this._map.fire(p,h)},_createRadioElement:function(o,h){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(h?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=p,g.firstChild},_addItem:function(o){var h=document.createElement("label"),p=this._map.hasLayer(o.layer),g;o.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=p):g=this._createRadioElement("leaflet-base-layers_"+l(this),p),this._layerControlInputs.push(g),g.layerId=l(o.layer),xt(g,"click",this._onInputClick,this);var b=document.createElement("span");b.innerHTML=" "+o.name;var S=document.createElement("span");h.appendChild(S),S.appendChild(g),S.appendChild(b);var O=o.overlay?this._overlaysList:this._baseLayersList;return O.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,h,p,g=[],b=[];this._handlingClick=!0;for(var S=o.length-1;S>=0;S--)h=o[S],p=this._getLayer(h.layerId).layer,h.checked?g.push(p):h.checked||b.push(p);for(S=0;S<b.length;S++)this._map.hasLayer(b[S])&&this._map.removeLayer(b[S]);for(S=0;S<g.length;S++)this._map.hasLayer(g[S])||this._map.addLayer(g[S]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,h,p,g=this._map.getZoom(),b=o.length-1;b>=0;b--)h=o[b],p=this._getLayer(h.layerId).layer,h.disabled=p.options.minZoom!==void 0&&g<p.options.minZoom||p.options.maxZoom!==void 0&&g>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,xt(o,"click",Xt),this.expand();var h=this;setTimeout(function(){Yt(o,"click",Xt),h._preventClick=!1})}}),rt=function(o,h,p){return new K(o,h,p)},zt=Si.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var h="leaflet-control-zoom",p=Et("div",h+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,h+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,h+"-out",p,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,h,p,g,b){var S=Et("a",p,g);return S.innerHTML=o,S.href="#",S.title=h,S.setAttribute("role","button"),S.setAttribute("aria-label",h),gi(S),xt(S,"click",Cn),xt(S,"click",b,this),xt(S,"click",this._refocusOnMap,this),S},_updateDisabled:function(){var o=this._map,h="leaflet-disabled";Tt(this._zoomInButton,h),Tt(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(gt(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(gt(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});Rt.mergeOptions({zoomControl:!0}),Rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zt,this.addControl(this.zoomControl))});var Ce=function(o){return new zt(o)},lt=Si.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var h="leaflet-control-scale",p=Et("div",h),g=this.options;return this._addScales(g,h+"-line",p),o.on(g.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),p},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,h,p){o.metric&&(this._mScale=Et("div",h,p)),o.imperial&&(this._iScale=Et("div",h,p))},_update:function(){var o=this._map,h=o.getSize().y/2,p=o.distance(o.containerPointToLatLng([0,h]),o.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(p)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var h=this._getRoundNum(o),p=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,p,h/o)},_updateImperial:function(o){var h=o*3.2808399,p,g,b;h>5280?(p=h/5280,g=this._getRoundNum(p),this._updateScale(this._iScale,g+" mi",g/p)):(b=this._getRoundNum(h),this._updateScale(this._iScale,b+" ft",b/h))},_updateScale:function(o,h,p){o.style.width=Math.round(this.options.maxWidth*p)+"px",o.innerHTML=h},_getRoundNum:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),p=o/h;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,h*p}}),Ze=function(o){return new lt(o)},ji='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ri=Si.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(it.inlineSvg?ji+" ":"")+"Leaflet</a>"},initialize:function(o){w(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=Et("div","leaflet-control-attribution"),gi(this._container);for(var h in o._layers)o._layers[h].getAttribution&&this.addAttribution(o._layers[h].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(!!this._map){var o=[];for(var h in this._attributions)this._attributions[h]&&o.push(h);var p=[];this.options.prefix&&p.push(this.options.prefix),o.length&&p.push(o.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});Rt.mergeOptions({attributionControl:!0}),Rt.addInitHook(function(){this.options.attributionControl&&new ri().addTo(this)});var Ar=function(o){return new ri(o)};Si.Layers=K,Si.Zoom=zt,Si.Scale=lt,Si.Attribution=ri,hn.layers=rt,hn.zoom=Ce,hn.scale=Ze,hn.attribution=Ar;var Hi=Q.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hi.addTo=function(o,h){return o.addHandler(h,this),this};var Er={Events:St},Ir=it.touch?"touchstart mousedown":"mousedown",Gn=kt.extend({options:{clickTolerance:3},initialize:function(o,h,p,g){w(this,g),this._element=o,this._dragStartTarget=h||o,this._preventOutline=p},enable:function(){this._enabled||(xt(this._dragStartTarget,Ir,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(Gn._dragging===this&&this.finishDrag(!0),Yt(this._dragStartTarget,Ir,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(!!this._enabled&&(this._moved=!1,!Tn(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){Gn._dragging===this&&this.finishDrag();return}if(!(Gn._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(Gn._dragging=this,this._preventOutline&&re(this._element),U(),M(),!this._moving)){this.fire("down");var h=o.touches?o.touches[0]:o,p=ai(this._element);this._startPoint=new tt(h.clientX,h.clientY),this._startPos=Ke(this._element),this._parentScale=Bs(p);var g=o.type==="mousedown";xt(document,g?"mousemove":"touchmove",this._onMove,this),xt(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(!!this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var h=o.touches&&o.touches.length===1?o.touches[0]:o,p=new tt(h.clientX,h.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,Xt(o),this._moved||(this.fire("dragstart"),this._moved=!0,gt(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),gt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),Ut(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){!this._enabled||this.finishDrag()},finishDrag:function(o){Tt(document.body,"leaflet-dragging"),this._lastTarget&&(Tt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Yt(document,"mousemove touchmove",this._onMove,this),Yt(document,"mouseup touchend touchcancel",this._onUp,this),J(),T();var h=this._moved&&this._moving;this._moving=!1,Gn._dragging=!1,h&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function Mc(o,h,p){var g,b=[1,4,2,8],S,O,F,j,Y,et,ft,It;for(S=0,et=o.length;S<et;S++)o[S]._code=gs(o[S],h);for(F=0;F<4;F++){for(ft=b[F],g=[],S=0,et=o.length,O=et-1;S<et;O=S++)j=o[S],Y=o[O],j._code&ft?Y._code&ft||(It=ua(Y,j,ft,h,p),It._code=gs(It,h),g.push(It)):(Y._code&ft&&(It=ua(Y,j,ft,h,p),It._code=gs(It,h),g.push(It)),g.push(j));o=g}return o}function Sc(o,h){var p,g,b,S,O,F,j,Y,et;if(!o||o.length===0)throw new Error("latlngs not passed");Vi(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var ft=Mt([0,0]),It=Ct(o),li=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());li<1700&&(ft=Or(o));var Oe=o.length,Zi=[];for(p=0;p<Oe;p++){var _i=Mt(o[p]);Zi.push(h.project(Mt([_i.lat-ft.lat,_i.lng-ft.lng])))}for(F=j=Y=0,p=0,g=Oe-1;p<Oe;g=p++)b=Zi[p],S=Zi[g],O=b.y*S.x-S.y*b.x,j+=(b.x+S.x)*O,Y+=(b.y+S.y)*O,F+=O*3;F===0?et=Zi[0]:et=[j/F,Y/F];var Xs=h.unproject(nt(et));return Mt([Xs.lat+ft.lat,Xs.lng+ft.lng])}function Or(o){for(var h=0,p=0,g=0,b=0;b<o.length;b++){var S=Mt(o[b]);h+=S.lat,p+=S.lng,g++}return Mt([h/g,p/g])}var Yd={__proto__:null,clipPolygon:Mc,polygonCenter:Sc,centroid:Or};function Pc(o,h){if(!h||!o.length)return o.slice();var p=h*h;return o=$d(o,p),o=Gd(o,p),o}function Tc(o,h,p){return Math.sqrt(vo(o,h,p,!0))}function Xd(o,h,p){return vo(o,h,p)}function Gd(o,h){var p=o.length,g=typeof Uint8Array!=void 0+""?Uint8Array:Array,b=new g(p);b[0]=b[p-1]=1,Dr(o,b,h,0,p-1);var S,O=[];for(S=0;S<p;S++)b[S]&&O.push(o[S]);return O}function Dr(o,h,p,g,b){var S=0,O,F,j;for(F=g+1;F<=b-1;F++)j=vo(o[F],o[g],o[b],!0),j>S&&(O=F,S=j);S>p&&(h[O]=1,Dr(o,h,p,g,O),Dr(o,h,p,O,b))}function $d(o,h){for(var p=[o[0]],g=1,b=0,S=o.length;g<S;g++)Kd(o[g],o[b])>h&&(p.push(o[g]),b=g);return b<S-1&&p.push(o[S-1]),p}var Lc;function Cc(o,h,p,g,b){var S=g?Lc:gs(o,p),O=gs(h,p),F,j,Y;for(Lc=O;;){if(!(S|O))return[o,h];if(S&O)return!1;F=S||O,j=ua(o,h,F,p,b),Y=gs(j,p),F===S?(o=j,S=Y):(h=j,O=Y)}}function ua(o,h,p,g,b){var S=h.x-o.x,O=h.y-o.y,F=g.min,j=g.max,Y,et;return p&8?(Y=o.x+S*(j.y-o.y)/O,et=j.y):p&4?(Y=o.x+S*(F.y-o.y)/O,et=F.y):p&2?(Y=j.x,et=o.y+O*(j.x-o.x)/S):p&1&&(Y=F.x,et=o.y+O*(F.x-o.x)/S),new tt(Y,et,b)}function gs(o,h){var p=0;return o.x<h.min.x?p|=1:o.x>h.max.x&&(p|=2),o.y<h.min.y?p|=4:o.y>h.max.y&&(p|=8),p}function Kd(o,h){var p=h.x-o.x,g=h.y-o.y;return p*p+g*g}function vo(o,h,p,g){var b=h.x,S=h.y,O=p.x-b,F=p.y-S,j=O*O+F*F,Y;return j>0&&(Y=((o.x-b)*O+(o.y-S)*F)/j,Y>1?(b=p.x,S=p.y):Y>0&&(b+=O*Y,S+=F*Y)),O=o.x-b,F=o.y-S,g?O*O+F*F:new tt(b,S)}function Vi(o){return!D(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function kc(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Vi(o)}function Ac(o,h){var p,g,b,S,O,F,j,Y;if(!o||o.length===0)throw new Error("latlngs not passed");Vi(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var et=Mt([0,0]),ft=Ct(o),It=ft.getNorthWest().distanceTo(ft.getSouthWest())*ft.getNorthEast().distanceTo(ft.getNorthWest());It<1700&&(et=Or(o));var li=o.length,Oe=[];for(p=0;p<li;p++){var Zi=Mt(o[p]);Oe.push(h.project(Mt([Zi.lat-et.lat,Zi.lng-et.lng])))}for(p=0,g=0;p<li-1;p++)g+=Oe[p].distanceTo(Oe[p+1])/2;if(g===0)Y=Oe[0];else for(p=0,S=0;p<li-1;p++)if(O=Oe[p],F=Oe[p+1],b=O.distanceTo(F),S+=b,S>g){j=(S-g)/b,Y=[F.x-j*(F.x-O.x),F.y-j*(F.y-O.y)];break}var _i=h.unproject(nt(Y));return Mt([_i.lat+et.lat,_i.lng+et.lng])}var Jd={__proto__:null,simplify:Pc,pointToSegmentDistance:Tc,closestPointOnSegment:Xd,clipSegment:Cc,_getEdgeIntersection:ua,_getBitCode:gs,_sqClosestPointOnSegment:vo,isFlat:Vi,_flat:kc,polylineCenter:Ac},Rr={project:function(o){return new tt(o.lng,o.lat)},unproject:function(o){return new Pt(o.y,o.x)},bounds:new wt([-180,-90],[180,90])},zr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new wt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var h=Math.PI/180,p=this.R,g=o.lat*h,b=this.R_MINOR/p,S=Math.sqrt(1-b*b),O=S*Math.sin(g),F=Math.tan(Math.PI/4-g/2)/Math.pow((1-O)/(1+O),S/2);return g=-p*Math.log(Math.max(F,1e-10)),new tt(o.lng*h*p,g)},unproject:function(o){for(var h=180/Math.PI,p=this.R,g=this.R_MINOR/p,b=Math.sqrt(1-g*g),S=Math.exp(-o.y/p),O=Math.PI/2-2*Math.atan(S),F=0,j=.1,Y;F<15&&Math.abs(j)>1e-7;F++)Y=b*Math.sin(O),Y=Math.pow((1-Y)/(1+Y),b/2),j=Math.PI/2-2*Math.atan(S*Y)-O,O+=j;return new Pt(O*h,o.x*h/p)}},Qd={__proto__:null,LonLat:Rr,Mercator:zr,SphericalMercator:Kt},tf=n({},jt,{code:"EPSG:3395",projection:zr,transformation:function(){var o=.5/(Math.PI*zr.R);return Pe(o,.5,-o,.5)}()}),Ec=n({},jt,{code:"EPSG:4326",projection:Rr,transformation:Pe(1/180,1,-1/180,.5)}),ef=n({},Se,{projection:Rr,transformation:Pe(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,h){var p=h.lng-o.lng,g=h.lat-o.lat;return Math.sqrt(p*p+g*g)},infinite:!0});Se.Earth=jt,Se.EPSG3395=tf,Se.EPSG3857=Ii,Se.EPSG900913=Fe,Se.EPSG4326=Ec,Se.Simple=ef;var tn=kt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[l(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[l(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var h=o.target;if(!!h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var p=this.getEvents();h.on(p,this),this.once("remove",function(){h.off(p,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});Rt.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var h=l(o);return this._layers[h]?this:(this._layers[h]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var h=l(o);return this._layers[h]?(this._loaded&&o.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return l(o)in this._layers},eachLayer:function(o,h){for(var p in this._layers)o.call(h,this._layers[p]);return this},_addLayers:function(o){o=o?D(o)?o:[o]:[];for(var h=0,p=o.length;h<p;h++)this.addLayer(o[h])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[l(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var h=l(o);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,h=-1/0,p=this._getZoomSpan();for(var g in this._zoomBoundLayers){var b=this._zoomBoundLayers[g].options;o=b.minZoom===void 0?o:Math.min(o,b.minZoom),h=b.maxZoom===void 0?h:Math.max(h,b.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=o===1/0?void 0:o,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Zs=tn.extend({initialize:function(o,h){w(this,h),this._layers={};var p,g;if(o)for(p=0,g=o.length;p<g;p++)this.addLayer(o[p])},addLayer:function(o){var h=this.getLayerId(o);return this._layers[h]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var h=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(o){var h=typeof o=="number"?o:this.getLayerId(o);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var h=Array.prototype.slice.call(arguments,1),p,g;for(p in this._layers)g=this._layers[p],g[o]&&g[o].apply(g,h);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,h){for(var p in this._layers)o.call(h,this._layers[p]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return l(o)}}),nf=function(o,h){return new Zs(o,h)},kn=Zs.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Zs.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Zs.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new Dt;for(var h in this._layers){var p=this._layers[h];o.extend(p.getBounds?p.getBounds():p.getLatLng())}return o}}),sf=function(o,h){return new kn(o,h)},Ws=Q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){w(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,h){var p=this._getIconUrl(o);if(!p){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(p,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(g,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(o,h){var p=this.options,g=p[h+"Size"];typeof g=="number"&&(g=[g,g]);var b=nt(g),S=nt(h==="shadow"&&p.shadowAnchor||p.iconAnchor||b&&b.divideBy(2,!0));o.className="leaflet-marker-"+h+" "+(p.className||""),S&&(o.style.marginLeft=-S.x+"px",o.style.marginTop=-S.y+"px"),b&&(o.style.width=b.x+"px",o.style.height=b.y+"px")},_createImg:function(o,h){return h=h||document.createElement("img"),h.src=o,h},_getIconUrl:function(o){return it.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function of(o){return new Ws(o)}var bo=Ws.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof bo.imagePath!="string"&&(bo.imagePath=this._detectIconPath()),(this.options.imagePath||bo.imagePath)+Ws.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var h=function(p,g,b){var S=g.exec(p);return S&&S[b]};return o=h(o,/^url\((['"])?(.+)\1\)$/,2),o&&h(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=Et("div","leaflet-default-icon-path",document.body),h=Ki(o,"background-image")||Ki(o,"backgroundImage");if(document.body.removeChild(o),h=this._stripUrl(h),h)return h;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Ic=Hi.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new Gn(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),gt(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var h=this._marker,p=h._map,g=this._marker.options.autoPanSpeed,b=this._marker.options.autoPanPadding,S=Ke(h._icon),O=p.getPixelBounds(),F=p.getPixelOrigin(),j=te(O.min._subtract(F).add(b),O.max._subtract(F).subtract(b));if(!j.contains(S)){var Y=nt((Math.max(j.max.x,S.x)-j.max.x)/(O.max.x-j.max.x)-(Math.min(j.min.x,S.x)-j.min.x)/(O.min.x-j.min.x),(Math.max(j.max.y,S.y)-j.max.y)/(O.max.y-j.max.y)-(Math.min(j.min.y,S.y)-j.min.y)/(O.min.y-j.min.y)).multiplyBy(g);p.panBy(Y,{animate:!1}),this._draggable._newPos._add(Y),this._draggable._startPos._add(Y),Ut(h._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=B(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(ot(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,o)))},_onDrag:function(o){var h=this._marker,p=h._shadow,g=Ke(h._icon),b=h._map.layerPointToLatLng(g);p&&Ut(p,g),h._latlng=b,o.latlng=b,o.oldLatLng=this._oldLatLng,h.fire("move",o).fire("drag",o)},_onDragEnd:function(o){ot(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),da=tn.extend({options:{icon:new bo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,h){w(this,h),this._latlng=Mt(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var h=this._latlng;return this._latlng=Mt(o),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=o.icon.createIcon(this._icon),g=!1;p!==this._icon&&(this._icon&&this._removeIcon(),g=!0,o.title&&(p.title=o.title),p.tagName==="IMG"&&(p.alt=o.alt||"")),gt(p,h),o.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&xt(p,"focus",this._panOnFocus,this);var b=o.icon.createShadow(this._shadow),S=!1;b!==this._shadow&&(this._removeShadow(),S=!0),b&&(gt(b,h),b.alt=""),this._shadow=b,o.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),b&&S&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Yt(this._icon,"focus",this._panOnFocus,this),Zt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Zt(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&Ut(this._icon,o),this._shadow&&Ut(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(h)},_initInteraction:function(){if(!!this.options.interactive&&(gt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ic)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ic(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&oe(this._icon,o),this._shadow&&oe(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(!!o){var h=this.options.icon.options,p=h.iconSize?nt(h.iconSize):nt(0,0),g=h.iconAnchor?nt(h.iconAnchor):nt(0,0);o.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:p.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function af(o,h){return new da(o,h)}var $n=tn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return w(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),fa=$n.extend({options:{fill:!0,radius:10},initialize:function(o,h){w(this,h),this._latlng=Mt(o),this._radius=this.options.radius},setLatLng:function(o){var h=this._latlng;return this._latlng=Mt(o),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var h=o&&o.radius||this._radius;return $n.prototype.setStyle.call(this,o),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,h=this._radiusY||o,p=this._clickTolerance(),g=[o+p,h+p];this._pxBounds=new wt(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function rf(o,h){return new fa(o,h)}var Fr=fa.extend({initialize:function(o,h,p){if(typeof h=="number"&&(h=n({},p,{radius:h})),w(this,h),this._latlng=Mt(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new Dt(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:$n.prototype.setStyle,_project:function(){var o=this._latlng.lng,h=this._latlng.lat,p=this._map,g=p.options.crs;if(g.distance===jt.distance){var b=Math.PI/180,S=this._mRadius/jt.R/b,O=p.project([h+S,o]),F=p.project([h-S,o]),j=O.add(F).divideBy(2),Y=p.unproject(j).lat,et=Math.acos((Math.cos(S*b)-Math.sin(h*b)*Math.sin(Y*b))/(Math.cos(h*b)*Math.cos(Y*b)))/b;(isNaN(et)||et===0)&&(et=S/Math.cos(Math.PI/180*h)),this._point=j.subtract(p.getPixelOrigin()),this._radius=isNaN(et)?0:j.x-p.project([Y,o-et]).x,this._radiusY=j.y-O.y}else{var ft=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(ft).x}this._updateBounds()}});function lf(o,h,p){return new Fr(o,h,p)}var An=$n.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,h){w(this,h),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var h=1/0,p=null,g=vo,b,S,O=0,F=this._parts.length;O<F;O++)for(var j=this._parts[O],Y=1,et=j.length;Y<et;Y++){b=j[Y-1],S=j[Y];var ft=g(o,b,S,!0);ft<h&&(h=ft,p=g(o,b,S))}return p&&(p.distance=Math.sqrt(h)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ac(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,h){return h=h||this._defaultShape(),o=Mt(o),h.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new Dt,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return Vi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var h=[],p=Vi(o),g=0,b=o.length;g<b;g++)p?(h[g]=Mt(o[g]),this._bounds.extend(h[g])):h[g]=this._convertLatLngs(o[g]);return h},_project:function(){var o=new wt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),h=new tt(o,o);!this._rawPxBounds||(this._pxBounds=new wt([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(o,h,p){var g=o[0]instanceof Pt,b=o.length,S,O;if(g){for(O=[],S=0;S<b;S++)O[S]=this._map.latLngToLayerPoint(o[S]),p.extend(O[S]);h.push(O)}else for(S=0;S<b;S++)this._projectLatlngs(o[S],h,p)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,p,g,b,S,O,F,j;for(p=0,b=0,S=this._rings.length;p<S;p++)for(j=this._rings[p],g=0,O=j.length;g<O-1;g++)F=Cc(j[g],j[g+1],o,g,!0),F&&(h[b]=h[b]||[],h[b].push(F[0]),(F[1]!==j[g+1]||g===O-2)&&(h[b].push(F[1]),b++))}},_simplifyPoints:function(){for(var o=this._parts,h=this.options.smoothFactor,p=0,g=o.length;p<g;p++)o[p]=Pc(o[p],h)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,h){var p,g,b,S,O,F,j=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(p=0,S=this._parts.length;p<S;p++)for(F=this._parts[p],g=0,O=F.length,b=O-1;g<O;b=g++)if(!(!h&&g===0)&&Tc(o,F[b],F[g])<=j)return!0;return!1}});function cf(o,h){return new An(o,h)}An._flat=kc;var Us=An.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Sc(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var h=An.prototype._convertLatLngs.call(this,o),p=h.length;return p>=2&&h[0]instanceof Pt&&h[0].equals(h[p-1])&&h.pop(),h},_setLatLngs:function(o){An.prototype._setLatLngs.call(this,o),Vi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Vi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,h=this.options.weight,p=new tt(h,h);if(o=new wt(o.min.subtract(p),o.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,b=this._rings.length,S;g<b;g++)S=Mc(this._rings[g],o,!0),S.length&&this._parts.push(S)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var h=!1,p,g,b,S,O,F,j,Y;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(S=0,j=this._parts.length;S<j;S++)for(p=this._parts[S],O=0,Y=p.length,F=Y-1;O<Y;F=O++)g=p[O],b=p[F],g.y>o.y!=b.y>o.y&&o.x<(b.x-g.x)*(o.y-g.y)/(b.y-g.y)+g.x&&(h=!h);return h||An.prototype._containsPoint.call(this,o,!0)}});function hf(o,h){return new Us(o,h)}var En=kn.extend({initialize:function(o,h){w(this,h),this._layers={},o&&this.addData(o)},addData:function(o){var h=D(o)?o:o.features,p,g,b;if(h){for(p=0,g=h.length;p<g;p++)b=h[p],(b.geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var S=this.options;if(S.filter&&!S.filter(o))return this;var O=pa(o,S);return O?(O.feature=_a(o),O.defaultOptions=O.options,this.resetStyle(O),S.onEachFeature&&S.onEachFeature(o,O),this.addLayer(O)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=n({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(h){this._setLayerStyle(h,o)},this)},_setLayerStyle:function(o,h){o.setStyle&&(typeof h=="function"&&(h=h(o.feature)),o.setStyle(h))}});function pa(o,h){var p=o.type==="Feature"?o.geometry:o,g=p?p.coordinates:null,b=[],S=h&&h.pointToLayer,O=h&&h.coordsToLatLng||Nr,F,j,Y,et;if(!g&&!p)return null;switch(p.type){case"Point":return F=O(g),Oc(S,o,F,h);case"MultiPoint":for(Y=0,et=g.length;Y<et;Y++)F=O(g[Y]),b.push(Oc(S,o,F,h));return new kn(b);case"LineString":case"MultiLineString":return j=ma(g,p.type==="LineString"?0:1,O),new An(j,h);case"Polygon":case"MultiPolygon":return j=ma(g,p.type==="Polygon"?1:2,O),new Us(j,h);case"GeometryCollection":for(Y=0,et=p.geometries.length;Y<et;Y++){var ft=pa({geometry:p.geometries[Y],type:"Feature",properties:o.properties},h);ft&&b.push(ft)}return new kn(b);case"FeatureCollection":for(Y=0,et=p.features.length;Y<et;Y++){var It=pa(p.features[Y],h);It&&b.push(It)}return new kn(b);default:throw new Error("Invalid GeoJSON object.")}}function Oc(o,h,p,g){return o?o(h,p):new da(p,g&&g.markersInheritOptions&&g)}function Nr(o){return new Pt(o[1],o[0],o[2])}function ma(o,h,p){for(var g=[],b=0,S=o.length,O;b<S;b++)O=h?ma(o[b],h-1,p):(p||Nr)(o[b]),g.push(O);return g}function Br(o,h){return o=Mt(o),o.alt!==void 0?[_(o.lng,h),_(o.lat,h),_(o.alt,h)]:[_(o.lng,h),_(o.lat,h)]}function ga(o,h,p,g){for(var b=[],S=0,O=o.length;S<O;S++)b.push(h?ga(o[S],Vi(o[S])?0:h-1,p,g):Br(o[S],g));return!h&&p&&b.length>0&&b.push(b[0].slice()),b}function qs(o,h){return o.feature?n({},o.feature,{geometry:h}):_a(h)}function _a(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var jr={toGeoJSON:function(o){return qs(this,{type:"Point",coordinates:Br(this.getLatLng(),o)})}};da.include(jr),Fr.include(jr),fa.include(jr),An.include({toGeoJSON:function(o){var h=!Vi(this._latlngs),p=ga(this._latlngs,h?1:0,!1,o);return qs(this,{type:(h?"Multi":"")+"LineString",coordinates:p})}}),Us.include({toGeoJSON:function(o){var h=!Vi(this._latlngs),p=h&&!Vi(this._latlngs[0]),g=ga(this._latlngs,p?2:h?1:0,!0,o);return h||(g=[g]),qs(this,{type:(p?"Multi":"")+"Polygon",coordinates:g})}}),Zs.include({toMultiPoint:function(o){var h=[];return this.eachLayer(function(p){h.push(p.toGeoJSON(o).geometry.coordinates)}),qs(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(o){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(o);var p=h==="GeometryCollection",g=[];return this.eachLayer(function(b){if(b.toGeoJSON){var S=b.toGeoJSON(o);if(p)g.push(S.geometry);else{var O=_a(S);O.type==="FeatureCollection"?g.push.apply(g,O.features):g.push(O)}}}),p?qs(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function Dc(o,h){return new En(o,h)}var uf=Dc,va=tn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,h,p){this._url=o,this._bounds=Ct(h),w(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(gt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Zt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&$e(this._image),this},bringToBack:function(){return this._map&&pi(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=Ct(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",h=this._image=o?this._url:Et("img");if(gt(h,"leaflet-image-layer"),this._zoomAnimated&&gt(h,"leaflet-zoom-animated"),this.options.className&&gt(h,this.options.className),h.onselectstart=m,h.onmousemove=m,h.onload=a(this.fire,this,"load"),h.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(o){var h=this._map.getZoomScale(o.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;Ni(this._image,p,h)},_reset:function(){var o=this._image,h=new wt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=h.getSize();Ut(o,h.min),o.style.width=p.x+"px",o.style.height=p.y+"px"},_updateOpacity:function(){oe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),df=function(o,h,p){return new va(o,h,p)},Rc=va.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",h=this._image=o?this._url:Et("video");if(gt(h,"leaflet-image-layer"),this._zoomAnimated&&gt(h,"leaflet-zoom-animated"),this.options.className&&gt(h,this.options.className),h.onselectstart=m,h.onmousemove=m,h.onloadeddata=a(this.fire,this,"load"),o){for(var p=h.getElementsByTagName("source"),g=[],b=0;b<p.length;b++)g.push(p[b].src);this._url=p.length>0?g:[h.src];return}D(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var S=0;S<this._url.length;S++){var O=Et("source");O.src=this._url[S],h.appendChild(O)}}});function ff(o,h,p){return new Rc(o,h,p)}var zc=va.extend({_initImage:function(){var o=this._image=this._url;gt(o,"leaflet-image-layer"),this._zoomAnimated&&gt(o,"leaflet-zoom-animated"),this.options.className&&gt(o,this.options.className),o.onselectstart=m,o.onmousemove=m}});function pf(o,h,p){return new zc(o,h,p)}var un=tn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,h){o&&(o instanceof Pt||D(o))?(this._latlng=Mt(o),w(this,h)):(w(this,o),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&oe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&oe(this._container,1),this.bringToFront(),this.options.interactive&&(gt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(oe(this._container,0),this._removeTimeout=setTimeout(a(Zt,void 0,this._container),200)):Zt(this._container),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=Mt(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&$e(this._container),this},bringToBack:function(){return this._map&&pi(this._container),this},_prepareOpen:function(o){var h=this._source;if(!h._map)return!1;if(h instanceof kn){h=null;var p=this._source._layers;for(var g in p)if(p[g]._map){h=p[g];break}if(!h)return!1;this._source=h}if(!o)if(h.getCenter)o=h.getCenter();else if(h.getLatLng)o=h.getLatLng();else if(h.getBounds)o=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(!!this._content){var o=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")o.innerHTML=h;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(!!this._map){var o=this._map.latLngToLayerPoint(this._latlng),h=nt(this.options.offset),p=this._getAnchor();this._zoomAnimated?Ut(this._container,o.add(p)):h=h.add(o).add(p);var g=this._containerBottom=-h.y,b=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=g+"px",this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}});Rt.include({_initOverlay:function(o,h,p,g){var b=h;return b instanceof o||(b=new o(g).setContent(h)),p&&b.setLatLng(p),b}}),tn.include({_initOverlay:function(o,h,p,g){var b=p;return b instanceof o?(w(b,g),b._source=this):(b=h&&!g?h:new o(g,this),b.setContent(p)),b}});var ba=un.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,un.prototype.openOn.call(this,o)},onAdd:function(o){un.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof $n||this._source.on("preclick",Ve))},onRemove:function(o){un.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof $n||this._source.off("preclick",Ve))},getEvents:function(){var o=un.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",h=this._container=Et("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=Et("div",o+"-content-wrapper",h);if(this._contentNode=Et("div",o+"-content",p),gi(h),Vs(this._contentNode),xt(h,"contextmenu",Ve),this._tipContainer=Et("div",o+"-tip-container",h),this._tip=Et("div",o+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=Et("a",o+"-close-button",h);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',xt(g,"click",function(b){Xt(b),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,h=o.style;h.width="",h.whiteSpace="nowrap";var p=o.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),h.width=p+1+"px",h.whiteSpace="",h.height="";var g=o.offsetHeight,b=this.options.maxHeight,S="leaflet-popup-scrolled";b&&g>b?(h.height=b+"px",gt(o,S)):Tt(o,S),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),p=this._getAnchor();Ut(this._container,h.add(p))},_adjustPan:function(){if(!!this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,h=parseInt(Ki(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+h,g=this._containerWidth,b=new tt(this._containerLeft,-p-this._containerBottom);b._add(Ke(this._container));var S=o.layerPointToContainerPoint(b),O=nt(this.options.autoPanPadding),F=nt(this.options.autoPanPaddingTopLeft||O),j=nt(this.options.autoPanPaddingBottomRight||O),Y=o.getSize(),et=0,ft=0;S.x+g+j.x>Y.x&&(et=S.x+g-Y.x+j.x),S.x-et-F.x<0&&(et=S.x-F.x),S.y+p+j.y>Y.y&&(ft=S.y+p-Y.y+j.y),S.y-ft-F.y<0&&(ft=S.y-F.y),(et||ft)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([et,ft]))}},_getAnchor:function(){return nt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),mf=function(o,h){return new ba(o,h)};Rt.mergeOptions({closePopupOnClick:!0}),Rt.include({openPopup:function(o,h,p){return this._initOverlay(ba,o,h,p).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),tn.include({bindPopup:function(o,h){return this._popup=this._initOverlay(ba,this._popup,o,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof kn||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){Cn(o);var h=o.layer||o.target;if(this._popup._source===h&&!(h instanceof $n)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=h,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var ya=un.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){un.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){un.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=un.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",h=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Et("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var h,p,g=this._map,b=this._container,S=g.latLngToContainerPoint(g.getCenter()),O=g.layerPointToContainerPoint(o),F=this.options.direction,j=b.offsetWidth,Y=b.offsetHeight,et=nt(this.options.offset),ft=this._getAnchor();F==="top"?(h=j/2,p=Y):F==="bottom"?(h=j/2,p=0):F==="center"?(h=j/2,p=Y/2):F==="right"?(h=0,p=Y/2):F==="left"?(h=j,p=Y/2):O.x<S.x?(F="right",h=0,p=Y/2):(F="left",h=j+(et.x+ft.x)*2,p=Y/2),o=o.subtract(nt(h,p,!0)).add(et).add(ft),Tt(b,"leaflet-tooltip-right"),Tt(b,"leaflet-tooltip-left"),Tt(b,"leaflet-tooltip-top"),Tt(b,"leaflet-tooltip-bottom"),gt(b,"leaflet-tooltip-"+F),Ut(b,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&oe(this._container,o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(h)},_getAnchor:function(){return nt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),gf=function(o,h){return new ya(o,h)};Rt.include({openTooltip:function(o,h,p){return this._initOverlay(ya,o,h,p).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),tn.include({bindTooltip:function(o,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ya,this._tooltip,o,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var h=o?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[h](p),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof kn||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&(xt(h,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),xt(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var h=o.latlng,p,g;this._tooltip.options.sticky&&o.originalEvent&&(p=this._map.mouseEventToContainerPoint(o.originalEvent),g=this._map.containerPointToLayerPoint(p),h=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(h)}});var Fc=Ws.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var h=o&&o.tagName==="DIV"?o:document.createElement("div"),p=this.options;if(p.html instanceof Element?(Le(h),h.appendChild(p.html)):h.innerHTML=p.html!==!1?p.html:"",p.bgPos){var g=nt(p.bgPos);h.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function _f(o){return new Fc(o)}Ws.Default=bo;var yo=tn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:it.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){w(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),Zt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&($e(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(pi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof tt?o:new tt(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var h=this.getPane().children,p=-o(-1/0,1/0),g=0,b=h.length,S;g<b;g++)S=h[g].style.zIndex,h[g]!==this._container&&S&&(p=o(p,+S));isFinite(p)&&(this.options.zIndex=p+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(!!this._map&&!it.ielt9){oe(this._container,this.options.opacity);var o=+new Date,h=!1,p=!1;for(var g in this._tiles){var b=this._tiles[g];if(!(!b.current||!b.loaded)){var S=Math.min(1,(o-b.loaded)/200);oe(b.el,S),S<1?h=!0:(b.active?p=!0:this._onOpaqueTile(b),b.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),h&&(ot(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Et("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,h=this.options.maxZoom;if(o!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===o?(this._levels[p].el.style.zIndex=h-Math.abs(o-p),this._onUpdateLevel(p)):(Zt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var g=this._levels[o],b=this._map;return g||(g=this._levels[o]={},g.el=Et("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=h,g.origin=b.project(b.unproject(b.getPixelOrigin()),o).round(),g.zoom=o,this._setZoomTransform(g,b.getCenter(),b.getZoom()),m(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(!!this._map){var o,h,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)h=this._tiles[o],h.retain=h.current;for(o in this._tiles)if(h=this._tiles[o],h.current&&!h.active){var g=h.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var h in this._tiles)this._tiles[h].coords.z===o&&this._removeTile(h)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)Zt(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,h,p,g){var b=Math.floor(o/2),S=Math.floor(h/2),O=p-1,F=new tt(+b,+S);F.z=+O;var j=this._tileCoordsToKey(F),Y=this._tiles[j];return Y&&Y.active?(Y.retain=!0,!0):(Y&&Y.loaded&&(Y.retain=!0),O>g?this._retainParent(b,S,O,g):!1)},_retainChildren:function(o,h,p,g){for(var b=2*o;b<2*o+2;b++)for(var S=2*h;S<2*h+2;S++){var O=new tt(b,S);O.z=p+1;var F=this._tileCoordsToKey(O),j=this._tiles[F];if(j&&j.active){j.retain=!0;continue}else j&&j.loaded&&(j.retain=!0);p+1<g&&this._retainChildren(b,S,p+1,g)}},_resetView:function(o){var h=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var h=this.options;return h.minNativeZoom!==void 0&&o<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<o?h.maxNativeZoom:o},_setView:function(o,h,p,g){var b=Math.round(h);this.options.maxZoom!==void 0&&b>this.options.maxZoom||this.options.minZoom!==void 0&&b<this.options.minZoom?b=void 0:b=this._clampZoom(b);var S=this.options.updateWhenZooming&&b!==this._tileZoom;(!g||S)&&(this._tileZoom=b,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),b!==void 0&&this._update(o),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(o,h)},_setZoomTransforms:function(o,h){for(var p in this._levels)this._setZoomTransform(this._levels[p],o,h)},_setZoomTransform:function(o,h,p){var g=this._map.getZoomScale(p,o.zoom),b=o.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(h,p)).round();it.any3d?Ni(o.el,b,g):Ut(o.el,b)},_resetGrid:function(){var o=this._map,h=o.options.crs,p=this._tileSize=this.getTileSize(),g=this._tileZoom,b=this._map.getPixelWorldBounds(this._tileZoom);b&&(this._globalTileRange=this._pxBoundsToTileRange(b)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,h.wrapLng[0]],g).x/p.x),Math.ceil(o.project([0,h.wrapLng[1]],g).x/p.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([h.wrapLat[0],0],g).y/p.x),Math.ceil(o.project([h.wrapLat[1],0],g).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var h=this._map,p=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),g=h.getZoomScale(p,this._tileZoom),b=h.project(o,this._tileZoom).floor(),S=h.getSize().divideBy(g*2);return new wt(b.subtract(S),b.add(S))},_update:function(o){var h=this._map;if(!!h){var p=this._clampZoom(h.getZoom());if(o===void 0&&(o=h.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(o),b=this._pxBoundsToTileRange(g),S=b.getCenter(),O=[],F=this.options.keepBuffer,j=new wt(b.getBottomLeft().subtract([F,-F]),b.getTopRight().add([F,-F]));if(!(isFinite(b.min.x)&&isFinite(b.min.y)&&isFinite(b.max.x)&&isFinite(b.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Y in this._tiles){var et=this._tiles[Y].coords;(et.z!==this._tileZoom||!j.contains(new tt(et.x,et.y)))&&(this._tiles[Y].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(o,p);return}for(var ft=b.min.y;ft<=b.max.y;ft++)for(var It=b.min.x;It<=b.max.x;It++){var li=new tt(It,ft);if(li.z=this._tileZoom,!!this._isValidTile(li)){var Oe=this._tiles[this._tileCoordsToKey(li)];Oe?Oe.current=!0:O.push(li)}}if(O.sort(function(_i,Xs){return _i.distanceTo(S)-Xs.distanceTo(S)}),O.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Zi=document.createDocumentFragment();for(It=0;It<O.length;It++)this._addTile(O[It],Zi);this._level.el.appendChild(Zi)}}}},_isValidTile:function(o){var h=this._map.options.crs;if(!h.infinite){var p=this._globalTileRange;if(!h.wrapLng&&(o.x<p.min.x||o.x>p.max.x)||!h.wrapLat&&(o.y<p.min.y||o.y>p.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(o);return Ct(this.options.bounds).overlaps(g)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var h=this._map,p=this.getTileSize(),g=o.scaleBy(p),b=g.add(p),S=h.unproject(g,o.z),O=h.unproject(b,o.z);return[S,O]},_tileCoordsToBounds:function(o){var h=this._tileCoordsToNwSe(o),p=new Dt(h[0],h[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var h=o.split(":"),p=new tt(+h[0],+h[1]);return p.z=+h[2],p},_removeTile:function(o){var h=this._tiles[o];!h||(Zt(h.el),delete this._tiles[o],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){gt(o,"leaflet-tile");var h=this.getTileSize();o.style.width=h.x+"px",o.style.height=h.y+"px",o.onselectstart=m,o.onmousemove=m,it.ielt9&&this.options.opacity<1&&oe(o,this.options.opacity)},_addTile:function(o,h){var p=this._getTilePos(o),g=this._tileCoordsToKey(o),b=this.createTile(this._wrapCoords(o),a(this._tileReady,this,o));this._initTile(b),this.createTile.length<2&&B(a(this._tileReady,this,o,null,b)),Ut(b,p),this._tiles[g]={el:b,coords:o,current:!0},h.appendChild(b),this.fire("tileloadstart",{tile:b,coords:o})},_tileReady:function(o,h,p){h&&this.fire("tileerror",{error:h,tile:p,coords:o});var g=this._tileCoordsToKey(o);p=this._tiles[g],p&&(p.loaded=+new Date,this._map._fadeAnimated?(oe(p.el,0),ot(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),h||(gt(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),it.ielt9||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var h=new tt(this._wrapX?f(o.x,this._wrapX):o.x,this._wrapY?f(o.y,this._wrapY):o.y);return h.z=o.z,h},_pxBoundsToTileRange:function(o){var h=this.getTileSize();return new wt(o.min.unscaleBy(h).floor(),o.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function vf(o){return new yo(o)}var Ys=yo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,h){this._url=o,h=w(this,h),h.detectRetina&&it.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,h){return this._url===o&&h===void 0&&(h=!0),this._url=o,h||this.redraw(),this},createTile:function(o,h){var p=document.createElement("img");return xt(p,"load",a(this._tileOnLoad,this,h,p)),xt(p,"error",a(this._tileOnError,this,h,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(o),p},getTileUrl:function(o){var h={r:it.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-o.y;this.options.tms&&(h.y=p),h["-y"]=p}return E(this._url,n(h,this.options))},_tileOnLoad:function(o,h){it.ielt9?setTimeout(a(o,this,null,h),0):o(null,h)},_tileOnError:function(o,h,p){var g=this.options.errorTileUrl;g&&h.getAttribute("src")!==g&&(h.src=g),o(p,h)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,h=this.options.maxZoom,p=this.options.zoomReverse,g=this.options.zoomOffset;return p&&(o=h-o),o+g},_getSubdomain:function(o){var h=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var o,h;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(h=this._tiles[o].el,h.onload=m,h.onerror=m,!h.complete)){h.src=V;var p=this._tiles[o].coords;Zt(h),delete this._tiles[o],this.fire("tileabort",{tile:h,coords:p})}},_removeTile:function(o){var h=this._tiles[o];if(!!h)return h.el.setAttribute("src",V),yo.prototype._removeTile.call(this,o)},_tileReady:function(o,h,p){if(!(!this._map||p&&p.getAttribute("src")===V))return yo.prototype._tileReady.call(this,o,h,p)}});function Nc(o,h){return new Ys(o,h)}var Bc=Ys.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,h){this._url=o;var p=n({},this.defaultWmsParams);for(var g in h)g in this.options||(p[g]=h[g]);h=w(this,h);var b=h.detectRetina&&it.retina?2:1,S=this.getTileSize();p.width=S.x*b,p.height=S.y*b,this.wmsParams=p},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Ys.prototype.onAdd.call(this,o)},getTileUrl:function(o){var h=this._tileCoordsToNwSe(o),p=this._crs,g=te(p.project(h[0]),p.project(h[1])),b=g.min,S=g.max,O=(this._wmsVersion>=1.3&&this._crs===Ec?[b.y,b.x,S.y,S.x]:[b.x,b.y,S.x,S.y]).join(","),F=Ys.prototype.getTileUrl.call(this,o);return F+k(this.wmsParams,F,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+O},setParams:function(o,h){return n(this.wmsParams,o),h||this.redraw(),this}});function bf(o,h){return new Bc(o,h)}Ys.WMS=Bc,Nc.wms=bf;var In=tn.extend({options:{padding:.1},initialize:function(o){w(this,o),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),gt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,h){var p=this._map.getZoomScale(h,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),b=this._map.project(this._center,h),S=g.multiplyBy(-p).add(b).subtract(this._map._getNewPixelOrigin(o,h));it.any3d?Ni(this._container,S,p):Ut(this._container,S)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,h=this._map.getSize(),p=this._map.containerPointToLayerPoint(h.multiplyBy(-o)).round();this._bounds=new wt(p,p.add(h.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),jc=In.extend({options:{tolerance:0},getEvents:function(){var o=In.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){In.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");xt(o,"mousemove",this._onMouseMove,this),xt(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),xt(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){ot(this._redrawRequest),delete this._ctx,Zt(this._container),Yt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var h in this._layers)o=this._layers[h],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){In.prototype._update.call(this);var o=this._bounds,h=this._container,p=o.getSize(),g=it.retina?2:1;Ut(h,o.min),h.width=g*p.x,h.height=g*p.y,h.style.width=p.x+"px",h.style.height=p.y+"px",it.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){In.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[l(o)]=o;var h=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var h=o._order,p=h.next,g=h.prev;p?p.prev=g:this._drawLast=g,g?g.next=p:this._drawFirst=p,delete o._order,delete this._layers[l(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var h=o.options.dashArray.split(/[, ]+/),p=[],g,b;for(b=0;b<h.length;b++){if(g=Number(h[b]),isNaN(g))return;p.push(g)}o.options._dashArray=p}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){!this._map||(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var h=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new wt,this._redrawBounds.extend(o._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(o._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var h=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,h=this._redrawBounds;if(this._ctx.save(),h){var p=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)o=g.layer,(!h||o._pxBounds&&o._pxBounds.intersects(h))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,h){if(!!this._drawing){var p,g,b,S,O=o._parts,F=O.length,j=this._ctx;if(!!F){for(j.beginPath(),p=0;p<F;p++){for(g=0,b=O[p].length;g<b;g++)S=O[p][g],j[g?"lineTo":"moveTo"](S.x,S.y);h&&j.closePath()}this._fillStroke(j,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var h=o._point,p=this._ctx,g=Math.max(Math.round(o._radius),1),b=(Math.max(Math.round(o._radiusY),1)||g)/g;b!==1&&(p.save(),p.scale(1,b)),p.beginPath(),p.arc(h.x,h.y/b,g,0,Math.PI*2,!1),b!==1&&p.restore(),this._fillStroke(p,o)}},_fillStroke:function(o,h){var p=h.options;p.fill&&(o.globalAlpha=p.fillOpacity,o.fillStyle=p.fillColor||p.color,o.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(o.setLineDash&&o.setLineDash(h.options&&h.options._dashArray||[]),o.globalAlpha=p.opacity,o.lineWidth=p.weight,o.strokeStyle=p.color,o.lineCap=p.lineCap,o.lineJoin=p.lineJoin,o.stroke())},_onClick:function(o){for(var h=this._map.mouseEventToLayerPoint(o),p,g,b=this._drawFirst;b;b=b.next)p=b.layer,p.options.interactive&&p._containsPoint(h)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(p))&&(g=p);this._fireEvent(g?[g]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,h)}},_handleMouseOut:function(o){var h=this._hoveredLayer;h&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([h],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,h){if(!this._mouseHoverThrottled){for(var p,g,b=this._drawFirst;b;b=b.next)p=b.layer,p.options.interactive&&p._containsPoint(h)&&(g=p);g!==this._hoveredLayer&&(this._handleMouseOut(o),g&&(gt(this._container,"leaflet-interactive"),this._fireEvent([g],o,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,h,p){this._map._fireDOMEvent(h,p||h.type,o)},_bringToFront:function(o){var h=o._order;if(!!h){var p=h.next,g=h.prev;if(p)p.prev=g;else return;g?g.next=p:p&&(this._drawFirst=p),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(o)}},_bringToBack:function(o){var h=o._order;if(!!h){var p=h.next,g=h.prev;if(g)g.next=p;else return;p?p.prev=g:g&&(this._drawLast=g),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(o)}}});function Hc(o){return it.canvas?new jc(o):null}var xo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),yf={_initContainer:function(){this._container=Et("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(In.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var h=o._container=xo("shape");gt(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",o._path=xo("path"),h.appendChild(o._path),this._updateStyle(o),this._layers[l(o)]=o},_addPath:function(o){var h=o._container;this._container.appendChild(h),o.options.interactive&&o.addInteractiveTarget(h)},_removePath:function(o){var h=o._container;Zt(h),o.removeInteractiveTarget(h),delete this._layers[l(o)]},_updateStyle:function(o){var h=o._stroke,p=o._fill,g=o.options,b=o._container;b.stroked=!!g.stroke,b.filled=!!g.fill,g.stroke?(h||(h=o._stroke=xo("stroke")),b.appendChild(h),h.weight=g.weight+"px",h.color=g.color,h.opacity=g.opacity,g.dashArray?h.dashStyle=D(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=g.lineCap.replace("butt","flat"),h.joinstyle=g.lineJoin):h&&(b.removeChild(h),o._stroke=null),g.fill?(p||(p=o._fill=xo("fill")),b.appendChild(p),p.color=g.fillColor||g.color,p.opacity=g.fillOpacity):p&&(b.removeChild(p),o._fill=null)},_updateCircle:function(o){var h=o._point.round(),p=Math.round(o._radius),g=Math.round(o._radiusY||p);this._setPath(o,o._empty()?"M0 0":"AL "+h.x+","+h.y+" "+p+","+g+" 0,"+65535*360)},_setPath:function(o,h){o._path.v=h},_bringToFront:function(o){$e(o._container)},_bringToBack:function(o){pi(o._container)}},xa=it.vml?xo:Ne,wo=In.extend({_initContainer:function(){this._container=xa("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=xa("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Zt(this._container),Yt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){In.prototype._update.call(this);var o=this._bounds,h=o.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,p.setAttribute("width",h.x),p.setAttribute("height",h.y)),Ut(p,o.min),p.setAttribute("viewBox",[o.min.x,o.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(o){var h=o._path=xa("path");o.options.className&&gt(h,o.options.className),o.options.interactive&&gt(h,"leaflet-interactive"),this._updateStyle(o),this._layers[l(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){Zt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[l(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var h=o._path,p=o.options;!h||(p.stroke?(h.setAttribute("stroke",p.color),h.setAttribute("stroke-opacity",p.opacity),h.setAttribute("stroke-width",p.weight),h.setAttribute("stroke-linecap",p.lineCap),h.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?h.setAttribute("stroke-dasharray",p.dashArray):h.removeAttribute("stroke-dasharray"),p.dashOffset?h.setAttribute("stroke-dashoffset",p.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),p.fill?(h.setAttribute("fill",p.fillColor||p.color),h.setAttribute("fill-opacity",p.fillOpacity),h.setAttribute("fill-rule",p.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(o,h){this._setPath(o,Yi(o._parts,h))},_updateCircle:function(o){var h=o._point,p=Math.max(Math.round(o._radius),1),g=Math.max(Math.round(o._radiusY),1)||p,b="a"+p+","+g+" 0 1,0 ",S=o._empty()?"M0 0":"M"+(h.x-p)+","+h.y+b+p*2+",0 "+b+-p*2+",0 ";this._setPath(o,S)},_setPath:function(o,h){o._path.setAttribute("d",h)},_bringToFront:function(o){$e(o._path)},_bringToBack:function(o){pi(o._path)}});it.vml&&wo.include(yf);function Vc(o){return it.svg||it.vml?new wo(o):null}Rt.include({getRenderer:function(o){var h=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var h=this._paneRenderers[o];return h===void 0&&(h=this._createRenderer({pane:o}),this._paneRenderers[o]=h),h},_createRenderer:function(o){return this.options.preferCanvas&&Hc(o)||Vc(o)}});var Zc=Us.extend({initialize:function(o,h){Us.prototype.initialize.call(this,this._boundsToLatLngs(o),h)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=Ct(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function xf(o,h){return new Zc(o,h)}wo.create=xa,wo.pointsToPath=Yi,En.geometryToLayer=pa,En.coordsToLatLng=Nr,En.coordsToLatLngs=ma,En.latLngToCoords=Br,En.latLngsToCoords=ga,En.getFeature=qs,En.asFeature=_a,Rt.mergeOptions({boxZoom:!0});var Wc=Hi.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){xt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Yt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Zt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),M(),U(),this._startPoint=this._map.mouseEventToContainerPoint(o),xt(document,{contextmenu:Cn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=Et("div","leaflet-zoom-box",this._container),gt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var h=new wt(this._point,this._startPoint),p=h.getSize();Ut(this._box,h.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(Zt(this._box),Tt(this._container,"leaflet-crosshair")),T(),J(),Yt(document,{contextmenu:Cn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var h=new Dt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Rt.addInitHook("addHandler","boxZoom",Wc),Rt.mergeOptions({doubleClickZoom:!0});var Uc=Hi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var h=this._map,p=h.getZoom(),g=h.options.zoomDelta,b=o.originalEvent.shiftKey?p-g:p+g;h.options.doubleClickZoom==="center"?h.setZoom(b):h.setZoomAround(o.containerPoint,b)}});Rt.addInitHook("addHandler","doubleClickZoom",Uc),Rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var qc=Hi.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new Gn(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}gt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tt(this._map._container,"leaflet-grab"),Tt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=Ct(this._map.options.maxBounds);this._offsetLimit=te(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var h=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(h),this._prunePositions(h)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,h){return o-(o-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;o.x<h.min.x&&(o.x=this._viscousLimit(o.x,h.min.x)),o.y<h.min.y&&(o.y=this._viscousLimit(o.y,h.min.y)),o.x>h.max.x&&(o.x=this._viscousLimit(o.x,h.max.x)),o.y>h.max.y&&(o.y=this._viscousLimit(o.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,h=Math.round(o/2),p=this._initialWorldOffset,g=this._draggable._newPos.x,b=(g-h+p)%o+h-p,S=(g+h+p)%o-h-p,O=Math.abs(b+p)<Math.abs(S+p)?b:S;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=O},_onDragEnd:function(o){var h=this._map,p=h.options,g=!p.inertia||o.noInertia||this._times.length<2;if(h.fire("dragend",o),g)h.fire("moveend");else{this._prunePositions(+new Date);var b=this._lastPos.subtract(this._positions[0]),S=(this._lastTime-this._times[0])/1e3,O=p.easeLinearity,F=b.multiplyBy(O/S),j=F.distanceTo([0,0]),Y=Math.min(p.inertiaMaxSpeed,j),et=F.multiplyBy(Y/j),ft=Y/(p.inertiaDeceleration*O),It=et.multiplyBy(-ft/2).round();!It.x&&!It.y?h.fire("moveend"):(It=h._limitOffset(It,h.options.maxBounds),B(function(){h.panBy(It,{duration:ft,easeLinearity:O,noMoveStart:!0,animate:!0})}))}}});Rt.addInitHook("addHandler","dragging",qc),Rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Yc=Hi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),xt(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Yt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,h=document.documentElement,p=o.scrollTop||h.scrollTop,g=o.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(g,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var h=this._panKeys={},p=this.keyCodes,g,b;for(g=0,b=p.left.length;g<b;g++)h[p.left[g]]=[-1*o,0];for(g=0,b=p.right.length;g<b;g++)h[p.right[g]]=[o,0];for(g=0,b=p.down.length;g<b;g++)h[p.down[g]]=[0,o];for(g=0,b=p.up.length;g<b;g++)h[p.up[g]]=[0,-1*o]},_setZoomDelta:function(o){var h=this._zoomKeys={},p=this.keyCodes,g,b;for(g=0,b=p.zoomIn.length;g<b;g++)h[p.zoomIn[g]]=o;for(g=0,b=p.zoomOut.length;g<b;g++)h[p.zoomOut[g]]=-o},_addHooks:function(){xt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Yt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var h=o.keyCode,p=this._map,g;if(h in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(g=this._panKeys[h],o.shiftKey&&(g=nt(g).multiplyBy(3)),p.options.maxBounds&&(g=p._limitOffset(nt(g),p.options.maxBounds)),p.options.worldCopyJump){var b=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(g)));p.panTo(b)}else p.panBy(g)}else if(h in this._zoomKeys)p.setZoom(p.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Cn(o)}}});Rt.addInitHook("addHandler","keyboard",Yc),Rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Xc=Hi.extend({addHooks:function(){xt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Yt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var h=Bi(o),p=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var g=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),g),Cn(o)},_performZoom:function(){var o=this._map,h=o.getZoom(),p=this._map.options.zoomSnap||0;o._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),b=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,S=p?Math.ceil(b/p)*p:b,O=o._limitZoom(h+(this._delta>0?S:-S))-h;this._delta=0,this._startTime=null,O&&(o.options.scrollWheelZoom==="center"?o.setZoom(h+O):o.setZoomAround(this._lastMousePos,h+O))}});Rt.addInitHook("addHandler","scrollWheelZoom",Xc);var wf=600;Rt.mergeOptions({tapHold:it.touchNative&&it.safari&&it.mobile,tapTolerance:15});var Gc=Hi.extend({addHooks:function(){xt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Yt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var h=o.touches[0];this._startPos=this._newPos=new tt(h.clientX,h.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(xt(document,"touchend",Xt),xt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),wf),xt(document,"touchend touchcancel contextmenu",this._cancel,this),xt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Yt(document,"touchend",Xt),Yt(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Yt(document,"touchend touchcancel contextmenu",this._cancel,this),Yt(document,"touchmove",this._onMove,this)},_onMove:function(o){var h=o.touches[0];this._newPos=new tt(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,h){var p=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});p._simulated=!0,h.target.dispatchEvent(p)}});Rt.addInitHook("addHandler","tapHold",Gc),Rt.mergeOptions({touchZoom:it.touch,bounceAtZoomLimits:!0});var $c=Hi.extend({addHooks:function(){gt(this._map._container,"leaflet-touch-zoom"),xt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),Yt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var h=this._map;if(!(!o.touches||o.touches.length!==2||h._animatingZoom||this._zooming)){var p=h.mouseEventToContainerPoint(o.touches[0]),g=h.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(p.add(g)._divideBy(2))),this._startDist=p.distanceTo(g),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),xt(document,"touchmove",this._onTouchMove,this),xt(document,"touchend touchcancel",this._onTouchEnd,this),Xt(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var h=this._map,p=h.mouseEventToContainerPoint(o.touches[0]),g=h.mouseEventToContainerPoint(o.touches[1]),b=p.distanceTo(g)/this._startDist;if(this._zoom=h.getScaleZoom(b,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&b<1||this._zoom>h.getMaxZoom()&&b>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,b===1)return}else{var S=p._add(g)._divideBy(2)._subtract(this._centerPoint);if(b===1&&S.x===0&&S.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(S),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),ot(this._animRequest);var O=a(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=B(O,this,!0),Xt(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ot(this._animRequest),Yt(document,"touchmove",this._onTouchMove,this),Yt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Rt.addInitHook("addHandler","touchZoom",$c),Rt.BoxZoom=Wc,Rt.DoubleClickZoom=Uc,Rt.Drag=qc,Rt.Keyboard=Yc,Rt.ScrollWheelZoom=Xc,Rt.TapHold=Gc,Rt.TouchZoom=$c,e.Bounds=wt,e.Browser=it,e.CRS=Se,e.Canvas=jc,e.Circle=Fr,e.CircleMarker=fa,e.Class=Q,e.Control=Si,e.DivIcon=Fc,e.DivOverlay=un,e.DomEvent=kr,e.DomUtil=oa,e.Draggable=Gn,e.Evented=kt,e.FeatureGroup=kn,e.GeoJSON=En,e.GridLayer=yo,e.Handler=Hi,e.Icon=Ws,e.ImageOverlay=va,e.LatLng=Pt,e.LatLngBounds=Dt,e.Layer=tn,e.LayerGroup=Zs,e.LineUtil=Jd,e.Map=Rt,e.Marker=da,e.Mixin=Er,e.Path=$n,e.Point=tt,e.PolyUtil=Yd,e.Polygon=Us,e.Polyline=An,e.Popup=ba,e.PosAnimation=ca,e.Projection=Qd,e.Rectangle=Zc,e.Renderer=In,e.SVG=wo,e.SVGOverlay=zc,e.TileLayer=Ys,e.Tooltip=ya,e.Transformation=_e,e.Util=ut,e.VideoOverlay=Rc,e.bind=a,e.bounds=te,e.canvas=Hc,e.circle=lf,e.circleMarker=rf,e.control=hn,e.divIcon=_f,e.extend=n,e.featureGroup=sf,e.geoJSON=Dc,e.geoJson=uf,e.gridLayer=vf,e.icon=of,e.imageOverlay=df,e.latLng=Mt,e.latLngBounds=Ct,e.layerGroup=nf,e.map=ha,e.marker=af,e.point=nt,e.polygon=hf,e.polyline=cf,e.popup=mf,e.rectangle=xf,e.setOptions=w,e.stamp=l,e.svg=Vc,e.svgOverlay=pf,e.tileLayer=Nc,e.tooltip=gf,e.transformation=Pe,e.version=t,e.videoOverlay=ff;var Mf=window.L;e.noConflict=function(){return window.L=Mf,this},window.L=e})});var sh=Vr((tl,el)=>{(function(e,t){typeof tl=="object"&&typeof el<"u"?el.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.Spectrum=t())})(tl,function(){"use strict";let e=/^\s+/,t=/\s+$/;function n(P,C){if(P=P||"",C=C||{},P instanceof n)return P;if(!(this instanceof n))return new n(P,C);var x=s(P);this._originalInput=P,this._r=x.r,this._g=x.g,this._b=x.b,this._a=x.a,this._roundA=Math.round(100*this._a)/100,this._format=C.format||x.format,this._gradientType=C.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=x.ok}n.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var P=this.toRgb();return(P.r*299+P.g*587+P.b*114)/1e3},getLuminance:function(){var P=this.toRgb(),C,x,R,Z,q,ct;return C=P.r/255,x=P.g/255,R=P.b/255,C<=.03928?Z=C/12.92:Z=Math.pow((C+.055)/1.055,2.4),x<=.03928?q=x/12.92:q=Math.pow((x+.055)/1.055,2.4),R<=.03928?ct=R/12.92:ct=Math.pow((R+.055)/1.055,2.4),.2126*Z+.7152*q+.0722*ct},setAlpha:function(P){return this._a=ut(P),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var P=u(this._r,this._g,this._b);return{h:P.h*360,s:P.s,v:P.v,a:this._a}},toHsvString:function(){var P=u(this._r,this._g,this._b),C=Math.round(P.h*360),x=Math.round(P.s*100),R=Math.round(P.v*100);return this._a==1?"hsv("+C+", "+x+"%, "+R+"%)":"hsva("+C+", "+x+"%, "+R+"%, "+this._roundA+")"},toHsl:function(){var P=r(this._r,this._g,this._b);return{h:P.h*360,s:P.s,l:P.l,a:this._a}},toHslString:function(){var P=r(this._r,this._g,this._b),C=Math.round(P.h*360),x=Math.round(P.s*100),R=Math.round(P.l*100);return this._a==1?"hsl("+C+", "+x+"%, "+R+"%)":"hsla("+C+", "+x+"%, "+R+"%, "+this._roundA+")"},toHex:function(P){return m(this._r,this._g,this._b,P)},toHexString:function(P){return"#"+this.toHex(P)},toHex8:function(P){return _(this._r,this._g,this._b,this._a,P)},toHex8String:function(P){return"#"+this.toHex8(P)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Q(this._r,255)*100)+"%",g:Math.round(Q(this._g,255)*100)+"%",b:Math.round(Q(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Q(this._r,255)*100)+"%, "+Math.round(Q(this._g,255)*100)+"%, "+Math.round(Q(this._b,255)*100)+"%)":"rgba("+Math.round(Q(this._r,255)*100)+"%, "+Math.round(Q(this._g,255)*100)+"%, "+Math.round(Q(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:B[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(P){var C="#"+v(this._r,this._g,this._b,this._a),x=C,R=this._gradientType?"GradientType = 1, ":"";if(P){var Z=n(P);x="#"+v(Z._r,Z._g,Z._b,Z._a)}return"progid:DXImageTransform.Microsoft.gradient("+R+"startColorstr="+C+",endColorstr="+x+")"},toString:function(P){var C=!!P;P=P||this._format;var x=!1,R=this._a<1&&this._a>=0,Z=!C&&R&&(P==="hex"||P==="hex6"||P==="hex3"||P==="hex4"||P==="hex8"||P==="name");return Z?P==="name"&&this._a===0?this.toName():this.toRgbString():(P==="rgb"&&(x=this.toRgbString()),P==="prgb"&&(x=this.toPercentageRgbString()),(P==="hex"||P==="hex6")&&(x=this.toHexString()),P==="hex3"&&(x=this.toHexString(!0)),P==="hex4"&&(x=this.toHex8String(!0)),P==="hex8"&&(x=this.toHex8String()),P==="name"&&(x=this.toName()),P==="hsl"&&(x=this.toHslString()),P==="hsv"&&(x=this.toHsvString()),x||this.toHexString())},clone:function(){return n(this.toString())},_applyModification:function(P,C){var x=P.apply(null,[this].concat([].slice.call(C)));return this._r=x._r,this._g=x._g,this._b=x._b,this.setAlpha(x._a),this},lighten:function(){return this._applyModification(A,arguments)},brighten:function(){return this._applyModification(E,arguments)},darken:function(){return this._applyModification(D,arguments)},desaturate:function(){return this._applyModification(y,arguments)},saturate:function(){return this._applyModification(w,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(z,arguments)},_applyCombination:function(P,C){return P.apply(null,[this].concat([].slice.call(C)))},analogous:function(){return this._applyCombination(X,arguments)},complement:function(){return this._applyCombination(V,arguments)},monochromatic:function(){return this._applyCombination($,arguments)},splitcomplement:function(){return this._applyCombination(H,arguments)},triad:function(){return this._applyCombination(W,[3])},tetrad:function(){return this._applyCombination(W,[4])}},n.fromRatio=function(P,C){if(typeof P=="object"){var x={};for(var R in P)P.hasOwnProperty(R)&&(R==="a"?x[R]=P[R]:x[R]=nt(P[R]));P=x}return n(P,C)};function s(P){var C={r:0,g:0,b:0},x=1,R=null,Z=null,q=null,ct=!1,_t=!1;return typeof P=="string"&&(P=Pt(P)),typeof P=="object"&&(Ct(P.r)&&Ct(P.g)&&Ct(P.b)?(C=a(P.r,P.g,P.b),ct=!0,_t=String(P.r).substr(-1)==="%"?"prgb":"rgb"):Ct(P.h)&&Ct(P.s)&&Ct(P.v)?(R=nt(P.s),Z=nt(P.v),C=f(P.h,R,Z),ct=!0,_t="hsv"):Ct(P.h)&&Ct(P.s)&&Ct(P.l)&&(R=nt(P.s),q=nt(P.l),C=l(P.h,R,q),ct=!0,_t="hsl"),P.hasOwnProperty("a")&&(x=P.a)),x=ut(x),{ok:ct,format:P.format||_t,r:Math.min(255,Math.max(C.r,0)),g:Math.min(255,Math.max(C.g,0)),b:Math.min(255,Math.max(C.b,0)),a:x}}function a(P,C,x){return{r:Q(P,255)*255,g:Q(C,255)*255,b:Q(x,255)*255}}function r(P,C,x){P=Q(P,255),C=Q(C,255),x=Q(x,255);var R=Math.max(P,C,x),Z=Math.min(P,C,x),q,ct,_t=(R+Z)/2;if(R==Z)q=ct=0;else{var mt=R-Z;switch(ct=_t>.5?mt/(2-R-Z):mt/(R+Z),R){case P:q=(C-x)/mt+(C<x?6:0);break;case C:q=(x-P)/mt+2;break;case x:q=(P-C)/mt+4;break}q/=6}return{h:q,s:ct,l:_t}}function l(P,C,x){var R,Z,q;P=Q(P,360),C=Q(C,100),x=Q(x,100);function ct(Wt,Ft,Ht){return Ht<0&&(Ht+=1),Ht>1&&(Ht-=1),Ht<1/6?Wt+(Ft-Wt)*6*Ht:Ht<1/2?Ft:Ht<2/3?Wt+(Ft-Wt)*(2/3-Ht)*6:Wt}if(C===0)R=Z=q=x;else{var _t=x<.5?x*(1+C):x+C-x*C,mt=2*x-_t;R=ct(mt,_t,P+1/3),Z=ct(mt,_t,P),q=ct(mt,_t,P-1/3)}return{r:R*255,g:Z*255,b:q*255}}function u(P,C,x){P=Q(P,255),C=Q(C,255),x=Q(x,255);var R=Math.max(P,C,x),Z=Math.min(P,C,x),q,ct,_t=R,mt=R-Z;if(ct=R===0?0:mt/R,R==Z)q=0;else{switch(R){case P:q=(C-x)/mt+(C<x?6:0);break;case C:q=(x-P)/mt+2;break;case x:q=(P-C)/mt+4;break}q/=6}return{h:q,s:ct,v:_t}}function f(P,C,x){P=Q(P,360)*6,C=Q(C,100),x=Q(x,100);var R=Math.floor(P),Z=P-R,q=x*(1-C),ct=x*(1-Z*C),_t=x*(1-(1-Z)*C),mt=R%6,Wt=[x,ct,q,q,_t,x][mt],Ft=[_t,x,x,ct,q,q][mt],Ht=[q,q,_t,x,x,ct][mt];return{r:Wt*255,g:Ft*255,b:Ht*255}}function m(P,C,x,R){var Z=[At(Math.round(P).toString(16)),At(Math.round(C).toString(16)),At(Math.round(x).toString(16))];return R&&Z[0].charAt(0)==Z[0].charAt(1)&&Z[1].charAt(0)==Z[1].charAt(1)&&Z[2].charAt(0)==Z[2].charAt(1)?Z[0].charAt(0)+Z[1].charAt(0)+Z[2].charAt(0):Z.join("")}function _(P,C,x,R,Z){var q=[At(Math.round(P).toString(16)),At(Math.round(C).toString(16)),At(Math.round(x).toString(16)),At(wt(R))];return Z&&q[0].charAt(0)==q[0].charAt(1)&&q[1].charAt(0)==q[1].charAt(1)&&q[2].charAt(0)==q[2].charAt(1)&&q[3].charAt(0)==q[3].charAt(1)?q[0].charAt(0)+q[1].charAt(0)+q[2].charAt(0)+q[3].charAt(0):q.join("")}function v(P,C,x,R){var Z=[At(wt(R)),At(Math.round(P).toString(16)),At(Math.round(C).toString(16)),At(Math.round(x).toString(16))];return Z.join("")}n.equals=function(P,C){return!P||!C?!1:n(P).toRgbString()==n(C).toRgbString()},n.random=function(){return n.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function y(P,C){C=C===0?0:C||10;var x=n(P).toHsl();return x.s-=C/100,x.s=$t(x.s),n(x)}function w(P,C){C=C===0?0:C||10;var x=n(P).toHsl();return x.s+=C/100,x.s=$t(x.s),n(x)}function k(P){return n(P).desaturate(100)}function A(P,C){C=C===0?0:C||10;var x=n(P).toHsl();return x.l+=C/100,x.l=$t(x.l),n(x)}function E(P,C){C=C===0?0:C||10;var x=n(P).toRgb();return x.r=Math.max(0,Math.min(255,x.r-Math.round(255*-(C/100)))),x.g=Math.max(0,Math.min(255,x.g-Math.round(255*-(C/100)))),x.b=Math.max(0,Math.min(255,x.b-Math.round(255*-(C/100)))),n(x)}function D(P,C){C=C===0?0:C||10;var x=n(P).toHsl();return x.l-=C/100,x.l=$t(x.l),n(x)}function z(P,C){var x=n(P).toHsl(),R=(x.h+C)%360;return x.h=R<0?360+R:R,n(x)}function V(P){var C=n(P).toHsl();return C.h=(C.h+180)%360,n(C)}function W(P,C){if(isNaN(C)||C<=0)throw new Error("Argument to polyad must be a positive number");for(var x=n(P).toHsl(),R=[n(P)],Z=360/C,q=1;q<C;q++)R.push(n({h:(x.h+q*Z)%360,s:x.s,l:x.l}));return R}function H(P){var C=n(P).toHsl(),x=C.h;return[n(P),n({h:(x+72)%360,s:C.s,l:C.l}),n({h:(x+216)%360,s:C.s,l:C.l})]}function X(P,C,x){C=C||6,x=x||30;var R=n(P).toHsl(),Z=360/x,q=[n(P)];for(R.h=(R.h-(Z*C>>1)+720)%360;--C;)R.h=(R.h+Z)%360,q.push(n(R));return q}function $(P,C){C=C||6;for(var x=n(P).toHsv(),R=x.h,Z=x.s,q=x.v,ct=[],_t=1/C;C--;)ct.push(n({h:R,s:Z,v:q})),q=(q+_t)%1;return ct}n.mix=function(P,C,x){x=x===0?0:x||50;var R=n(P).toRgb(),Z=n(C).toRgb(),q=x/100,ct={r:(Z.r-R.r)*q+R.r,g:(Z.g-R.g)*q+R.g,b:(Z.b-R.b)*q+R.b,a:(Z.a-R.a)*q+R.a};return n(ct)},n.readability=function(P,C){var x=n(P),R=n(C);return(Math.max(x.getLuminance(),R.getLuminance())+.05)/(Math.min(x.getLuminance(),R.getLuminance())+.05)},n.isReadable=function(P,C,x){var R=n.readability(P,C),Z,q;switch(q=!1,Z=Mt(x),Z.level+Z.size){case"AAsmall":case"AAAlarge":q=R>=4.5;break;case"AAlarge":q=R>=3;break;case"AAAsmall":q=R>=7;break}return q},n.mostReadable=function(P,C,x){var R=null,Z=0,q,ct,_t,mt;x=x||{},ct=x.includeFallbackColors,_t=x.level,mt=x.size;for(var Wt=0;Wt<C.length;Wt++)q=n.readability(P,C[Wt]),q>Z&&(Z=q,R=n(C[Wt]));return n.isReadable(P,R,{level:_t,size:mt})||!ct?R:(x.includeFallbackColors=!1,n.mostReadable(P,["#fff","#000"],x))};var G=n.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},B=n.hexNames=ot(G);function ot(P){var C={};for(var x in P)P.hasOwnProperty(x)&&(C[P[x]]=x);return C}function ut(P){return P=parseFloat(P),(isNaN(P)||P<0||P>1)&&(P=1),P}function Q(P,C){kt(P)&&(P="100%");var x=tt(P);return P=Math.min(C,Math.max(0,parseFloat(P))),x&&(P=parseInt(P*C,10)/100),Math.abs(P-C)<1e-6?1:P%C/parseFloat(C)}function $t(P){return Math.min(1,Math.max(0,P))}function St(P){return parseInt(P,16)}function kt(P){return typeof P=="string"&&P.indexOf(".")!=-1&&parseFloat(P)===1}function tt(P){return typeof P=="string"&&P.indexOf("%")!=-1}function At(P){return P.length==1?"0"+P:""+P}function nt(P){return P<=1&&(P=P*100+"%"),P}function wt(P){return Math.round(parseFloat(P)*255).toString(16)}function te(P){return St(P)/255}var Dt=function(){var P="[-\\+]?\\d+%?",C="[-\\+]?\\d*\\.\\d+%?",x="(?:"+C+")|(?:"+P+")",R="[\\s|\\(]+("+x+")[,|\\s]+("+x+")[,|\\s]+("+x+")\\s*\\)?",Z="[\\s|\\(]+("+x+")[,|\\s]+("+x+")[,|\\s]+("+x+")[,|\\s]+("+x+")\\s*\\)?";return{CSS_UNIT:new RegExp(x),rgb:new RegExp("rgb"+R),rgba:new RegExp("rgba"+Z),hsl:new RegExp("hsl"+R),hsla:new RegExp("hsla"+Z),hsv:new RegExp("hsv"+R),hsva:new RegExp("hsva"+Z),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Ct(P){return!!Dt.CSS_UNIT.exec(P)}function Pt(P){P=P.replace(e,"").replace(t,"").toLowerCase();var C=!1;if(G[P])P=G[P],C=!0;else if(P=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var x;return(x=Dt.rgb.exec(P))?{r:x[1],g:x[2],b:x[3]}:(x=Dt.rgba.exec(P))?{r:x[1],g:x[2],b:x[3],a:x[4]}:(x=Dt.hsl.exec(P))?{h:x[1],s:x[2],l:x[3]}:(x=Dt.hsla.exec(P))?{h:x[1],s:x[2],l:x[3],a:x[4]}:(x=Dt.hsv.exec(P))?{h:x[1],s:x[2],v:x[3]}:(x=Dt.hsva.exec(P))?{h:x[1],s:x[2],v:x[3],a:x[4]}:(x=Dt.hex8.exec(P))?{r:St(x[1]),g:St(x[2]),b:St(x[3]),a:te(x[4]),format:C?"name":"hex8"}:(x=Dt.hex6.exec(P))?{r:St(x[1]),g:St(x[2]),b:St(x[3]),format:C?"name":"hex"}:(x=Dt.hex4.exec(P))?{r:St(x[1]+""+x[1]),g:St(x[2]+""+x[2]),b:St(x[3]+""+x[3]),a:te(x[4]+""+x[4]),format:C?"name":"hex8"}:(x=Dt.hex3.exec(P))?{r:St(x[1]+""+x[1]),g:St(x[2]+""+x[2]),b:St(x[3]+""+x[3]),format:C?"name":"hex"}:!1}function Mt(P){var C,x;return P=P||{level:"AA",size:"small"},C=(P.level||"AA").toUpperCase(),x=(P.size||"small").toLowerCase(),C!=="AA"&&C!=="AAA"&&(C="AA"),x!=="small"&&x!=="large"&&(x="small"),{level:C,size:x}}function Se(P,C){var x;return(x=P.parentNode)===null||x===void 0||x.insertBefore(C,P.nextSibling),P}function jt(P,C){return P.replaceWith(C),C.appendChild(P),P}function Ei(P){let C=window.getComputedStyle(P);return P.getBoundingClientRect().width+parseFloat(C.marginLeft)+parseFloat(C.marginRight)}function Kt(P,C=document){let x=C.createElement("div");return x.innerHTML=P,x.children[0]}function _e(P,C,x=void 0){let R;return function(){let Z=this,q=arguments,ct=function(){R=null,P.apply(Z,q)};x&&clearTimeout(R),(x||!R)&&(R=setTimeout(ct,C))}}function Pe(P,C){let x=C.split(" ").filter(R=>R!=="");return C!==""&&x.length&&P.classList.add(...x),P}function Ii(P,C){let x=C.split(" ").filter(R=>R!=="");return C!==""&&x.length&&P.classList.remove(...x),P}function Fe(P,C,x=void 0){return x!=null?P.classList.toggle(C,x):x===!0?Pe(P,C):Ii(P,C),P}function Ne(P,C,x={}){let R=new CustomEvent(C,{cancelable:!0,bubbles:!0,detail:x});return P.dispatchEvent(R),R}function Yi(P,C,x,R,Z={}){P.addEventListener(C,q=>{q.target.closest(x)&&(q.data=Object.assign({},q.data||{},Z),R(q))},Z)}function Be(P,C){let x,R,Z,q,ct=P.style.position,_t=P,mt={};ct==="static"&&(P.style.position="relative");let Wt=Ue(_t),Ft=P.style.top,Ht=P.style.left;if(q=(ct==="absolute"||ct==="fixed")&&(Ft+Ht).indexOf("auto")>-1,q?(x=Fs(_t),R=x.top,Z=x.left):(R=parseFloat(Ft)||0,Z=parseFloat(Ht)||0),C.top!=null&&(mt.top=C.top-Wt.top+R),C.left!=null&&(mt.left=C.left-Wt.left+Z),"using"in C)C.using.call(P,mt);else for(let ue in mt)_t.style.setProperty(ue,mt[ue]+"px")}function Ue(P){let C=P.getBoundingClientRect(),x=document.documentElement;return{top:C.top+window.pageYOffset-x.clientTop,left:C.left+window.pageXOffset-x.clientLeft}}function Fs(P){let{top:C,left:x}=P.getBoundingClientRect(),{marginTop:R,marginLeft:Z}=getComputedStyle(P);return{top:C-parseInt(R,10),left:x-parseInt(Z,10)}}let wn={beforeShow:xi,move:xi,change:xi,show:xi,hide:xi,color:"",type:"component",showInput:!1,allowEmpty:!0,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!0,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:"",appendTo:"body",maxSelectionSize:8,locale:"en",cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:"name",containerClassName:"",replacerClassName:"",showAlpha:!0,theme:"sp-light",palette:[["#000000","#444444","#5b5b5b","#999999","#bcbcbc","#eeeeee","#f3f6f4","#ffffff"],["#f44336","#744700","#ce7e00","#8fce00","#2986cc","#16537e","#6a329f","#c90076"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#990000","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#660000","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],selectionPalette:[],disabled:!1,offset:null},di=[],je=Kt(["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join("")),Ns=function(){return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>","</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<button class='sp-cancel' href='#'></button>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function ds(P,C,x,R){let Z=[];for(let q=0;q<P.length;q++){let ct=P[q];if(ct){let _t=n(ct),mt=_t.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";mt+=n.equals(C,ct)?" sp-thumb-active":"";let Wt=_t.toString(R.preferredFormat||"rgb"),Ft="background-color:"+_t.toRgbString();Z.push('<span title="'+Wt+'" data-color="'+_t.toRgbString()+'" class="'+mt+'"><span class="sp-thumb-inner" style="'+Ft+';"></span></span>')}else Z.push('<span class="sp-thumb-el sp-clear-display" ><span class="sp-clear-palette-only" style="background-color: transparent;"></span></span>')}return"<div class='sp-cf "+x+"'>"+Z.join("")+"</div>"}function _o(){for(let P=0;P<di.length;P++)di[P]&&di[P].hide()}function fs(P,C){if(P=Object.assign({},P),P.locale=P.locale||window.navigator.language,typeof P.locale=="string"){if(P.locale){let R=P.locale.split("-").map(Z=>Z.toLowerCase());R[0]===R[1]&&(R=[R[0]]),P.locale=R.join("-")}P.locale!=="en"&&Ae.localization[P.locale]&&(P=Object.assign({},P,Ae.localization[P.locale]))}else P=Object.assign({},P,P.locale);let x=Object.assign({},wn,C.dataset,P);return x.callbacks={move:Xi(x.move,C),change:Xi(x.change,C),show:Xi(x.show,C),hide:Xi(x.hide,C),beforeShow:Xi(x.beforeShow,C)},x}function ps(P,C){let x=fs(C,P),R=x.type,Z=R==="flat",q=x.showSelectionPalette,ct=x.localStorageKey,_t=x.theme,mt=x.callbacks,Wt=_e(Qi,10),Ft=!1,Ht=!1,ue=0,He=0,qe=0,qt=0,wi=0,fi=0,Un=0,ve=0,it=0,Oi=0,ii=1,Di=[],rn=[],Ri={},Ye=x.selectionPalette.slice(0),$i=x.maxSelectionSize,qn="sp-dragging",Sn=!1,Ee=null,ni=P.ownerDocument,dt=Kt(Ns,ni);dt.classList.add(_t),ni.body.appendChild(dt),ni.body;let yt=P,Pn=!1,Yn=dt.querySelector(".sp-picker-container"),Xn=dt.querySelector(".sp-color"),zi=dt.querySelector(".sp-dragger"),Ie=dt.querySelector(".sp-hue"),Mi=dt.querySelector(".sp-slider"),Fi=dt.querySelector(".sp-alpha-inner"),Xe=dt.querySelector(".sp-alpha"),Ge=dt.querySelector(".sp-alpha-handle"),Te=dt.querySelector(".sp-input"),si=dt.querySelector(".sp-palette"),Ki=dt.querySelector(".sp-initial"),Et=dt.querySelector(".sp-cancel"),Zt=dt.querySelector(".sp-clear"),Le=dt.querySelector(".sp-choose"),$e=dt.querySelector(".sp-palette-toggle"),pi=yt.nodeName==="INPUT",Tn=pi&&yt.getAttribute("type")==="color",gt=pi&&(R==="color"||Tn),Tt=gt?(()=>{let K=je.cloneNode(!0);return Pe(K,_t),Pe(K,x.replacerClassName),K})():null,be=gt?Tt:yt,ne=Tt?.querySelector(".sp-preview-inner"),oe=x.color||pi&&yt.value,ln="",oi=x.preferredFormat,Ni=!x.showButtons||x.clickoutFiresChange,Ut=!oe,Ke=x.allowEmpty,M,T,I,N,U=yt.getAttribute("id")||"";U!==void 0&&U.length>0&&document.querySelectorAll(`label[for="${U}"]`).forEach(rt=>{rt.addEventListener("click",function(zt){return zt.preventDefault(),Ln(),!1})});function J(){if(x.showPaletteOnly&&(x.showPalette=!0),$e&&($e.textContent=x.showPaletteOnly?x.togglePaletteMoreText:x.togglePaletteLessText),x.palette){Di=x.palette.slice(0),rn=Array.isArray(Di[0])?Di:[Di],Ri={};for(let K=0;K<rn.length;K++)for(let rt=0;rt<rn[K].length;rt++){let zt=n(rn[K][rt]).toRgbString();Ri[zt]=!0}x.showPaletteOnly&&!oe&&(oe=Di[0][0]===""?Di[0][0]:Object.keys(Ri)[0])}Fe(dt,"sp-flat",Z),Fe(dt,"sp-input-disabled",!x.showInput),Fe(dt,"sp-alpha-enabled",x.showAlpha),Fe(dt,"sp-clear-enabled",Ke),Fe(dt,"sp-buttons-disabled",!x.showButtons),Fe(dt,"sp-palette-buttons-disabled",!x.togglePaletteOnly),Fe(dt,"sp-palette-disabled",!x.showPalette),Fe(dt,"sp-palette-only",x.showPaletteOnly),Fe(dt,"sp-initial-disabled",!x.showInitial),Pe(dt,x.containerClassName),Qi()}function vt(K){Pn||Ln(),K.stopPropagation(),K.target.matches("input")||K.preventDefault()}function ae(){var K;J();let rt=window.getComputedStyle(yt);if(M=Kt('<span class="sp-original-input-container"></span>'),["margin"].forEach(lt=>{M.style,M.style.setProperty(lt,rt.getPropertyValue(lt))}),rt.display==="block"&&(M.style.display="flex"),yt.style.display="",gt)Se(yt,Tt),yt.style.display="none";else if(R==="text")Pe(M,"sp-colorize-container"),Pe(yt,"spectrum sp-colorize"),jt(yt,M);else if(R==="component"){Pe(yt,"spectrum"),jt(yt,M);let lt=Kt(["<div class='sp-colorize-container sp-add-on'>","<div class='sp-colorize'></div> ","</div>"].join(""));lt.style.width=yt.offsetHeight+"px",lt.style.borderRadius=rt.borderRadius,lt.style.border=rt.border,yt.classList.add("with-add-on"),yt.before(lt)}if(T=(K=yt.parentNode)===null||K===void 0?void 0:K.querySelector(".sp-colorize"),I=T?.style.color||"",N=T?.style.backgroundColor||"",Ke||(Zt.style.display="none"),Z)yt.after(dt),yt.style.display="none";else{let lt=x.appendTo==="parent"?yt.parentElement:x.appendTo;lt||(lt=document.body),typeof lt!="string"&&lt.append(dt)}re(),be?.addEventListener("click",vt),be?.addEventListener("touchstart",vt),(yt.matches(":disabled")||x.disabled)&&ha(),dt.addEventListener("click",lt=>lt.stopPropagation()),[Te,yt].forEach(function(lt){"value"in lt&&(lt.addEventListener("change",()=>{Yt(lt.value)}),lt.addEventListener("paste",()=>{setTimeout(()=>{Yt(lt.value)},1)}),lt.addEventListener("keydown",Ze=>{Ze.keyCode===13&&(Yt(lt.value),lt===yt&&Ve())}))}),Et.textContent=x.cancelText,Et.addEventListener("click",function(lt){lt.stopPropagation(),lt.preventDefault(),Vs(),Ve()}),Zt.setAttribute("title",x.clearText),Zt.addEventListener("click",function(lt){lt.stopPropagation(),lt.preventDefault(),Ut=!0,Ji(),Z&&Bi(!0)}),Le.textContent=x.chooseText,Le.addEventListener("click",lt=>{lt.stopPropagation(),lt.preventDefault(),Cn()&&(Bi(!0),Ve())}),$e.textContent=x.showPaletteOnly?x.togglePaletteMoreText:x.togglePaletteLessText,$e.addEventListener("click",lt=>{lt.stopPropagation(),lt.preventDefault(),x.showPaletteOnly=!x.showPaletteOnly,!x.showPaletteOnly&&!Z&&(dt.style.left="-="+(Ei(Yn)+5)),J()}),Gi(Xe,function(lt,Ze,ji){ii=lt/wi,Ut=!1,ji.shiftKey&&(ii=Math.round(ii*10)/10),Ji()},xt,mi),Gi(Ie,function(lt,Ze){ve=Ze/qt,Ut=!1,x.showAlpha||(ii=1),Ji()},xt,mi),Gi(Xn,function(lt,Ze,ji){if(!ji.shiftKey)Ee=null;else if(!Ee){let Hi=it*ue,Er=He-Oi*He;Ee=Math.abs(lt-Hi)>Math.abs(Ze-Er)?"x":"y"}let ri=!Ee||Ee==="x",Ar=!Ee||Ee==="y";ri&&(it=lt/ue),Ar&&(Oi=(He-Ze)/He),Ut=!1,x.showAlpha||(ii=1),Ji()},xt,mi),oe?(gi(oe),cn(),oi=n(oe).getFormat()||x.preferredFormat,le(oe)):(oe===""&&gi(oe),cn()),Z&&Ln();function zt(lt){var Ze,ji;if(lt.data&&lt.data.ignore){let ri=lt.target.closest(".sp-thumb-el");gi(((Ze=ri?.dataset)===null||Ze===void 0?void 0:Ze.color)||""),Ji()}else{let ri=lt.target.closest(".sp-thumb-el");gi(((ji=ri?.dataset)===null||ji===void 0?void 0:ji.color)||""),Ji(),x.hideAfterPaletteSelect?(Bi(!0),Ve()):Bi()}return!1}let Ce=["click","touchstart"];for(let lt of Ce)Yi(si,lt,".sp-thumb-el",zt),Yi(Ki,lt,".sp-thumb-el:nth-child(1)",zt,{ignore:!0})}function re(){if(ct){try{let K=window.localStorage,rt=K[ct].split(",#");if(rt.length>1){delete K[ct];for(let zt of rt)le(zt)}}catch{}try{Ye=window.localStorage[ct].split(";")}catch{}}}function le(K){if(q){let rt=n(K).toRgbString();if(!Ri[rt]&&!Ye.includes(rt))for(Ye.push(rt);Ye.length>$i;)Ye.shift();if(ct)try{window.localStorage[ct]=Ye.join(";")}catch{}}}function ai(){var K=[];if(x.showPalette)for(var rt=0;rt<Ye.length;rt++){var zt=n(Ye[rt]).toRgbString();Ri[zt]||K.push(Ye[rt])}return K.reverse().slice(0,x.maxSelectionSize)}function Bs(){let K=Xt(),rt=rn.map((zt,Ce)=>ds(zt,K,"sp-palette-row sp-palette-row-"+Ce,x));re(),Ye&&rt.push(ds(ai(),K,"sp-palette-row sp-palette-row-selection",x)),si.innerHTML=rt.join("")}function oa(){if(x.showInitial){let K=ln,rt=Xt();Ki.innerHTML=ds([K,rt],rt,"sp-palette-row-initial",x)}}function xt(){(He<=0||ue<=0||qt<=0)&&Qi(),Ht=!0,Pe(dt,qn),Ee=null,Ne(yt,"dragstart",{color:Xt()})}function mi(){Ht=!1,Ii(dt,qn),Ne(yt,"dragstop",{color:Xt()})}function Yt(K){if(Sn){Sn=!1;return}if((K===null||K==="")&&Ke)gi(""),Ji(),Bi();else{let rt=n(K);rt.isValid()?(gi(rt),Ji(),Bi()):Te.classList.add("sp-validation-error")}}function aa(){Ft?Ve():Ln()}function Ln(){if(Ft){Qi();return}let K=Ne(yt,"beforeShow",{color:Xt()});if(mt.beforeShow(K)===!1||K.defaultPrevented)return;_o(),Ft=!0,ni.addEventListener("keydown",js),ni.addEventListener("click",Hs),window.addEventListener("resize",Wt),Tt?.classList.add("sp-active"),dt.classList.remove("sp-hidden"),Qi(),cn(),ln=Xt(),oa();let rt=Ne(yt,"show",{color:ln});mt.show(rt)}function js(K){K.keyCode===27&&Ve()}function Hs(K){K.button!=2&&(Ht||(Ni?Bi(!0):Vs(),Ve()))}function Ve(){if(!Ft||Z)return;Ft=!1,ni.removeEventListener("keydown",js),ni.removeEventListener("click",Hs),window.removeEventListener("resize",Wt),Tt?.classList.remove("sp-active"),dt.classList.add("sp-hidden");let K=Ne(yt,"hide",{color:Xt()});mt.hide(K)}function Vs(){gi(ln,!0),Bi(!0)}function gi(K,rt=!1){if(n.equals(K,Xt())){cn();return}var zt,Ce;(!K||K===void 0)&&Ke?Ut=!0:(Ut=!1,zt=n(K),Ce=zt.toHsv(),ve=Ce.h%360/360,it=Ce.s,Oi=Ce.v,ii=Ce.a),cn(),zt&&zt.isValid()&&!rt&&(oi=x.preferredFormat||zt.getFormat())}function Xt(K={}){return Ke&&Ut?"":n.fromRatio({h:ve,s:it,v:Oi,a:Math.round(ii*1e3)/1e3},{format:K.format||oi})}function Cn(){return!Te.classList.contains("sp-validation-error")}function Ji(){cn();let K=Ne(yt,"move",{color:Xt()});mt.move(K)}function cn(){Te.classList.remove("sp-validation-error"),la();let K=n.fromRatio({h:ve,s:1,v:1});Xn.style.backgroundColor=K.toHexString();let rt=oi;ii<1&&!(ii===0&&rt==="name")&&(rt==="hex"||rt==="hex3"||rt==="hex6"||rt==="name")&&(rt="rgb");let zt=Xt({format:rt}),Ce="";if(ne&&(ne.classList.remove("sp-clear-display"),ne.style.backgroundColor="transparent"),zt==="")ne?.classList.add("sp-clear-display");else{let lt=zt.toHexString(),Ze=zt.toRgbString();if(ne&&(zt.getAlpha()===1?ne.style.backgroundColor=Ze:(ne.style.backgroundColor="transparent",ne.style.filter=zt.toFilter())),x.showAlpha){let ji=zt.toRgb();ji.a=0;let ri=n(ji).toRgbString();Fi.style.background=`linear-gradient(to right, ${ri}, ${lt})`}Ce=zt.toString(rt)}if(x.showInput&&(Te.value=Ce),yt.value=Ce,x.type=="text"||x.type=="component"){let lt=zt;if(lt&&T){let Ze=lt.isLight()||lt.getAlpha()<.4?"black":"white";T.style.backgroundColor=lt.toRgbString(),T.style.color=Ze}else T&&(T.style.backgroundColor=N,T.style.color=I)}x.showPalette&&Bs(),oa()}function la(){if(Ke&&Ut)Ge.style.display="none",Mi.style.display="none",zi.style.display="none";else{Ge.style.display="block",Mi.style.display="block",zi.style.display="block";let K=it*ue,rt=He-Oi*He;K=Math.max(-qe,Math.min(ue-qe,K-qe)),rt=Math.max(-qe,Math.min(He-qe,rt-qe)),zi.style.top=rt+"px",zi.style.left=K+"px";let zt=ii*wi;Ge.style.left=zt-fi/2+"px";let Ce=ve*qt;Mi.style.top=Ce-Un+"px"}}function Bi(K=!1){let rt=Xt(),zt=!n.equals(rt,ln);if(rt&&(rt.toString(oi),le(rt)),K&&zt){Sn=!0;let Ce=Ne(yt,"change",{color:rt});mt.change(Ce)}}function Qi(){!Ft||(ue=Xn.getBoundingClientRect().width,He=Xn.getBoundingClientRect().height,qe=zi.getBoundingClientRect().height,Ie.getBoundingClientRect().width,qt=Ie.getBoundingClientRect().height,Un=Mi.getBoundingClientRect().height,wi=Xe.getBoundingClientRect().width,fi=Ge.getBoundingClientRect().width,Z||(dt.style.position="absolute",x.offset?Be(dt,x.offset):Be(dt,ms(dt,be))),la(),x.showPalette&&Bs(),Ne(yt,"reflow"))}function kr(){yt.style.display="",yt.classList.remove("spectrum","with-add-on","sp-colorize"),be.removeEventListener("click",vt),be.removeEventListener("touchstart",vt),dt.remove(),Tt?.remove(),T&&(T.style.backgroundColor=N,T.style.color=I);let K=yt.closest(".sp-original-input-container");K&&(K.after(yt),K.remove()),di[hn.id]=null}function ca(K=void 0,rt=void 0){if(K===void 0)return Object.assign({},x);if(rt===void 0)return x[K];x[K]=rt,K==="preferredFormat"&&(oi=x.preferredFormat),J()}function Rt(){Pn=!1,yt.disabled=!1,be.classList.remove("sp-disabled")}function ha(){Ve(),Pn=!0,yt.disabled=!0,be.classList.add("sp-disabled")}function Si(K){x.offset=K,Qi()}ae();let hn={id:0,show:Ln,hide:Ve,toggle:aa,reflow:Qi,option:ca,enable:Rt,disable:ha,offset:Si,set:function(K){gi(K),Bi()},get:Xt,destroy:kr,container:dt};return hn.id=di.push(hn)-1,hn}function ms(P,C){let R=P.offsetWidth,Z=P.offsetHeight,q=C.offsetHeight,_t=P.ownerDocument.documentElement,mt=_t.clientWidth+window.pageXOffset,Wt=_t.clientHeight+window.pageYOffset,Ft=Ue(C),Ht=Ft.left,ue=Ft.top;return ue+=q,Ht-=Math.min(Ht,Ht+R>mt&&mt>R?Math.abs(Ht+R-mt):0),ue-=Math.min(ue,ue+Z>Wt&&Wt>Z?Math.abs(Z+q-0):0),{top:ue,left:Ht}}function xi(){}function Xi(P,C){let x=Array.prototype.slice,R=x.call(arguments,2);return function(){return P.apply(C,R.concat(x.call(arguments)))}}function Gi(P,C,x,R){C=C||xi,x=x||xi,R=R||xi;let Z=document,q=!1,ct={},_t=0,mt=0,Wt="ontouchstart"in window,Ft={};Ft.selectstart=Ht,Ft.dragstart=Ht,Ft.touchmove=ue,Ft.mousemove=ue,Ft.touchend=qe,Ft.mouseup=qe;function Ht(qt){qt.stopPropagation&&qt.stopPropagation(),qt.preventDefault&&qt.preventDefault(),qt.returnValue=!1}function ue(qt){if(q){let wi="touches"in qt&&qt.touches[0],fi=wi&&wi.pageX||qt.pageX,Un=wi&&wi.pageY||qt.pageY,ve=Math.max(0,Math.min(fi-ct.left,mt)),it=Math.max(0,Math.min(Un-ct.top,_t));Wt&&Ht(qt),C.apply(P,[ve,it,qt])}}function He(qt){if(!(qt.which?qt.which==3:qt.button===2)&&!q&&x.apply(P,arguments)!==!1){q=!0,_t=P.getBoundingClientRect().height,mt=P.getBoundingClientRect().width,ct=Ue(P);for(let fi in Ft)Z.addEventListener(fi,Ft[fi]);Z.body.classList.add("sp-dragging"),ue(qt),Ht(qt)}}function qe(){if(q){for(let qt in Ft)Z.removeEventListener(qt,Ft[qt]);Z.body.classList.remove("sp-dragging"),setTimeout(function(){R.apply(P,arguments)},0)}q=!1}P.addEventListener("touchstart",He),P.addEventListener("mousedown",He)}class Ae{static create(C,x={}){let R=this.wrap(C);if(!R){let Z="Unable to find element";throw typeof C=="string"&&(Z+=" - Selector: "+C),Error(Z)}return new this(R,x)}static createIfExists(C,x={}){let R=this.wrap(C);return R?new this(R,x):null}static getInstance(C,x={}){let R=this.wrap(C);return R.__spectrum=R.__spectrum||this.createIfExists(R,x)}static hasInstance(C){return this.wrap(C).__spectrum!==void 0}static createMultiple(C,x={}){let R=[];return this.wrapList(C).forEach(Z=>{R.push(this.create(Z,x))}),R}static getInstanceMultiple(C,x={}){let R=[];return this.wrapList(C).forEach(Z=>{R.push(this.getInstance(Z,x))}),R}static wrap(C){return typeof C=="string"?document.querySelector(C):C.jquery?C[0]:C}static wrapList(C){return typeof C=="string"?Array.from(document.querySelectorAll(C)):C.jquery?C.toArray():Array.from(C)}static locale(C,x){return this.localization[C]=x,this}static registerJQuery(C){Wn(C)}constructor(C,x={}){this.eventListeners={},this.spectrum=ps(C,x),this.ele=C,this.options=x}get id(){return this.spectrum.id}get container(){return this.ele.__spectrum?this.spectrum.container:this.ele}show(){return this.spectrum.show(),this}hide(){return this.spectrum.hide(),this}toggle(){return this.spectrum.toggle(),this}reflow(){return this.spectrum.reflow(),this}option(C,x){return this.spectrum.option(C,x)}enable(){return this.spectrum.enable(),this}disable(){return this.spectrum.disable(),this}offset(C){return this.spectrum.offset(C),this}set(C,x=!1){return this.spectrum.set(C,x),this}get(){return this.spectrum.get()}destroy(){return this.destroyInnerObject(),delete this.ele.__spectrum,this}rebuild(C){return this.destroyInnerObject(),C&&(this.options=Object.assign({},this.options,C)),this.spectrum=ps(this.ele,this.options),this}destroyInnerObject(){this.spectrum.destroy(),this.off()}listeners(C){return this.eventListeners[C]||[]}on(C,x,R=void 0){return this.ele.addEventListener(C,x,R),this.eventListeners[C]=this.eventListeners[C]||[],this.eventListeners[C].push(x),()=>{this.off(C,x)}}once(C,x,R=void 0){let Z=this.on(C,q=>{x(q),Z()},R);return Z}off(C=void 0,x=void 0){if(!(C&&!this.eventListeners[C])){if(!C){this.eventListeners={};return}if(x)this.eventListeners[C]=this.eventListeners[C].filter(R=>R===x),this.ele.removeEventListener(C,x);else{for(let R of this.eventListeners[C])this.ele.removeEventListener(C,R);this.eventListeners[C]=[]}}}}Ae.defaultOptions=wn,Ae.draggable=Gi,Ae.localization={},Ae.palette=[];let Mn=window.jQuery;Mn&&Wn(Mn);function Wn(P){P.fn.spectrum=function(C=void 0,...x){if(typeof C=="string"){let R=this;return this.each(function(){let Z=this.__spectrum;if(Z){if(!Z[C])throw new Error("Spectrum: no such method: '"+C+"'");C==="get"?R=Z.get():C==="container"?R=P(Z.container):C==="option"?R=Z.option.apply(Z,x):C==="destroy"?Z.destroy():Z[C](...x)}}),R}return this.each(function(){let R=P.extend({},P(this).data(),C);if(P(this).is("input")?R.type=="flat"?R.type="flat":P(this).attr("type")=="color"?R.type="color":R.type=R.type||"component":R.type="color",Ae.hasInstance(this)){let Z=Ae.getInstance(this);Z.options=R,Z.rebuild()}else Ae.getInstance(this,R)})},P.fn.spectrum.load=!0,P.fn.spectrum.loadOpts={},P.fn.spectrum.draggable=Gi,P.fn.spectrum.defaults=wn,P.fn.spectrum.localization=Ae.localization,P.fn.spectrum.palette=[],P.fn.spectrum.processNativeColorInputs=function(){let C=P("input[type=color]");C.length&&C.spectrum({preferredFormat:"hex6"})}}return Ae})});var bd=Vr((xb,Pr)=>{(function(e,t,n,s){"use strict";var a=["","webkit","Moz","MS","ms","o"],r=t.createElement("div"),l="function",u=Math.round,f=Math.abs,m=Date.now;function _(M,T,I){return setTimeout(z(M,I),T)}function v(M,T,I){return Array.isArray(M)?(y(M,I[T],I),!0):!1}function y(M,T,I){var N;if(!!M)if(M.forEach)M.forEach(T,I);else if(M.length!==s)for(N=0;N<M.length;)T.call(I,M[N],N,M),N++;else for(N in M)M.hasOwnProperty(N)&&T.call(I,M[N],N,M)}function w(M,T,I){var N="DEPRECATED METHOD: "+T+`
`+I+` AT 
`;return function(){var U=new Error("get-stack-trace"),J=U&&U.stack?U.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",vt=e.console&&(e.console.warn||e.console.log);return vt&&vt.call(e.console,N,J),M.apply(this,arguments)}}var k;typeof Object.assign!="function"?k=function(T){if(T===s||T===null)throw new TypeError("Cannot convert undefined or null to object");for(var I=Object(T),N=1;N<arguments.length;N++){var U=arguments[N];if(U!==s&&U!==null)for(var J in U)U.hasOwnProperty(J)&&(I[J]=U[J])}return I}:k=Object.assign;var A=w(function(T,I,N){for(var U=Object.keys(I),J=0;J<U.length;)(!N||N&&T[U[J]]===s)&&(T[U[J]]=I[U[J]]),J++;return T},"extend","Use `assign`."),E=w(function(T,I){return A(T,I,!0)},"merge","Use `assign`.");function D(M,T,I){var N=T.prototype,U;U=M.prototype=Object.create(N),U.constructor=M,U._super=N,I&&k(U,I)}function z(M,T){return function(){return M.apply(T,arguments)}}function V(M,T){return typeof M==l?M.apply(T&&T[0]||s,T):M}function W(M,T){return M===s?T:M}function H(M,T,I){y(B(T),function(N){M.addEventListener(N,I,!1)})}function X(M,T,I){y(B(T),function(N){M.removeEventListener(N,I,!1)})}function $(M,T){for(;M;){if(M==T)return!0;M=M.parentNode}return!1}function G(M,T){return M.indexOf(T)>-1}function B(M){return M.trim().split(/\s+/g)}function ot(M,T,I){if(M.indexOf&&!I)return M.indexOf(T);for(var N=0;N<M.length;){if(I&&M[N][I]==T||!I&&M[N]===T)return N;N++}return-1}function ut(M){return Array.prototype.slice.call(M,0)}function Q(M,T,I){for(var N=[],U=[],J=0;J<M.length;){var vt=T?M[J][T]:M[J];ot(U,vt)<0&&N.push(M[J]),U[J]=vt,J++}return I&&(T?N=N.sort(function(re,le){return re[T]>le[T]}):N=N.sort()),N}function $t(M,T){for(var I,N,U=T[0].toUpperCase()+T.slice(1),J=0;J<a.length;){if(I=a[J],N=I?I+U:T,N in M)return N;J++}return s}var St=1;function kt(){return St++}function tt(M){var T=M.ownerDocument||M;return T.defaultView||T.parentWindow||e}var At=/mobile|tablet|ip(ad|hone|od)|android/i,nt="ontouchstart"in e,wt=$t(e,"PointerEvent")!==s,te=nt&&At.test(navigator.userAgent),Dt="touch",Ct="pen",Pt="mouse",Mt="kinect",Se=25,jt=1,Ei=2,Kt=4,_e=8,Pe=1,Ii=2,Fe=4,Ne=8,Yi=16,Be=Ii|Fe,Ue=Ne|Yi,Fs=Be|Ue,wn=["x","y"],di=["clientX","clientY"];function je(M,T){var I=this;this.manager=M,this.callback=T,this.element=M.element,this.target=M.options.inputTarget,this.domHandler=function(N){V(M.options.enable,[M])&&I.handler(N)},this.init()}je.prototype={handler:function(){},init:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(tt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&X(this.element,this.evEl,this.domHandler),this.evTarget&&X(this.target,this.evTarget,this.domHandler),this.evWin&&X(tt(this.element),this.evWin,this.domHandler)}};function Ns(M){var T,I=M.options.inputClass;return I?T=I:wt?T=Wt:te?T=fi:nt?T=Oi:T=Z,new T(M,ds)}function ds(M,T,I){var N=I.pointers.length,U=I.changedPointers.length,J=T&jt&&N-U===0,vt=T&(Kt|_e)&&N-U===0;I.isFirst=!!J,I.isFinal=!!vt,J&&(M.session={}),I.eventType=T,_o(M,I),M.emit("hammer.input",I),M.recognize(I),M.session.prevInput=I}function _o(M,T){var I=M.session,N=T.pointers,U=N.length;I.firstInput||(I.firstInput=ms(T)),U>1&&!I.firstMultiple?I.firstMultiple=ms(T):U===1&&(I.firstMultiple=!1);var J=I.firstInput,vt=I.firstMultiple,ae=vt?vt.center:J.center,re=T.center=xi(N);T.timeStamp=m(),T.deltaTime=T.timeStamp-J.timeStamp,T.angle=Mn(ae,re),T.distance=Ae(ae,re),fs(I,T),T.offsetDirection=Gi(T.deltaX,T.deltaY);var le=Xi(T.deltaTime,T.deltaX,T.deltaY);T.overallVelocityX=le.x,T.overallVelocityY=le.y,T.overallVelocity=f(le.x)>f(le.y)?le.x:le.y,T.scale=vt?P(vt.pointers,N):1,T.rotation=vt?Wn(vt.pointers,N):0,T.maxPointers=I.prevInput?T.pointers.length>I.prevInput.maxPointers?T.pointers.length:I.prevInput.maxPointers:T.pointers.length,ps(I,T);var ai=M.element;$(T.srcEvent.target,ai)&&(ai=T.srcEvent.target),T.target=ai}function fs(M,T){var I=T.center,N=M.offsetDelta||{},U=M.prevDelta||{},J=M.prevInput||{};(T.eventType===jt||J.eventType===Kt)&&(U=M.prevDelta={x:J.deltaX||0,y:J.deltaY||0},N=M.offsetDelta={x:I.x,y:I.y}),T.deltaX=U.x+(I.x-N.x),T.deltaY=U.y+(I.y-N.y)}function ps(M,T){var I=M.lastInterval||T,N=T.timeStamp-I.timeStamp,U,J,vt,ae;if(T.eventType!=_e&&(N>Se||I.velocity===s)){var re=T.deltaX-I.deltaX,le=T.deltaY-I.deltaY,ai=Xi(N,re,le);J=ai.x,vt=ai.y,U=f(ai.x)>f(ai.y)?ai.x:ai.y,ae=Gi(re,le),M.lastInterval=T}else U=I.velocity,J=I.velocityX,vt=I.velocityY,ae=I.direction;T.velocity=U,T.velocityX=J,T.velocityY=vt,T.direction=ae}function ms(M){for(var T=[],I=0;I<M.pointers.length;)T[I]={clientX:u(M.pointers[I].clientX),clientY:u(M.pointers[I].clientY)},I++;return{timeStamp:m(),pointers:T,center:xi(T),deltaX:M.deltaX,deltaY:M.deltaY}}function xi(M){var T=M.length;if(T===1)return{x:u(M[0].clientX),y:u(M[0].clientY)};for(var I=0,N=0,U=0;U<T;)I+=M[U].clientX,N+=M[U].clientY,U++;return{x:u(I/T),y:u(N/T)}}function Xi(M,T,I){return{x:T/M||0,y:I/M||0}}function Gi(M,T){return M===T?Pe:f(M)>=f(T)?M<0?Ii:Fe:T<0?Ne:Yi}function Ae(M,T,I){I||(I=wn);var N=T[I[0]]-M[I[0]],U=T[I[1]]-M[I[1]];return Math.sqrt(N*N+U*U)}function Mn(M,T,I){I||(I=wn);var N=T[I[0]]-M[I[0]],U=T[I[1]]-M[I[1]];return Math.atan2(U,N)*180/Math.PI}function Wn(M,T){return Mn(T[1],T[0],di)+Mn(M[1],M[0],di)}function P(M,T){return Ae(T[0],T[1],di)/Ae(M[0],M[1],di)}var C={mousedown:jt,mousemove:Ei,mouseup:Kt},x="mousedown",R="mousemove mouseup";function Z(){this.evEl=x,this.evWin=R,this.pressed=!1,je.apply(this,arguments)}D(Z,je,{handler:function(T){var I=C[T.type];I&jt&&T.button===0&&(this.pressed=!0),I&Ei&&T.which!==1&&(I=Kt),this.pressed&&(I&Kt&&(this.pressed=!1),this.callback(this.manager,I,{pointers:[T],changedPointers:[T],pointerType:Pt,srcEvent:T}))}});var q={pointerdown:jt,pointermove:Ei,pointerup:Kt,pointercancel:_e,pointerout:_e},ct={2:Dt,3:Ct,4:Pt,5:Mt},_t="pointerdown",mt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(_t="MSPointerDown",mt="MSPointerMove MSPointerUp MSPointerCancel");function Wt(){this.evEl=_t,this.evWin=mt,je.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}D(Wt,je,{handler:function(T){var I=this.store,N=!1,U=T.type.toLowerCase().replace("ms",""),J=q[U],vt=ct[T.pointerType]||T.pointerType,ae=vt==Dt,re=ot(I,T.pointerId,"pointerId");J&jt&&(T.button===0||ae)?re<0&&(I.push(T),re=I.length-1):J&(Kt|_e)&&(N=!0),!(re<0)&&(I[re]=T,this.callback(this.manager,J,{pointers:I,changedPointers:[T],pointerType:vt,srcEvent:T}),N&&I.splice(re,1))}});var Ft={touchstart:jt,touchmove:Ei,touchend:Kt,touchcancel:_e},Ht="touchstart",ue="touchstart touchmove touchend touchcancel";function He(){this.evTarget=Ht,this.evWin=ue,this.started=!1,je.apply(this,arguments)}D(He,je,{handler:function(T){var I=Ft[T.type];if(I===jt&&(this.started=!0),!!this.started){var N=qe.call(this,T,I);I&(Kt|_e)&&N[0].length-N[1].length===0&&(this.started=!1),this.callback(this.manager,I,{pointers:N[0],changedPointers:N[1],pointerType:Dt,srcEvent:T})}}});function qe(M,T){var I=ut(M.touches),N=ut(M.changedTouches);return T&(Kt|_e)&&(I=Q(I.concat(N),"identifier",!0)),[I,N]}var qt={touchstart:jt,touchmove:Ei,touchend:Kt,touchcancel:_e},wi="touchstart touchmove touchend touchcancel";function fi(){this.evTarget=wi,this.targetIds={},je.apply(this,arguments)}D(fi,je,{handler:function(T){var I=qt[T.type],N=Un.call(this,T,I);!N||this.callback(this.manager,I,{pointers:N[0],changedPointers:N[1],pointerType:Dt,srcEvent:T})}});function Un(M,T){var I=ut(M.touches),N=this.targetIds;if(T&(jt|Ei)&&I.length===1)return N[I[0].identifier]=!0,[I,I];var U,J,vt=ut(M.changedTouches),ae=[],re=this.target;if(J=I.filter(function(le){return $(le.target,re)}),T===jt)for(U=0;U<J.length;)N[J[U].identifier]=!0,U++;for(U=0;U<vt.length;)N[vt[U].identifier]&&ae.push(vt[U]),T&(Kt|_e)&&delete N[vt[U].identifier],U++;if(!!ae.length)return[Q(J.concat(ae),"identifier",!0),ae]}var ve=2500,it=25;function Oi(){je.apply(this,arguments);var M=z(this.handler,this);this.touch=new fi(this.manager,M),this.mouse=new Z(this.manager,M),this.primaryTouch=null,this.lastTouches=[]}D(Oi,je,{handler:function(T,I,N){var U=N.pointerType==Dt,J=N.pointerType==Pt;if(!(J&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(U)ii.call(this,I,N);else if(J&&rn.call(this,N))return;this.callback(T,I,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ii(M,T){M&jt?(this.primaryTouch=T.changedPointers[0].identifier,Di.call(this,T)):M&(Kt|_e)&&Di.call(this,T)}function Di(M){var T=M.changedPointers[0];if(T.identifier===this.primaryTouch){var I={x:T.clientX,y:T.clientY};this.lastTouches.push(I);var N=this.lastTouches,U=function(){var J=N.indexOf(I);J>-1&&N.splice(J,1)};setTimeout(U,ve)}}function rn(M){for(var T=M.srcEvent.clientX,I=M.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var U=this.lastTouches[N],J=Math.abs(T-U.x),vt=Math.abs(I-U.y);if(J<=it&&vt<=it)return!0}return!1}var Ri=$t(r.style,"touchAction"),Ye=Ri!==s,$i="compute",qn="auto",Sn="manipulation",Ee="none",ni="pan-x",dt="pan-y",yt=Xn();function Pn(M,T){this.manager=M,this.set(T)}Pn.prototype={set:function(M){M==$i&&(M=this.compute()),Ye&&this.manager.element.style&&yt[M]&&(this.manager.element.style[Ri]=M),this.actions=M.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var M=[];return y(this.manager.recognizers,function(T){V(T.options.enable,[T])&&(M=M.concat(T.getTouchAction()))}),Yn(M.join(" "))},preventDefaults:function(M){var T=M.srcEvent,I=M.offsetDirection;if(this.manager.session.prevented){T.preventDefault();return}var N=this.actions,U=G(N,Ee)&&!yt[Ee],J=G(N,dt)&&!yt[dt],vt=G(N,ni)&&!yt[ni];if(U){var ae=M.pointers.length===1,re=M.distance<2,le=M.deltaTime<250;if(ae&&re&&le)return}if(!(vt&&J)&&(U||J&&I&Be||vt&&I&Ue))return this.preventSrc(T)},preventSrc:function(M){this.manager.session.prevented=!0,M.preventDefault()}};function Yn(M){if(G(M,Ee))return Ee;var T=G(M,ni),I=G(M,dt);return T&&I?Ee:T||I?T?ni:dt:G(M,Sn)?Sn:qn}function Xn(){if(!Ye)return!1;var M={},T=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(I){M[I]=T?e.CSS.supports("touch-action",I):!0}),M}var zi=1,Ie=2,Mi=4,Fi=8,Xe=Fi,Ge=16,Te=32;function si(M){this.options=k({},this.defaults,M||{}),this.id=kt(),this.manager=null,this.options.enable=W(this.options.enable,!0),this.state=zi,this.simultaneous={},this.requireFail=[]}si.prototype={defaults:{},set:function(M){return k(this.options,M),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(M){if(v(M,"recognizeWith",this))return this;var T=this.simultaneous;return M=Zt(M,this),T[M.id]||(T[M.id]=M,M.recognizeWith(this)),this},dropRecognizeWith:function(M){return v(M,"dropRecognizeWith",this)?this:(M=Zt(M,this),delete this.simultaneous[M.id],this)},requireFailure:function(M){if(v(M,"requireFailure",this))return this;var T=this.requireFail;return M=Zt(M,this),ot(T,M)===-1&&(T.push(M),M.requireFailure(this)),this},dropRequireFailure:function(M){if(v(M,"dropRequireFailure",this))return this;M=Zt(M,this);var T=ot(this.requireFail,M);return T>-1&&this.requireFail.splice(T,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(M){return!!this.simultaneous[M.id]},emit:function(M){var T=this,I=this.state;function N(U){T.manager.emit(U,M)}I<Fi&&N(T.options.event+Ki(I)),N(T.options.event),M.additionalEvent&&N(M.additionalEvent),I>=Fi&&N(T.options.event+Ki(I))},tryEmit:function(M){if(this.canEmit())return this.emit(M);this.state=Te},canEmit:function(){for(var M=0;M<this.requireFail.length;){if(!(this.requireFail[M].state&(Te|zi)))return!1;M++}return!0},recognize:function(M){var T=k({},M);if(!V(this.options.enable,[this,T])){this.reset(),this.state=Te;return}this.state&(Xe|Ge|Te)&&(this.state=zi),this.state=this.process(T),this.state&(Ie|Mi|Fi|Ge)&&this.tryEmit(T)},process:function(M){},getTouchAction:function(){},reset:function(){}};function Ki(M){return M&Ge?"cancel":M&Fi?"end":M&Mi?"move":M&Ie?"start":""}function Et(M){return M==Yi?"down":M==Ne?"up":M==Ii?"left":M==Fe?"right":""}function Zt(M,T){var I=T.manager;return I?I.get(M):M}function Le(){si.apply(this,arguments)}D(Le,si,{defaults:{pointers:1},attrTest:function(M){var T=this.options.pointers;return T===0||M.pointers.length===T},process:function(M){var T=this.state,I=M.eventType,N=T&(Ie|Mi),U=this.attrTest(M);return N&&(I&_e||!U)?T|Ge:N||U?I&Kt?T|Fi:T&Ie?T|Mi:Ie:Te}});function $e(){Le.apply(this,arguments),this.pX=null,this.pY=null}D($e,Le,{defaults:{event:"pan",threshold:10,pointers:1,direction:Fs},getTouchAction:function(){var M=this.options.direction,T=[];return M&Be&&T.push(dt),M&Ue&&T.push(ni),T},directionTest:function(M){var T=this.options,I=!0,N=M.distance,U=M.direction,J=M.deltaX,vt=M.deltaY;return U&T.direction||(T.direction&Be?(U=J===0?Pe:J<0?Ii:Fe,I=J!=this.pX,N=Math.abs(M.deltaX)):(U=vt===0?Pe:vt<0?Ne:Yi,I=vt!=this.pY,N=Math.abs(M.deltaY))),M.direction=U,I&&N>T.threshold&&U&T.direction},attrTest:function(M){return Le.prototype.attrTest.call(this,M)&&(this.state&Ie||!(this.state&Ie)&&this.directionTest(M))},emit:function(M){this.pX=M.deltaX,this.pY=M.deltaY;var T=Et(M.direction);T&&(M.additionalEvent=this.options.event+T),this._super.emit.call(this,M)}});function pi(){Le.apply(this,arguments)}D(pi,Le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.scale-1)>this.options.threshold||this.state&Ie)},emit:function(M){if(M.scale!==1){var T=M.scale<1?"in":"out";M.additionalEvent=this.options.event+T}this._super.emit.call(this,M)}});function Tn(){si.apply(this,arguments),this._timer=null,this._input=null}D(Tn,si,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[qn]},process:function(M){var T=this.options,I=M.pointers.length===T.pointers,N=M.distance<T.threshold,U=M.deltaTime>T.time;if(this._input=M,!N||!I||M.eventType&(Kt|_e)&&!U)this.reset();else if(M.eventType&jt)this.reset(),this._timer=_(function(){this.state=Xe,this.tryEmit()},T.time,this);else if(M.eventType&Kt)return Xe;return Te},reset:function(){clearTimeout(this._timer)},emit:function(M){this.state===Xe&&(M&&M.eventType&Kt?this.manager.emit(this.options.event+"up",M):(this._input.timeStamp=m(),this.manager.emit(this.options.event,this._input)))}});function gt(){Le.apply(this,arguments)}D(gt,Le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.rotation)>this.options.threshold||this.state&Ie)}});function Tt(){Le.apply(this,arguments)}D(Tt,Le,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Be|Ue,pointers:1},getTouchAction:function(){return $e.prototype.getTouchAction.call(this)},attrTest:function(M){var T=this.options.direction,I;return T&(Be|Ue)?I=M.overallVelocity:T&Be?I=M.overallVelocityX:T&Ue&&(I=M.overallVelocityY),this._super.attrTest.call(this,M)&&T&M.offsetDirection&&M.distance>this.options.threshold&&M.maxPointers==this.options.pointers&&f(I)>this.options.velocity&&M.eventType&Kt},emit:function(M){var T=Et(M.offsetDirection);T&&this.manager.emit(this.options.event+T,M),this.manager.emit(this.options.event,M)}});function be(){si.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}D(be,si,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Sn]},process:function(M){var T=this.options,I=M.pointers.length===T.pointers,N=M.distance<T.threshold,U=M.deltaTime<T.time;if(this.reset(),M.eventType&jt&&this.count===0)return this.failTimeout();if(N&&U&&I){if(M.eventType!=Kt)return this.failTimeout();var J=this.pTime?M.timeStamp-this.pTime<T.interval:!0,vt=!this.pCenter||Ae(this.pCenter,M.center)<T.posThreshold;this.pTime=M.timeStamp,this.pCenter=M.center,!vt||!J?this.count=1:this.count+=1,this._input=M;var ae=this.count%T.taps;if(ae===0)return this.hasRequireFailures()?(this._timer=_(function(){this.state=Xe,this.tryEmit()},T.interval,this),Ie):Xe}return Te},failTimeout:function(){return this._timer=_(function(){this.state=Te},this.options.interval,this),Te},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Xe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ne(M,T){return T=T||{},T.recognizers=W(T.recognizers,ne.defaults.preset),new oi(M,T)}ne.VERSION="2.0.7",ne.defaults={domEvents:!1,touchAction:$i,enable:!0,inputTarget:null,inputClass:null,preset:[[gt,{enable:!1}],[pi,{enable:!1},["rotate"]],[Tt,{direction:Be}],[$e,{direction:Be},["swipe"]],[be],[be,{event:"doubletap",taps:2},["tap"]],[Tn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var oe=1,ln=2;function oi(M,T){this.options=k({},ne.defaults,T||{}),this.options.inputTarget=this.options.inputTarget||M,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=M,this.input=Ns(this),this.touchAction=new Pn(this,this.options.touchAction),Ni(this,!0),y(this.options.recognizers,function(I){var N=this.add(new I[0](I[1]));I[2]&&N.recognizeWith(I[2]),I[3]&&N.requireFailure(I[3])},this)}oi.prototype={set:function(M){return k(this.options,M),M.touchAction&&this.touchAction.update(),M.inputTarget&&(this.input.destroy(),this.input.target=M.inputTarget,this.input.init()),this},stop:function(M){this.session.stopped=M?ln:oe},recognize:function(M){var T=this.session;if(!T.stopped){this.touchAction.preventDefaults(M);var I,N=this.recognizers,U=T.curRecognizer;(!U||U&&U.state&Xe)&&(U=T.curRecognizer=null);for(var J=0;J<N.length;)I=N[J],T.stopped!==ln&&(!U||I==U||I.canRecognizeWith(U))?I.recognize(M):I.reset(),!U&&I.state&(Ie|Mi|Fi)&&(U=T.curRecognizer=I),J++}},get:function(M){if(M instanceof si)return M;for(var T=this.recognizers,I=0;I<T.length;I++)if(T[I].options.event==M)return T[I];return null},add:function(M){if(v(M,"add",this))return this;var T=this.get(M.options.event);return T&&this.remove(T),this.recognizers.push(M),M.manager=this,this.touchAction.update(),M},remove:function(M){if(v(M,"remove",this))return this;if(M=this.get(M),M){var T=this.recognizers,I=ot(T,M);I!==-1&&(T.splice(I,1),this.touchAction.update())}return this},on:function(M,T){if(M!==s&&T!==s){var I=this.handlers;return y(B(M),function(N){I[N]=I[N]||[],I[N].push(T)}),this}},off:function(M,T){if(M!==s){var I=this.handlers;return y(B(M),function(N){T?I[N]&&I[N].splice(ot(I[N],T),1):delete I[N]}),this}},emit:function(M,T){this.options.domEvents&&Ut(M,T);var I=this.handlers[M]&&this.handlers[M].slice();if(!(!I||!I.length)){T.type=M,T.preventDefault=function(){T.srcEvent.preventDefault()};for(var N=0;N<I.length;)I[N](T),N++}},destroy:function(){this.element&&Ni(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ni(M,T){var I=M.element;if(!!I.style){var N;y(M.options.cssProps,function(U,J){N=$t(I.style,J),T?(M.oldCssProps[N]=I.style[N],I.style[N]=U):I.style[N]=M.oldCssProps[N]||""}),T||(M.oldCssProps={})}}function Ut(M,T){var I=t.createEvent("Event");I.initEvent(M,!0,!0),I.gesture=T,T.target.dispatchEvent(I)}k(ne,{INPUT_START:jt,INPUT_MOVE:Ei,INPUT_END:Kt,INPUT_CANCEL:_e,STATE_POSSIBLE:zi,STATE_BEGAN:Ie,STATE_CHANGED:Mi,STATE_ENDED:Fi,STATE_RECOGNIZED:Xe,STATE_CANCELLED:Ge,STATE_FAILED:Te,DIRECTION_NONE:Pe,DIRECTION_LEFT:Ii,DIRECTION_RIGHT:Fe,DIRECTION_UP:Ne,DIRECTION_DOWN:Yi,DIRECTION_HORIZONTAL:Be,DIRECTION_VERTICAL:Ue,DIRECTION_ALL:Fs,Manager:oi,Input:je,TouchAction:Pn,TouchInput:fi,MouseInput:Z,PointerEventInput:Wt,TouchMouseInput:Oi,SingleTouchInput:He,Recognizer:si,AttrRecognizer:Le,Tap:be,Pan:$e,Swipe:Tt,Pinch:pi,Rotate:gt,Press:Tn,on:H,off:X,each:y,merge:E,extend:A,assign:k,inherit:D,bindFn:z,prefixed:$t});var Ke=typeof e<"u"?e:typeof self<"u"?self:{};Ke.Hammer=ne,typeof define=="function"&&define.amd?define(function(){return ne}):typeof Pr<"u"&&Pr.exports?Pr.exports=ne:e[n]=ne})(window,document,"Hammer")});var wc={};Kn(wc,{catalog:()=>Kr,control:()=>fc,crs:()=>yc,layer:()=>xc,util:()=>Qr,vector:()=>Zr});var Kr={};Kn(Kr,{Catalog:()=>We,catalogs:()=>$r});var On=Bt(Vt()),We=On.Class.extend({options:{name:"A catalog",attribution:"",color:"yellow",properties:["mag"],propertyMask:void 0,units:[""],magLim:20,magIndex:0,magScaleType:"mag",regionType:"box",service:"Vizier@CDS",className:"logo-catalog-vizier",serviceURL:"https://vizier.unistra.fr/viz-bin",catalogURL:"/",objectURL:"/",authenticate:"false",nmax:1e4,format:"text",draw:void 0},initialize:function(e){On.Util.setOptions(this,e);for(var t in this.options)this.options[t]!==void 0&&(this[t]=this.options[t]);this.url=this.serviceURL+this.catalogURL,this.objectURL&&(this.objURL=this.objectURL.startsWith("http")?this.objectURL:this.serviceURL+this.objectURL)},_csvToGeoJSON:function(e){let t=new RegExp("#|--|objName|string|^$"),n=e.split(`
`),s={type:"FeatureCollection",features:[]};for(var a in n){var r=n[a];if(t.test(r)===!1){var l={type:"Feature",id:"",properties:{items:[]},geometry:{type:"Point",coordinates:[0,0]}},u=l.geometry,f=l.properties;let _=r.split(/[,;\t]/);l.id=_[0],u.coordinates[0]=parseFloat(_[1]),u.coordinates[1]=parseFloat(_[2]);let v=_.slice(3);for(var m in v)f.items.push(this.readProperty(v[m]));s.features.push(l)}}return s},readProperty:function(e){let t=parseFloat(e);return isNaN(t)?"--":t},toGeoJSON:function(e){return this._csvToGeoJSON(e)},popup:function(e){var t="<div>";this.objURL?t+='ID: <a href="'+On.Util.template(this.objURL,(0,On.extend)({id:e.id,ra:e.geometry.coordinates[0].toFixed(6),dec:e.geometry.coordinates[1].toFixed(6)}))+'" target="_blank">'+e.id+"</a></div>":t+="ID: "+e.id+"</div>",t+='<TABLE style="margin:auto;"><TBODY style="vertical-align:top;text-align:left;">';var n=e.properties.items;for(var s in this.properties)(this.propertyMask===void 0||this.propertyMask[s]===!0)&&(t+="<TR><TD>"+this.properties[s]+":</TD><TD>"+(typeof n[s]=="number"?n[s].toPrecision(4):n[s].toString())+" ",this.units[s]&&(t+=this.units[s]),t+="</TD></TR>");return t+="</TBODY></TABLE>",t},draw:function(e,t){var n=e.properties.items[this.magIndex];return(0,On.circleMarker)(t,{radius:n?5+(this.magScaleType==="mag"?this.magLim-n:2.5*(this.magScaleType==="log"?n-this.magLim:Math.log(n/this.magLim+1))):8})},style:function(e){return{color:this.color,weight:2}},filter:function(e){return!0}});var $r={};Kn($r,{abell:()=>jf,allWISE:()=>Hf,first:()=>Vf,gaiaDR3:()=>Wr,galexAIS:()=>Zf,gleam:()=>Wf,nvss:()=>Uf,panstarrs1:()=>Ur,ppmXL:()=>qf,sdss:()=>qr,skybot:()=>Gr,tgss:()=>Yf,twomass:()=>Yr,unWISE:()=>Xr,urat1:()=>Xf});var ih=Bt(Vt());var Zr={};Kn(Zr,{Ellipse:()=>eh,EllipseMarker:()=>Pa,ellipse:()=>Gs,ellipseMarker:()=>Bf});var Jn=Bt(Vt());var Pi=Bt(Vt()),Pa=Pi.Path.extend({CANVAS:!0,SVG:!1,options:{majAxis:10,minAxis:10,posAngle:0,fill:!0},initialize:function(e,t){Pi.Util.setOptions(this,t),this._majAxis=this.options.majAxis,this._minAxis=this.options.majAxis,this._posAngle=this.options.posAngle,this._latlng=(0,Pi.latLng)(e);let n=Math.PI/180,s=Math.cos(this._posAngle*n),a=Math.sin(this._posAngle*n),r=s*s,l=a*a,u=this._majAxis*this._majAxis,f=this._minAxis*this._minAxis,m=u*r+f*l,_=u*l+f*r,v=(u-f)*s*a,y=m*_-v*v;this._limX=Math.sqrt(m),this._limY=Math.sqrt(_),y<=0&&(m+=1,_+=1,y=m*_-v*v),this._cXX=_/y,this._cYY=m/y,this._cXY=-2*v/y},setLatLng:function(e){return this._latlng=(0,Pi.latLng)(e),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setParams:function(e){return this.options.majAxis=this._majAxis=e.majAxis,this.options.minAxis=this._minAxis=e.minAxis,this.options.posAngle=this._posAngle=e.posAngle,this.redraw()},getParams:function(){return{majAxis:this._majAxis,minAxis:this._minAxis,posAngle:this._posAngle}},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){let e=this._clickTolerance(),t=[this._limX+e,this._limY+e];this._pxBounds=new Pi.Bounds(this._point.subtract(t),this._point.add(t))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateEllipse(this)},_empty:function(){return this._majAxis&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){let t=e.subtract(this._point),n=this._clickTolerance(),s=Math.abs(t.x)-n,a=Math.abs(t.y)-n;return this._cXX*(s>0?s*s:0)+this._cYY*(a>0?a*a:0)+this._cXY*(t.x*t.y)<=1}}),Bf=function(e,t){return new Pa(e,t)};Pi.Canvas.include({_updateEllipse:function(e){if(!e._empty()){var t=e._point,n=this._ctx,s=e._minAxis,a=e._majAxis/e._minAxis;n.save(),n.translate(t.x,t.y),n.rotate(e._posAngle*Math.PI/180),n.scale(1,a),n.beginPath(),n.arc(0,0,s,0,Math.PI*2,!1),n.restore(),this._fillStroke(n,e)}}});Pi.SVG.include({_updateEllipse:function(e){let t=Math.PI/180,n=e._point,s=e._minAxis,a=e._majAxis,r=s*Math.cos(e._posAngle*t),l=s*Math.sin(e._posAngle*t),u="a"+s+","+a+" "+e._posAngle+" 1,0 ",f=e._empty()?"M0 0":"M"+(n.x-r)+","+(n.y-l)+u+r*2+","+l*2+" "+u+-r*2+","+-l*2+" ";this._setPath(e,f)}});var eh=Pa.extend({options:{fill:!0},initialize:function(e,t){Jn.Util.setOptions(this,t);let n=Math.PI/180,s=Math.cos(this.options.posAngle*n),a=Math.sin(this.options.posAngle*n),r=s*s,l=a*a,u=this.options.majAxis*this.options.majAxis,f=this.options.minAxis*this.options.minAxis;this._latlng=(0,Jn.latLng)(e),this._mLat2=u*r+f*l,this._mLng2=u*l+f*r,this._mLatLng=(u-f)*s*a},getBounds:function(){let e=[this._limX,this._limY];return new Jn.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},_project:function(){let e=this._map,t=e.options.crs;if(this._point=e.latLngToLayerPoint(this._latlng),!this._majAxis1){let a=this._latlng.lng,r=this._latlng.lat,l=Math.PI/180,u=Math.cos(r*l),f=r<90?.001:-.001,m=t.project(this._latlng),_=t.project((0,Jn.latLng)(r+f,a)).subtract(m),v=t.project((0,Jn.latLng)(r,a+f*1/(u>f?u:f))).subtract(m),y=_.x/f,w=v.x/f,k=_.y/f,A=v.y/f,E=y*y*this._mLat2+w*w*this._mLng2+2*y*w*this._mLatLng,D=k*k*this._mLat2+A*A*this._mLng2+2*k*A*this._mLatLng,z=y*k*this._mLat2+w*A*this._mLng2+(y*A+w*k)*this._mLatLng,V=.5*(E+D),W=Math.sqrt(.25*(E-D)*(E-D)+z*z),H=E*D-z*z;this._majAxis=this._majAxis1=Math.sqrt(V+W),this._minAxis=this._minAxis1=V>W?Math.sqrt(V-W):0,this._posAngle=.5*Math.atan2(2*z,E-D)/l,this._limX=this._limX1=Math.sqrt(E),this._limY=this._limY1=Math.sqrt(D),H<=0&&(E+=1,D+=1,H=E*D-z*z),this._cXX1=D/H,this._cYY1=E/H,this._cXY1=-2*z/H}let n=t.scale(e._zoom),s=1/(n*n);this._majAxis=this._majAxis1*n,this._minAxis=this._minAxis1*n,this._limX=this._limX1*n,this._limY=this._limY1*n,this._cXX=this._cXX1*s,this._cYY=this._cYY1*s,this._cXY=this._cXY1*s,this._updateBounds()}}),Gs=function(e,t){return new eh(e,t)};var jf=new We({service:"Vizier@CDS",name:"Abell clusters",className:"logo-catalog-vizier",attribution:"Rich Clusters of Galaxies (Abell et al. 1989) ",color:"orange",magLim:30,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=VII/110A&-out=ACO,_RAJ2000,_DEJ2000,m10,Rich,Dclass&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=m10",properties:["m<sub>10</sub>","Richness","D<sub>class</sub>"],units:["","",""],objectURL:"/VizieR-5?-source=VII/110A&-c={ra},{dec},eq=J2000&-c.rs=0.2"}),Hf=new We({service:"Vizier@CDS",name:"AllWISE",attribution:"AllWISE Data Release (Cutri et al. 2013)",color:"red",magLim:18,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=II/328/allwise&-out=AllWISE,_RAJ2000,_DEJ2000,W1mag,W2mag,W3mag,W4mag&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=W1mag",properties:["W1<sub>mag</sub> (3.4\xB5m)","W2<sub>mag</sub> (4.6\xB5m)","W3<sub>mag</sub> (12\xB5m)","W4<sub>mag</sub> (22\xB5m)"],units:["","","",""],objectURL:"/VizieR-5?-source=II/328/allwise&-c={ra},{dec},eq=J2000&-c.rs=0.2"}),Vf=new We({service:"Vizier@CDS",name:"FIRST",className:"logo-catalog-vizier",attribution:"The FIRST Survey Catalog (Helfand et al. 2015)",color:"blue",magLim:30,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=VIII/92/first14&-out=FIRST,_RAJ2000,_DEJ2000,Fpeak,fMaj,fMin,fPA&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=-Fpeak",properties:["F<sub>peak</sub>(1.4GHz)","Major axis FWHM","Minor axis FWHM","Position angle"],units:["mJy","&#8243;","&#8243;","&#176;"],objectURL:"/VizieR-5?-source=VIII/92/first14&-c={ra},{dec},eq=J2000&-c.rs=0.2",draw:function(e,t){return Gs(t,{majAxis:e.properties.items[1]/7200,minAxis:e.properties.items[2]/7200,posAngle:e.properties.items[3]==="--"?0:e.properties.items[3]})}}),Wr=new We({service:"Vizier@CDS",name:"Gaia DR3",className:"logo-catalog-vizier",attribution:"Third Gaia Data Release (2022)",color:"green",magLim:21,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=I/355/gaiadr3&-out=Source,RA_ICRS,DE_ICRS,Gmag,BPmag,RPmag,pmRA,pmDE&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=Gmag",properties:["G","B<sub>P</sub>","R<sub>P</sub>","&#956;<sub>&#593;</sub> cos &#948;","&#956;<sub>&#948;</sub>"],units:["","","","mas/yr","mas/yr"],objectURL:"/VizieR-5?-source=I/355/gaiadr3&-c={ra},{dec},eq=J2000&-c.rs=0.1"}),Zf=new We({service:"Vizier@CDS",name:"GALEX AIS",className:"logo-catalog-vizier",attribution:"GALEX catalogs of UV sources: All-sky Imaging Survey (Bianchi et al. 2011)",color:"magenta",magLim:21,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=II/312/ais&-out=objid,_RAJ2000,_DEJ2000,FUV,NUV&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=FUV",properties:["FUV<sub>AB</sub>","NUV<sub>AB</sub>"],units:["",""],objectURL:"/VizieR-5?-source=II/312/ais&-c={ra},{dec},eq=J2000&-c.rs=0.2"}),Wf=new We({service:"Vizier@CDS",name:"GLEAM",className:"logo-catalog-vizier",attribution:"GaLactic and Extragalactic All-sky Murchison Wide Field Array (GLEAM) low-frequency extragalactic catalogue (Hurley-Walker et al. 2017)",color:"blue",magLim:30,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=VIII/100/gleamegc&-out=GLEAM,RAJ2000,DEJ2000,Fintwide,awide,bwide,pawide&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=-Fintwide",properties:["F<sub>int</sub>(170-231MHz)","Major axis FWHM","Minor axis FWHM","Position angle"],units:["Jy","&#8243;","&#8243;","&#176;"],objectURL:"/VizieR-5?-source=-source=VIII/100/gleamegc&-c={ra},{dec},eq=J2000&-c.rs=0.2",draw:function(e,t){return Gs(t,{majAxis:e.properties.items[1]/3600,minAxis:e.properties.items[2]/3600,posAngle:e.properties.items[3]==="--"?0:e.properties.items[3]})}}),Uf=new We({service:"Vizier@CDS",name:"NVSS",className:"logo-catalog-vizier",attribution:"1.4GHz NRAO VLA Sky Survey (NVSS) (Condon et al. 1998)",color:"magenta",magLim:30,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=VIII/65/NVSS&-out=NVSS,_RAJ2000,_DEJ2000,S1.4,MajAxis,MinAxis,PA&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=-S1.4",properties:["S<sub>1.4GHz</sub>","Major axis","Minor axis","Position angle"],units:["mJy","&#8243;","&#8243;","&#176;"],objectURL:"/VizieR-5?-source=VIII/65/NVSS&-c={ra},{dec},eq=J2000&-c.rs=0.2",draw:function(e,t){return Gs(t,{majAxis:e.properties.items[1]/7200,minAxis:e.properties.items[2]/7200,posAngle:e.properties.items[3]==="--"?0:e.properties.items[3]})}}),Ur=new We({service:"Vizier@CDS",name:"PanSTARRS 1",className:"logo-catalog-vizier",attribution:"Pan-STARRS release 1 (PS1) Survey (Chambers et al. 2016)",color:"yellow",magLim:24,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=II/349&-out=objID,RAJ2000,DEJ2000,gKmag,rKmag,iKmag,zKmag,yKmag&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=rmag",properties:["g","r","i","z","y"],units:["","","","",""],objectURL:"/VizieR-5?-source=II/349/ps1&-c={ra},{dec},eq=J2000&-c.rs=0.1"}),qf=new We({service:"Vizier@CDS",name:"PPMXL",className:"logo-catalog-vizier",attribution:"PPM-Extended, positions and proper motions (Roeser et al. 2008)",color:"green",magLim:20,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=I/317&-out=PPMXL,RAJ2000,DEJ2000,Jmag,Hmag,Kmag,b1mag,b2mag,r1mag,r2mag,imag,pmRA,pmDE&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=Jmag",properties:["J","H","K","b<sub>1</sub>","b<sub>2</sub>","r<sub>1</sub>","r<sub>2</sub>","i","&#956;<sub>&#593;</sub> cos &#948;","&#956;<sub>&#948;</sub>"],units:["","","","","","","","","mas/yr","mas/yr"],objectURL:"/VizieR-5?-source=I/317&-c={ra},{dec},eq=J2000&-c.rs=0.01"}),qr=new We({service:"Vizier@CDS",name:"SDSS release 12",className:"logo-catalog-vizier",attribution:"SDSS Photometric Catalog, Release 12 (Alam et al. 2015)",color:"yellow",magLim:25,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=V/147&-out=SDSS12,RA_ICRS,DE_ICRS,umag,gmag,rmag,imag,zmag&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=rmag",properties:["u","g","r","i","z"],units:["","","","",""],objectURL:"/VizieR-5?-source=V/147/sdss12&-c={ra},{dec},eq=J2000&-c.rs=0.1"}),Yf=new We({service:"Vizier@CDS",name:"TGSS",className:"logo-catalog-vizier",attribution:"The GMRT 150 MHz all-sky radio survey. TGSS ADR1 (Intema et al. 2017)",color:"blue",magLim:30,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=J/A%2bA/598/A78/table3&-out=TGSSADR,RAJ2000,DEJ2000,Stotal,Maj,Min,PA&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=-Stotal",properties:["F<sub>peak</sub>(150MHz)","Major axis FWHM","Minor axis FWHM","Position angle"],units:["mJy","&#8243;","&#8243;","&#176;"],objectURL:"/VizieR-3?-source=-source=J/A%2bA/598/A78/table3&-c={ra},{dec},eq=J2000&-c.rs=0.2",draw:function(e,t){return Gs(t,{majAxis:e.properties.items[1]/7200,minAxis:e.properties.items[2]/7200,posAngle:e.properties.items[3]==="--"?0:e.properties.items[3]})}}),Yr=new We({service:"Vizier@CDS",name:"2MASS",className:"logo-catalog-vizier",attribution:"2MASS All-Sky Catalog of Point Sources (Cutri et al. 2003)",color:"red",magLim:17,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=II/246&-out=2MASS,RAJ2000,DEJ2000,Jmag,Hmag,Kmag&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=Jmag",properties:["J","H","K"],units:["","",""],objectURL:"/VizieR-5?-source=II/246&-c={ra},{dec},eq=J2000&-c.rs=0.1"}),Xr=new We({service:"Vizier@CDS",name:"UnWISE",attribution:"The band-merged unWISE Catalog (Schlafly et al. 2019)",color:"red",magLim:40,magScaleType:"linear",regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=II/363/unwise&-out=objID,_RAJ2000,_DEJ2000,FW1,FW2&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=-FW1",properties:["F<sub>W1</sub> (3.4\xB5m)","F<sub>W2</sub> (4.6\xB5m)"],units:['<a href="https://vizier.cds.unistra.fr/viz-bin/VizieR?-6N&-out.form=H0&//*&-5N&<&quot;Label&quot;&catid%3D2363&tabid%3D1&colid%3D8" target=\u201D_blank\u201D>nMgy (Vega)</a>','<a href="https://vizier.cds.unistra.fr/viz-bin/VizieR?-6N&-out.form=H0&//*&-5N&<&quot;Label&quot;&catid%3D2363&tabid%3D1&colid%3D9" target=\u201D_blank\u201D>nMgy (Vega)</a>'],objectURL:"/VizieR-5?-source=II/363/unwise&-c={ra},{dec},eq=J2000&-c.rs=0.2"}),Xf=new We({service:"Vizier@CDS",name:"URAT1",className:"logo-catalog-vizier",attribution:"The first U.S. Naval Observatory Astrometric Robotic Telescope Catalog (Zacharias et al. 2015)",color:"yellow",magLim:17,regionType:"box",catalogURL:"/asu-tsv?&-mime=csv&-source=I/329&-out=URAT1,RAJ2000,DEJ2000,f.mag,pmRA,pmDE&-out.meta=&-c.eq={sys}&-c={lng},{lat}&-c.bd={dlng},{dlat}&-out.max={nmax}&-sort=f.mag",properties:["f<sub>mag</sub>","&#956;<sub>&#593;</sub> cos &#948;","&#956;<sub>&#948;</sub>"],units:["","mas/yr","mas/yr"],objectURL:"/VizieR-5?-source=I/329&-c={ra},{dec},eq=J2000&-c.rs=0.1"}),Gr=new We({service:"SkyBot@IMCCE",name:"SkyBot",className:"logo-catalog-imcce",attribution:"SkyBoT: a VO service to identify Solar System objects (Berthier et al. 2006)",color:"orange",magLim:30,magIndex:1,regionType:"box",serviceURL:"https://vo.imcce.fr/webservices/skybot/",catalogURL:"skybotconesearch_query.php?-mime=text&-from=VisiOmatic&-output=basic&-objFilter=111&-refsys=EQJ2000&-ep={jd}&-loc={observer}&-ra={lng}&-dec={lat}&-bd={dlng}x{dlat}",properties:["Class","V","Position uncertainty","&#956;<sub>&#593;</sub> cos &#948;","&#956;<sub>&#948;</sub>","Geocentric distance","Heliocentric distance"],units:["","","&#8243;","&#8243;/h","&#8243;/h","au","au"],objectURL:"https://vizier.unistra.fr/viz-bin/VizieR-5?-source=B/astorb/astorb&Name==={id}",format:"text",draw:function(e,t){let n=e.properties.items,s=(this.jd[1]-this.jd[0])*24,a=Math.abs(Math.cos(t.lat*Math.PI/180)),r=a>0?1/a:.001,l=r*s*n[3]/7200,u=s*n[4]/7200;return(0,ih.polyline)([[t.lat-u,t.lng-l],[t.lat+u,t.lng+l]])},style:function(e){return{color:this.color,weight:8}},toGeoJSON:function(e){let t=/#|No\s|^$/,n=/^([-+]?)(\d+)\s(\d+)\s(\d+\.?\d*)/,s=e.split(`
`),a={type:"FeatureCollection",features:[]};for(var r in s){var l=s[r];if(t.test(l)===!1){var u={type:"Feature",id:"",properties:{items:[]},geometry:{type:"Point",coordinates:[0,0]}},f=u.geometry,m=u.properties;let v=l.split(" | ");u.id=v[1],ra=n.exec(v[2]),dec=n.exec(v[3]),f.coordinates=[Number(ra[2])*15+Number(ra[3])/4+Number(ra[4])/240,Number(dec[1]+"1")*(Number(dec[2])+Number(dec[3])/60+Number(dec[4])/3600)],m.items.push(v[4]),m.items.push(this.readProperty(v[5])),m.items.push(this.readProperty(v[6]));let y=v.slice(8);for(var _ in y)m.items.push(this.readProperty(y[_]));a.features.push(u)}}return a}});var fc={};Kn(fc,{CatalogUI:()=>lh,ChannelUI:()=>ch,Coords:()=>il,DocUI:()=>hh,ExtraMap:()=>nl,FullScreen:()=>fh,ImageUI:()=>mh,PixelValues:()=>gh,PreferencesUI:()=>_h,ProfileUI:()=>Bd,RegionUI:()=>jd,Reticle:()=>Hd,Scale:()=>Vd,Sidebar:()=>Zd,SnapshotUI:()=>Ud,catalogUI:()=>Gf,channelUI:()=>$f,coords:()=>Kf,docUI:()=>Jf,extraMap:()=>Qf,fullScreen:()=>tp,imageUI:()=>ep,pixelValues:()=>ip,preferencesUI:()=>np,profileUI:()=>o0,regionUI:()=>a0,reticle:()=>r0,scale:()=>l0,sidebar:()=>c0,snapshotUI:()=>h0});var Ta=Bt(Vt());Ta.Control.Attribution.include({_update:function(){if(!this._map)return;let e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);let n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(" &#169; ")}});Ta.Map.addInitHook(function(){this.options.visiomaticLogo!==!1&&this.options.attributionControl&&this.attributionControl.setPrefix('<a id="logo-visiomatic" class="leaflet-control-attribution-logo "href="http://visiomatic.org" target="_blank">&nbsp;</a>')});var xe=Bt(Vt());var Qr={};Kn(Qr,{RGB:()=>_s,VUtil:()=>De,rgb:()=>Dn});var nh=Bt(Vt()),_s=function(e,t,n){this.r=e,this.g=t,this.b=n};_s.prototype={clone:function(){return new _s(this.r,this.g,this.b)},toStr:function(){let e=Math.round(this.r*255),t=Math.round(this.g*255),n=Math.round(this.b*255);return e<0?e=0:e>255&&(e=255),t<0?t=0:t>255&&(t=255),n<0?n=0:n>255&&(n=255),"#"+((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)},isOn:function(){return this.r>0||this.g>0||this.b>0}};var Dn=function(e,t,n){if(e instanceof _s)return e;if(typeof e=="string"){let s=parseInt("0x"+e.slice(1),16);return new _s((s>>16&255)/255,(s>>8&255)/255,(s&255)/255)}return nh.Util.isArray(e)?new _s(e[0],e[1],e[2]):e==null?e:new _s(e,t,n)};var Jr=Bt(Vt()),De={REG_PDEC:"(\\d+\\.\\d*)",REG_FLOAT:"([-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)",requestURL:function(e,t,n,s,a){var r;if(window.XMLHttpRequest)r=new XMLHttpRequest;else if(window.ActiveXObject)try{r=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{r=new ActiveXObject("Microsoft.XMLHTTP")}catch{}}if(!r)return alert("Giving up: Cannot create an XMLHTTP instance for "+t),!1;a&&(r.timeout=a*1e3,r.ontimeout=function(){alert("Time out while "+t)}),r.open("GET",e),s&&s.options.credentials&&(r.withCredentials=!0),s&&s.options.authenticate==="csrftoken"&&r.setRequestHeader("X-CSRFToken",this.getCookie("csrftoken")),n&&(r.onreadystatechange=function(){n(s,r)}),r.send()},parseURL:function(e){let t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(n,s,a,r){t[s]=r}),t},updateURL:function(e,t,n){let s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=e.indexOf("?")!==-1?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+n+"$2"):e+a+t+"="+n},checkDomain:function(e){return e.indexOf("//")===0&&(e=location.protocol+e),e.toLowerCase().replace(/([a-z])?:\/\//,"$1").split("/")[0]},isExternal:function(e){return(e.indexOf(":")>-1||e.indexOf("//")>-1)&&this.checkDomain(location.href)!==this.checkDomain(e)},getCookie:function(e){let t=e+"=",n=document.cookie.split(";");for(var s=0;s<n.length;s++){for(var a=n[s];a.charAt(0)===" ";)a=a.substring(1);if(a.indexOf(t)===0)return a.substring(t.length,a.length)}return""},copyToClipboard:function(e){if(document.queryCommandSupported&&document.queryCommandSupported("copy")){let t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch(n){return console.warn("Copy to clipboard failed.",n),!1}finally{document.body.removeChild(t)}}},flashElement:function(e){Jr.DomUtil.addClass(e,"leaflet-control-flash"),setTimeout(function(){Jr.DomUtil.removeClass(e,"leaflet-control-flash")},400)},readFITSKey:function(e,t){let n=e.trim().toUpperCase().substr(0,8),s=8-n.length,a=new RegExp(n+(s>0?"\\ {"+s.toString()+"}":"")+"=\\ *(?:'((?:\\ *[^'\\ ]+)*)\\ *'|([-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?))"),r=a.exec(t);return r?r[1]?r[1]:r[2]:null}};var ht=Bt(Vt()),rh=Bt(sh());var Wi=Bt(Vt()),oh=Wi.Evented.extend({options:{title:"Click to switch",checked:!1,className:"leaflet-flipswitch"},initialize:function(e,t){t=Wi.Util.setOptions(this,t);let n=this,s=t.className,a=Wi.DomUtil.create("div",s,e),r=this._input=L.DomUtil.create("input",s,a),l=Wi.DomUtil.create("label",s,a);return r.type="checkbox",r.name=t.className,r.checked=t.checked,l.htmlFor=r.id=t.id,t.title&&(l.title=t.title),Wi.DomUtil.create("span",s+"-inner",l),Wi.DomUtil.create("span",s+"-button",l),Wi.DomEvent.disableClickPropagation(a).disableScrollPropagation(a),Wi.DomEvent.on(r,"change",function(){this.fire("change")},this),a},value:function(e){return e===void 0?this._input.checked:(this._input.checked=!!e,this)}});var ee=Bt(Vt()),ah=ee.Evented.extend({options:{title:"Enter value",dmin:void 0,dmax:void 0,step:void 0,initValue:void 0,repButton:!0,clickEvent:"click",instantUpdate:!1,className:"leaflet-spinbox"},initialize:function(e,t){t=ee.Util.setOptions(this,t);let n=this,s=this._drag={startEvent:"touchstart mousedown",stopEvent:"touchend mouseup mouseout touchcancel",move:!1,start:!1,end:!1,pos:!1,target:!1,delta:!1,tmp:!1,cnt:0,step:t.step,prec:this._prec(t.step)},a=this._wrap=ee.DomUtil.create("div",t.className,e),r=this._input=ee.DomUtil.create("input",t.className+"-input",a),l=this._down=ee.DomUtil.create("div",t.className+"-down",a),u=this._downIcon=ee.DomUtil.create("div",t.className+"-down-icon",l),f=this._up=ee.DomUtil.create("div",t.className+"-up",a),m=this._upIcon=ee.DomUtil.create("div",t.className+"-up-icon",f);return r.type="number",r.step=.1,ee.DomEvent.disableClickPropagation(a).disableScrollPropagation(a),r.disabled===!0&&(t.disabled=!0),t.dmin===void 0&&(t.dmin=-Number.MAX_VALUE),t.dmax===void 0&&(t.dmax=Number.MAX_VALUE),t.step===void 0&&(t.step=1),t.initValue===void 0&&(t.initValue=(t.dmin+t.dmax)/2),this.value(t.initValue),r.title=t.title,l.title="Decrease number by "+t.step,f.title="Increase number by "+t.step,ee.DomEvent.on(this._input,"change",function(){this.value(Math.min(Math.max(parseFloat(this._input.value),this.options.dmin),this.options.dmax)),this.fire("change")},this),t.repButton===!1?(ee.DomEvent.on(l,t.clickEvent,function(_){_.preventDefault(),this._offset(_.currentTarget,-1)},this),ee.DomEvent.on(f,t.clickEvent,function(_){_.preventDefault(),this._offset(_.currentTarget,1)},this)):(ee.DomEvent.on(l,s.startEvent,function(_){r.blur(),s.move=!0,s.cnt=0,s.step=t.step,s.prec=this._prec(s.step),s.delta=-1,this._offset(_.currentTarget,-1),this.runButton||(s.target=_.currentTarget,this.runButton=setTimeout(function(){n._sboxRun()},500))},this),ee.DomEvent.on(f,s.startEvent,function(_){r.blur(),s.move=!0,s.cnt=0,s.step=t.step,s.prec=this._prec(s.step),s.delta=1,this._offset(_.currentTarget,1),this.runButton||(s.target=_.currentTarget,this.runButton=setTimeout(function(){n._sboxRun()},500))},this),ee.DomEvent.on(l,s.stopEvent,function(_){s.move&&(_.preventDefault(),clearTimeout(this.runButton),this.runButton=!1,s.move=!1,t.instantUpdate===!1&&this.fire("change"))},this),ee.DomEvent.on(f,s.stopEvent,function(_){s.move&&(_.preventDefault(),clearTimeout(this.runButton),this.runButton=!1,s.move=!1,t.instantUpdate===!1&&this.fire("change"))},this)),t.disabled&&this.disable(),a},value:function(e){return e===void 0?parseFloat(this._input.value):(this._input.value=Number(e.toPrecision(8)),this)},step:function(e){return e===void 0?this.options.step:(this.options.step=e,this)},disable:function(){let e="disabled";this._input.disabled=!0,this._input.blur(),ee.DomUtil.addClass(this._wrap,e),ee.DomUtil.addClass(this._down,e),ee.DomUtil.addClass(this._up,e),this.options.disabled=!0},enable:function(){let e="disabled";this._input.disabled=!1,ee.DomUtil.removeClass(this._wrap,e),ee.DomUtil.removeClass(this._down,e),ee.DomUtil.removeClass(this._up,e),this.options.disabled=!1},_sboxRun:function(){let e=this,t=this.options,n=this._drag,s=150;n.cnt===20?(s=50,n.step=10*t.step,n.prec=this._prec(n.step)):n.cnt===40?(s=10,n.step=100*t.step,n.prec=this._prec(n.step)):n.cnt===60?(n.step=1e3*t.step,n.prec=this._prec(n.step)):n.cnt===80&&(n.step=1e4*t.step,n.prec=this._prec(n.step)),n.didRun=!0,this._offset(this,n.delta),n.cnt++,this.runButton=setTimeout(function(){e._sboxRun()},s)},_prec:function(e){let t=-.4342944*Math.log(e);return t>0?Math.ceil(t):0},_offset:function(e,t){let n=this.options,s=this._input,a=this._drag;if(!this.disabled)if(t<1){var r=(parseFloat(s.value)-a.step).toFixed(a.prec);r>=n.dmin&&(s.value=r,n.instantUpdate===!0&&this.fire("change"))}else{var r=(parseFloat(s.value)+a.step).toFixed(a.prec);r<=n.dmax&&(s.value=r,n.instantUpdate===!0&&this.fire("change"))}}});var Je=ht.Control.extend({options:{title:"a control related to VisiOmatic",collapsed:!0,position:"topleft"},initialize:function(e,t){ht.Util.setOptions(this,t),this._className="visiomatic-control",this._id="visiomatic-image",this._layers=e},addTo:function(e){return e._sidebar?(this._sidebar=e,this._map=e._map,this._dialog=ht.DomUtil.create("div",this._className+"-dialog"),e.addTab(this._id,this._className,this.options.title,this._dialog,this._sideClass),this._map.on("layeradd",this._checkVisiomatic,this),e):ht.Control.prototype.addTo.call(this,e)},onAdd:function(e){let t=this._className,n=this._id,s=this._container=ht.DomUtil.create("div",t+" leaflet-bar");if(s.setAttribute("aria-haspopup",!0),ht.DomEvent.disableClickPropagation(s).disableScrollPropagation(s),this._dialog=ht.DomUtil.create("div",t+"-dialog",s),this.options.collapsed){ht.Browser.android||ht.DomEvent.on(s,"mouseover",this._expand,this).on(s,"mouseout",this._collapse,this);let a=this._toggle=ht.DomUtil.create("a",t+"-toggle leaflet-bar",s);a.href="#",a.id=n+"-toggle",a.title=this.options.title,ht.Browser.touch?ht.DomEvent.on(a,"click",ht.DomEvent.stop,this).on(a,"click",this._expand,this):ht.DomEvent.on(a,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();return this._map.on("layeradd",this._checkVisiomatic,this),this._container},_checkVisiomatic:function(e){let t=e.layer;!t||!t.visioDefault||(this._layer=t,this._reloadFlag?t.once("load",this._resetDialog,this):(this._initDialog(),this._reloadFlag=!0))},_initDialog:function(){},_resetDialog:function(){this._dialog.innerHTML="",this._initDialog()},_addDialogBox:function(e){let t=ht.DomUtil.create("div",this._className+"-box",this._dialog);return e&&(t.id=e),t},_addDialogLine:function(e,t){let n=ht.DomUtil.create("div",this._className+"-line",t),s=ht.DomUtil.create("div",this._className+"-label",n);return s.innerHTML=e,n},_addDialogElement:function(e){return ht.DomUtil.create("div",this._className+"-element",e)},_expand:function(){ht.DomUtil.addClass(this._container,this._className+"-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" "+this._className+"-expanded","")},getActiveBaseLayer:function(){return this._activeBaseLayer},_findActiveBaseLayer:function(){let e=this._layers;this._prelayer=void 0;for(var t in e){var n=e[t];if(!n.overlay){if(!n._map)this._prelayer=n;else if(this._map.hasLayer(n)&&n.visioDefault)return n}}},_addButton:function(e,t,n=void 0,s=void 0,a=void 0){let r=ht.DomUtil.create("div",e,t),l=ht.DomUtil.create("div",e+"-icon",r);return r.target="_blank",n&&(r.id=e+"-"+n),a&&ht.DomEvent.on(r,"click touch",a,this),s&&(r.title=s),r},_addRadioButton:function(e,t,n,s,a=void 0,r=void 0){let l=ht.DomUtil.create("label",e,t),u=ht.DomUtil.create("input",e,l),f=ht.DomUtil.create("div",e,l);return u.type="radio",u.name=e,u.value=n,u.checked=s,r&&ht.DomEvent.on(u,"click touch",function(){r(n)},this),l.htmlFor=u.id=e+"-"+n,a&&(l.title=a),u},_addSelectMenu:function(e,t,n,s=void 0,a=void 0,r=void 0,l=void 0){let u=ht.DomUtil.create("div",e,t),f=ht.DomUtil.create("select",e,u),m=document.createElement("option"),_=f.opt=[];m.text="choose",m.disabled=!0,(!a||a<0)&&(m.selected=!0),f.add(m,null);for(var v in n){var y=parseInt(v,10);_[y]=document.createElement("option"),_[y].text=n[y],_[y].style["background-color"]="orange",_[y].value=y,s&&s[y]?_[y].disabled=!0:y===a&&(_[y].selected=!0),f.add(_[y],null)}return this._container&&!ht.Browser.android&&this.options.collapsed&&(ht.DomEvent.on(f,"mousedown",function(){ht.DomEvent.off(this._container,"mouseout",this._collapse,this),this.collapsedOff=!0},this),ht.DomEvent.on(this._container,"mouseover",function(){this.collapsedOff&&(ht.DomEvent.on(this._container,"mouseout",this._collapse,this),this.collapsedOff=!1)},this)),l&&ht.DomEvent.on(f,"change keyup",l,this),r&&(u.title=r),f},_addColorPicker:function(e,t,n,s,a,r=void 0,l=void 0){let u=this,f=ht.DomUtil.create("color",e,t),m=rh.default.create(f,{color:s,type:"color",allowEmpty:!1,appendTo:this._map._container,cancelText:"CANCEL",chooseText:"OK",clickoutFiresChange:!1,localStorageKey:a,showAlpha:!1,showInput:!0,change:v=>{let y=v.detail.color?v.detail.color.toHexString():null;f.style.backgroundColor=f.value=y,l&&l(y)}}),_=m.spectrum.container;return _.getElementsByClassName("sp-input")[0].title="Current color. Click to edit",_.getElementsByClassName("sp-cancel")[0].title="Cancel selection",_.getElementsByClassName("sp-choose")[0].title="Accept selection",_.getElementsByClassName("sp-dragger")[0].title="Drag to adjust saturation/luminosity",_.getElementsByClassName("sp-slider")[0].title="Slide to adjust hue",ht.DomEvent.disableClickPropagation(_),ht.DomEvent.disableScrollPropagation(_),f.type="text",f.style.backgroundColor=f.value=s,f.id=e+"-"+n,r&&(f.title=r),f},_addSwitchInput:function(e,t,n,s,a=void 0,r){let l=this._addDialogLine(s,n),u=this._addDialogElement(l),f=u.flip=new oh(u,{checked:r,title:a});return f.on("change",function(){e._setAttr(t,f.value())},this),u},_addNumericalInput:function(e,t,n,s,a=void 0,r,l,u=void 0,f=void 0,m=void 0){let _=this._addDialogLine(s,n),v=this._addDialogElement(_),y=v.spinbox=new ah(v,{step:l,dmin:u,dmax:f,initValue:r,title:a});return y.on("change",function(){De.flashElement(y._input),e._setAttr(t,y.value(),m)},this),v},_updateInput:function(e,t){e.spinbox?e.spinbox.value(t):e.flip&&e.flip.value(t)},_spinboxStep:function(e,t){let n=parseFloat((Math.abs(t===e?t:t-e)*.001).toPrecision(1));return n===0?1:n},_updateLayerList:function(){if(!this._dialog)return this;this._layerList?ht.DomUtil.empty(this._layerList):this._layerList=ht.DomUtil.create("div","visiomatic-control-layerlist",this._dialog);for(var e in this._layers)this._addLayerItem(this._layers[e]);return this},_addLayerItem:function(e){let t=this,n=ht.DomUtil.create("div","visiomatic-control-layer"),s=ht.DomUtil.create("div","visiomatic-control-layerswitch",n);if(e.layer.notReady)ht.DomUtil.create("div","visiomatic-control-activity",s);else{let r=this._map.hasLayer(e.layer),l=document.createElement("input");l.type="checkbox",l.className="visiomatic-control-selector",l.defaultChecked=r,l.layerId=ht.Util.stamp(e.layer),ht.DomEvent.on(l,"click",function(){let u=this._layerList.getElementsByTagName("input"),f=u.length;for(this._handlingClick=!0,i=0;i<f;i++){var m=u[i];if("layerId"in m){var _=this._layers[m.layerId];m.checked&&!this._map.hasLayer(_.layer)?_.layer.addTo(this._map):!m.checked&&this._map.hasLayer(_.layer)&&this._map.removeLayer(_.layer)}}this._handlingClick=!1},this),s.appendChild(l)}let a=ht.DomUtil.create("div","visiomatic-control-layername",n);return a.innerHTML=" "+e.name,a.style.textShadow="0px 0px 5px "+e.layer.nameColor,ht.DomEvent.on(a,"click touch",()=>{e.layer.bringToFront()},this),this._addButton("visiomatic-control-trash",n,void 0,"Delete layer",function(){t.removeLayer(e.layer),e.notReady||t._map.removeLayer(e.layer)}),this._layerList.appendChild(n),n},addLayer:function(e,t,n){e.on("add remove",this._onLayerChange,this);let s=ht.Util.stamp(e);return this._layers[s]={layer:e,name:t,index:n},this._updateLayerList()},removeLayer:function(e){return e.off("add remove",this._onLayerChange,this),e.fire("trash",{index:this._layers[ht.Util.stamp(e)].index}),e.off("trash"),delete this._layers[ht.Util.stamp(e)],this._updateLayerList()},_onLayerChange:function(e){this._handlingClick||this._updateLayerList();let t=this._layers[ht.Util.stamp(e.target)],n=e.type==="add"?"overlayadd":"overlayremove";this._map.fire(n,t)}});var lh=Je.extend({defaultCatalogs:[Wr,Yr,qr,Ur,Xr,Gr],options:{title:"Catalog overlays",nativeCelSys:!0,color:"#FFFF00",timeOut:30,authenticate:!1,collapsed:!0,position:"topleft"},initialize:function(e,t){xe.Util.setOptions(this,t),this._className="visiomatic-control",this._id="visiomatic-catalog",this._layers={},this._handlingClick=!1,this._sideClass="catalog",this._catalogs=e||this.defaultCatalogs},_initDialog:function(){let e=this._className,t=this._catalogs,n=this._addDialogBox(),s=this._addDialogLine("",n),a=this._addDialogElement(s),r=this._addColorPicker(e+"-color",a,"catalog",this.options.color,"visiomaticCatalog",title="Click to set catalog color"),l=this._addSelectMenu(this._className+"-select",a,t.map(function(f){return f.name}),void 0,-1,"Select Catalog",function(){let f=t[l.selectedIndex-1].className;f===void 0&&(f=""),xe.DomUtil.setClass(l,this._className+"-select "+f)});xe.DomEvent.on(l,"change keyup",function(){let f=t[l.selectedIndex-1];l.title=f.attribution+" from "+f.service},this);let u=this._addDialogElement(s);this._addButton(e+"-button",u,"catalog","Query catalog",function(){let f=l.selectedIndex-1;if(f>=0){let m=t[f];m.color=r.value,l.selectedIndex=0,l.title="Select Catalog",xe.DomUtil.setClass(l,this._className+"-select "),this._getCatalog(m,this.options.timeOut)}})},_resetDialog:function(){},_getCatalog:async function(e,t){let n=this,s=this._map,a=s.options.crs,r=!a.equatorialFlag&&!this.options.nativeCelSys,l=r?a.celSysToEq(s.getCenter()):s.getCenter(),u=s.getPixelBounds(),f=s.getZoom(),m=new xe.LayerGroup(null);m.notReady=!0,this.addLayer(m,e.name),e.authenticate?this.options.authenticate=e.authenticate:this.options.authenticate=!1;let _=Math.abs(Math.cos(l.lat*Math.PI/180)),v=r?[a.celSysToEq(s.unproject(u.min,f)),a.celSysToEq(s.unproject((0,xe.point)(u.min.x,u.max.y),f)),a.celSysToEq(s.unproject(u.max,f)),a.celSysToEq(s.unproject((0,xe.point)(u.max.x,u.min.y),f))]:[s.unproject(u.min,f),s.unproject((0,xe.point)(u.min.x,u.max.y),f),s.unproject(u.max,f),s.unproject((0,xe.point)(u.max.x,u.min.y),f)];var y,w;if(!a.equatorialFlag&&this.options.nativeCelSys)switch(a.celSysCode){case"ecliptic":w="E2000.0";break;case"galactic":w="G";break;case"supergalactic":w="S";break;default:w="J2000.0";break}else w="J2000.0";let k=.5*(a.jd[0]+a.jd[1]),A=a.obslatlng[0]==0&&a.obslatlng[1]==0?"500":a.obslatlng[0].toFixed(4)+","+a.obslatlng[1].toFixed(4)+",0";if(e.regionType==="box"){let E=(Math.max(a._deltaLng(v[0],l),a._deltaLng(v[1],l),a._deltaLng(v[2],l),a._deltaLng(v[3],l))-Math.min(a._deltaLng(v[0],l),a._deltaLng(v[1],l),a._deltaLng(v[2],l),a._deltaLng(v[3],l)))*_,D=Math.max(v[0].lat,v[1].lat,v[2].lat,v[3].lat)-Math.min(v[0].lat,v[1].lat,v[2].lat,v[3].lat);D<1e-4&&(D=1e-4),E<1e-4&&(E=1e-4),y=await fetch(xe.Util.template(e.url,xe.Util.extend({sys:w,jd:k,observer:568,lng:l.lng.toFixed(6),lat:l.lat.toFixed(6),dlng:E.toFixed(4),dlat:D.toFixed(4),nmax:e.nmax+1,maglim:e.maglim})))}else{let E=Math.max(a.distance(v[0],l),a.distance(v[0],l),a.distance(v[0],l),a.distance(v[0],l));y=await fetch(xe.Util.template(e.url,xe.Util.extend({sys:w,jd:k,observer:568,lng:l.lng.toFixed(6),lat:l.lat.toFixed(6),dr:E.toFixed(4),drm:(E*60).toFixed(4),nmax:e.nmax+1})))}y.status==200?this._loadCatalog(e,m,await y):(this.removeLayer(m),alert("Error "+y.status+" while querying "+e.service+"."))},_loadCatalog:async function(e,t,n){let s=this._map.options.crs;e.jd=s.jd;let a=e.toGeoJSON(e.format=="json"?await n.json():await n.text()),r=(0,xe.geoJson)(a,{onEachFeature:function(u,f){u.properties&&u.properties.items&&f.bindPopup(e.popup(u))},coordsToLatLng:function(u){if(s.equatorialFlag)return new L.LatLng(u[1],u[0],u[2]);{let f=s.eqToCelSys(L.latLng(u[1],u[0]));return new L.LatLng(f.lat,f.lng,u[2])}},filter:function(u){return e.filter(u)},pointToLayer:function(u,f){return e.draw(u,f)},style:function(u){return e.style(u)}}),l=!1;r.nameColor=e.color,r.addTo(this._map),this.removeLayer(t),a.features.length>e.nmax&&(a.features.pop(),l=!0),this.addLayer(r,e.name+" ("+a.features.length.toString()+(l?"+ entries)":" entries)")),l&&alert("Selected area is too large: "+e.name+" sample has been truncated to the brightest "+e.nmax+" sources.")}}),Gf=function(e,t){return new lh(e,t)};var fe=Bt(Vt());var ch=Je.extend({options:{title:"Channel mixing",mixingMode:void 0,cMap:"grey",collapsed:!0,position:"topleft"},initialize:function(e){fe.Util.setOptions(this,e),this._className="visiomatic-control",this._id="visiomatic-channel",this._sideClass="channel",this._settings=[],this._initsettings=[]},saveSettings:function(e,t,n){t[n]||(t[n]={});let s=e.visio,a=t[n];a.channel=s.channel,a.cMap=s.cMap,a.rgb=[];for(let r in s.rgb)a.rgb[r]=s.rgb[r].clone()},loadSettings:function(e,t,n,s){let a=t[n];if(!a)return;let r=e.visio,l=r.rgb,u=a.rgb;s||(r.channel=a.channel),r.cMap=a.cMap;for(let f in u)l[f]=u[f].clone()},_initDialog:function(){let e=this,t=this._layer,n=this._className,s=this._dialog;this.saveSettings(t,this._initsettings,"mono"),this.saveSettings(t,this._initsettings,"color"),this.saveSettings(t,this._settings,"mono"),this.saveSettings(t,this._settings,"color"),this._mode=this.options.mixingMode?this.options.mixingMode:t.visio.mixingMode;let a=this._addDialogBox(),r=this._addDialogLine("Mode:",a),l=this._addDialogElement(r),u=fe.DomUtil.create("div",n+"-radios",l);this._addRadioButton(n+"-radio",u,"mono",this._mode==="mono","Select mono-channel palettized mode",function(){e.saveSettings(t,e._settings,e._mode);for(let f=a.lastChild;f!==r;f=a.lastChild)a.removeChild(f);for(let f=s.lastChild;f!==a;f=s.lastChild)s.removeChild(f);e._channelList=void 0,e.loadSettings(t,e._settings,"mono"),e._initMonoDialog(t,a),e._mode="mono"}),this._addRadioButton(n+"-radio",u,"color",this._mode!=="mono","Select color mixing mode",function(){e.saveSettings(t,e._settings,e._mode);for(let f=a.lastChild;f!==r;f=a.lastChild)a.removeChild(f);for(let f=s.lastChild;f!==a;f=s.lastChild)s.removeChild(f);e.loadSettings(t,e._settings,"color"),e._channelList=void 0,e._initColorDialog(t,a),e._mode="color"}),e._mode==="mono"?e._initMonoDialog(t,a):e._initColorDialog(t,a)},_initMonoDialog:function(e,t){let n=this,s=e.visio,a=e.visio.channelLabels,r=this._className;if(e.updateMono(),s.nChannel>1){let y=this._addDialogLine("Channel:",t),w=this._addDialogElement(y);this._chanSelect=this._addSelectMenu(this._className+"-select",w,s.channelLabels,void 0,s.channel,"Select image channel",function(){s.channel=parseInt(this._chanSelect.selectedIndex-1,10),this._updateChannel(e,s.channel),e.redraw()});let k=this._addDialogLine("Animate:",t),A=this._addDialogElement(k);this._addButton(r+"-button",A,"channel-first","Go to first frame/channel",()=>{n._gotoChannel(e,0)});let E=this._addButton(r+"-button",A,"channel-reverse","Animate frames/channels in reverse",()=>{s.playAnimation&&s.reverseAnimation?(fe.DomUtil.removeClass(E,"playing"),n._pauseAnimation(e)):(s.playAnimation&&!s.reverseAnimation&&fe.DomUtil.removeClass(D,"playing"),fe.DomUtil.addClass(E,"playing"),n._playAnimation(e,reverse=!0))});this._addButton(r+"-button",A,"channel-previous","Go to previous frame/channel",()=>{s.playAnimation&&(fe.DomUtil.removeClass(s.reverseAnimation?E:D,"playing"),n._pauseAnimation(e));let z=s.channel-1;n._gotoChannel(e,z<0?s.nChannel-1:z)}),this._addButton(r+"-button",A,"channel-next","Go to next frame/channel",()=>{s.playAnimation&&(fe.DomUtil.removeClass(s.reverseAnimation?E:D,"playing"),n._pauseAnimation(e));let z=s.channel+1;n._gotoChannel(e,z<s.nChannel?z:0)});let D=this._addButton(r+"-button",A,"channel-play","Animate channels/frames",()=>{s.playAnimation&&!s.reverseAnimation?(fe.DomUtil.removeClass(D,"playing"),n._pauseAnimation(e)):(s.playAnimation&&s.reverseAnimation&&fe.DomUtil.removeClass(E,"playing"),fe.DomUtil.addClass(D,"playing"),n._playAnimation(e))});this._addButton(r+"-button",A,"channel-last","Go to last frame/channel",()=>{n._gotoChannel(e,s.nChannel-1)}),this._addNumericalInput(e,"framerate",t,"Framerate:","Adjust animation framerate",s.framerate,.2,.2,30,()=>{s.playAnimation&&this._playAnimation(e,reverse=s.reverseAnimation)})}let l=this._addDialogLine("LUT:",t),u=this._addDialogElement(l),f=fe.DomUtil.create("div",r+"-cmaps",u),m=[],_=["grey","jet","cold","hot"],v=function(y){e._setAttr("cMap",y)};for(let y in _)m[y]=this._addRadioButton("leaflet-cmap",f,_[y],_[y]===this.options.cMap,'Select "'+_[y].charAt(0).toUpperCase()+_[y].substr(1)+'" color-map',v);this._addMinMax(e,s.channel,t),e.redraw()},_initColorDialog:function(e,t){let n=this,s=e.visio,a=this._className,r=this._addDialogLine("Channel:",t),l=this._addDialogElement(r),u=this._chanColPick=this._addColorPicker(a+"-color",l,"channel",e.getChannelColor(s.channel),"visiomaticChannel",title="Channel color. Click to edit",fn=_=>{this._updateChannelMix(e,s.channel,Dn(_))});e._setAttr("cMap","grey"),e.updateMix(),this._chanSelect=this._addSelectMenu(this._className+"-select",l,s.channelLabels,void 0,s.channel,"Select image channel",function(){s.channel=this._chanSelect.selectedIndex-1,this._updateChannel(e,s.channel,updateColor=!0)}),this._addMinMax(e,s.channel,t);let f=this._addDialogLine("Colors:",t),m=this._addDialogElement(f);this._addButton(a+"-button",m,"colormix-reset","Reset color mix",function(){n.loadSettings(e,n._initsettings,"color",!0),e.updateMix(),this._updateColPick(e,e.visio.channel),this._updateChannelList(e),e.redraw()}),this._addButton(a+"-button",m,"colormix-auto","Re-color active channels",function(){let _=s.nChannel,v=s.rgb,y=e.visioDefault.channelColors,w=0;for(let A in v)w++;w>=y.length&&(w=y.length-1);let k=0;for(let A in v)k<w&&(v[A]=Dn(y[w][k++]));e.updateMix(),this._updateColPick(e,e.visio.channel),this._updateChannelList(e),e.redraw()}),n._updateChannelList(e),e.redraw()},_addMinMax:function(e,t,n){let s=e.visio,a=this._spinboxStep(s.minValue[t],s.maxValue[t]);this._minElem=this._addNumericalInput(e,"minValue["+t+"]",n,"Min:","Adjust lower clipping limit in "+s.channelUnits[t],s.minValue[t],a),this._maxElem=this._addNumericalInput(e,"maxValue["+t+"]",n,"Max:","Adjust upper clipping limit in "+s.channelUnits[t],s.maxValue[t],a)},_playAnimation:function(e,t=!1){let n=e.visio;n.nChannel<=1||(this._pauseAnimation(e),n.reverseAnimation=t,n.playAnimation=!0,n.intervalID=setInterval(t?()=>{let s=n.channel-1;n.channel=s<0?n.nChannel-1:s,this._updateChannel(e,n.channel),e.redraw()}:()=>{let s=n.channel+1;n.channel=s<n.nChannel?s:0,this._updateChannel(e,n.channel),e.redraw()},n.framerate>0?1e3/n.framerate:1e3))},_pauseAnimation:function(e){let t=e.visio;t.playAnimation=!1,t.intervalID&&(clearInterval(t.intervalID),t.intervalID=0)},_gotoChannel:function(e,t=0){let n=e.visio;n.nChannel<=1||(this._updateChannel(e,n.channel=t),e.redraw())},_updateChannel:function(e,t,n=!1){let s=this,a=e.visio,r=this._spinboxStep(a.minValue[t],a.maxValue[t]);s._chanSelect.selectedIndex=t+1,e.fire("channelupdate"),n&&this._updateColPick(e,t),this._minElem.spinbox.value(a.minValue[t]).step(r).off("change").on("change",function(){e._setAttr("minValue["+t+"]",s._minElem.spinbox.value())},this),this._maxElem.spinbox.value(a.maxValue[t]).step(r).off("change").on("change",function(){e._setAttr("maxValue["+t+"]",s._maxElem.spinbox.value())},this)},_updateChannelMix:function(e,t,n){e.rgbToMix(t,n),this._updateChannelList(e),e.redraw()},_updateChannelList:function(e){let t=e.visio,n=t.channelLabels,s=this._channelList,a=this._channelElems,r=this._trashElems;s?fe.DomUtil.empty(this._channelList):s=this._channelList=fe.DomUtil.create("div",this._className+"-chanlist",this._dialog),a=this._channelElems=[],r=this._trashElems=[];for(c in t.rgb){var l=parseInt(c,10),u=t.rgb[l],f=fe.DomUtil.create("div",this._className+"-channel",s),m=fe.DomUtil.create("div",this._className+"-chancolor",f);m.style.backgroundColor=u.toStr(),this._activateChanElem(m,e,l);var _=fe.DomUtil.create("div",this._className+"-chanlabel",f);_.innerHTML=n[c],this._activateChanElem(_,e,l);var v=this._addButton("visiomatic-control-trash",f,void 0,"Delete channel");this._activateTrashElem(v,e,l),a.push(f),r.push(v)}},_updateColPick:function(e,t){let n=e.getChannelColor(t);this._chanColPick.style.backgroundColor=this._chanColPick.value=n},_activateTrashElem:function(e,t,n){fe.DomEvent.on(e,"click touch",function(){this._updateChannelMix(t,n,!1),t===this._layer&&n===t.visio.channel&&this._updateColPick(t,n)},this)},_activateChanElem:function(e,t,n){fe.DomEvent.on(e,"click touch",function(){t.visio.channel=n,this._updateChannel(t,n,updateColor=!0)},this)}}),$f=function(e){return new ch(e)};var pe=Bt(Vt());var il=pe.Control.extend({options:{title:"Center coordinates. Click to edit",position:"topright",coordinates:[{type:"world",label:"RA, Dec",units:"HMS",nativeCelSys:!1},{type:"pixel",label:"x, y",units:"",nativeCelSys:!1}],centerQueryKey:"center",fovQueryKey:"fov",sesameURL:"https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame"},onAdd:function(e){let t=this,n="leaflet-control-coords";return this._wcsdialog=pe.DomUtil.create("div",n+"-dialog"),this._map.on("layeradd",this._checkVisiomatic,this),this._wcsdialog},_checkVisiomatic:function(e){let t=e.layer;!t||!t.visioDefault||(this._layer=t,this._reloadFlag?t.once("load",this._resetDialog,this):(this._initDialog(),this._reloadFlag=!0))},_initDialog:function(){let e=this,t=this._map.options.crs,n=t.projections,s=this.options.coordinates,a="leaflet-control-coords",r=this._wcsdialog;if(n){let A=this._wcsext=pe.DomUtil.create("select",a+"-ext",r),E=[];pe.DomEvent.disableClickPropagation(A),A.id="leaflet-ext-select",A.title="Switch detector";for(var l in n){E[l]=document.createElement("option"),E[l].text=n[l].name;var u=parseInt(l,10);E[l].value=u,u===0&&(E[l].selected=!0),A.add(E[l],null)}pe.DomEvent.on(A,"change",function(D){let z=e._map,V=z.options.crs;z.panTo(V.unproject(V.projections[A.value].centerPnt))})}let f=pe.DomUtil.create("select",a+"-select",r),m=[];pe.DomEvent.disableClickPropagation(f),this._currentCoord=0,f.id="leaflet-coord-select",f.title="Switch coordinate system";for(var _ in s){m[_]=document.createElement("option"),m[_].text=s[_].label;var v=parseInt(_,10);m[_].value=v,v===0&&(m[_].selected=!0),f.add(m[_],null)}pe.DomEvent.on(f,"change",function(A){e._currentCoord=f.value,e._onDrag()}),n&&(f.style["border-radius"]="0px");let y=this._wcsinput=pe.DomUtil.create("input",a+"-input",r);pe.DomEvent.disableClickPropagation(y),y.type="text",y.title=this.options.title,"webkitSpeechRecognition"in window&&y.setAttribute("x-webkit-speech","x-webkit-speech"),map.on("move zoomend",this._onDrag,this),pe.DomEvent.on(y,"focus",function(){this.setSelectionRange(0,this.value.length)},y),pe.DomEvent.on(y,"change",function(){this.panTo(this._wcsinput.value)},this);let w=pe.DomUtil.create("div",a+"-clipboard",r),k=pe.DomUtil.create("div",a+"-clipboard-icon",w);w.title="Copy to clipboard",pe.DomEvent.on(w,"click",function(){let A={},E=map.getCenter(),D=location.href;De.flashElement(this._wcsinput),D=De.updateURL(D,this.options.centerQueryKey,t.latLngToHMSDMS(E)),D=De.updateURL(D,this.options.fovQueryKey,t.zoomToFov(map,map.getZoom(),E).toPrecision(4)),history.pushState(A,"",D),De.copyToClipboard(D)},this),this._onDrag()},onRemove:function(e){e.off("drag",this._onDrag)},_onDrag:function(e){let t=this._map.options.crs,n=this.options.coordinates[this._currentCoord],s=-1,a=t.untransform(this._map._getCenterLayerPoint().add(this._map.getPixelOrigin()),this._map._zoom);if(t.projections&&(s=t.multiPntToIndex(a),this._wcsext.options[s].selected=!0,a=t.projections[s]._multiToPix(a)),n.type=="pixel"){let r=t.nzoom-this._map._zoom>0?0:2;this._wcsinput.value=a.x.toFixed(r)+" , "+a.y.toFixed(r)}else{let r=s>=0?t.projections[s].unproject(a):this._map.getCenter();if(t.pixelFlag)this._wcsinput.value=r.lng.toFixed(0)+" , "+r.lat.toFixed(0);else switch(!n.nativeCelSys&&!t.equatorialFlag?r=t.celSysToEq(r):n.nativeCelSys&&t.equatorialFlag&&(r=t.eqToCelSys(r)),n.units){case"HMS":this._wcsinput.value=t.latLngToHMSDMS(r);break;case"deg":this._wcsinput.value=r.lng.toFixed(5)+" , "+r.lat.toFixed(5);break;default:this._wcsinput.value=r.lng.toFixed(1)+" , "+r.lat.toFixed(1);break}}},panTo:function(e){let t=this._map.options.crs,n=this.options.coordinates[this._currentCoord],s=t.parseCoords(e);s?t.pixelFlag?this._map.panTo(s):(!n.nativeCelSys&&!t.equatorialFlag?s=t.eqToCelSys(s):n.nativeCelSys&&t.equatorialFlag&&(s=t.celSysToEq(s)),this._map.panTo(s)):De.requestURL(this.options.sesameURL+"/-oI/A?"+e,"getting coordinates for "+e,this._getCoordinates,this,10)},_getCoordinates:function(e,t){if(t.readyState===4)if(t.status===200){let n=t.responseText,s=e._map.options.crs.parseCoords(n);s?(e._map.panTo(s),e._onDrag()):alert(n+": Unknown location")}else alert("There was a problem with the request to the Sesame service at CDS")}}),Kf=function(e){return new il(e)};pe.Map.mergeOptions({positionControl:!1});pe.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new il(this.options.positionControl),this.addControl(this.positionControl))});var Qn=Bt(Vt());var hh=Je.extend({options:{title:"Documentation",pdflink:void 0,collapsed:!0,position:"topleft"},initialize:function(e,t){Qn.Util.setOptions(this,t),this._className="visiomatic-control",this._id="visiomatic-doc",this._sideClass="doc",this._url=e},_initDialog:function(){let e=this,t=this._className,n=this._layer,s=Qn.DomUtil.create("div",this._className+"-framebox",this._dialog),a=this._iframe=Qn.DomUtil.create("iframe",this._className+"-doc",s);a.src=this._url,a.frameborder=0,this._navHistory=[],this._navPos=1,this._navIgnore=!1,Qn.DomEvent.on(a,"load",this._onloadNav,this);let r=this._addDialogBox("visiomatic-doc-dialog"),l=this._addDialogLine("Navigate:",r),u=this._addDialogElement(l);if(this._homeButton=this._addButton(t+"-button",u,"home","Navigate home",this._homeNav),this._backButton=this._addButton(t+"-button",u,"back","Navigate backward",this._backNav),this._forwardButton=this._addButton(t+"-button",u,"forward","Navigate forward",this._forwardNav),this.options.pdflink){let f=this._addButton(t+"-button",u,"pdf","Download PDF version");f.href=this.options.pdflink}},_updateNav:function(e){e!==this._navPos&&(this._navPos=e,this._navIgnore=!0,this._iframe.src=this._navHistory[this._navPos-1],this._disableNav())},_disableNav:function(){this._backButton.disabled=this._navPos===1,this._forwardButton.disabled=this._navPos>=this._navHistory.length},_backNav:function(){this._backButton.disabled||this._updateNav(Math.max(1,this._navPos-1))},_forwardNav:function(){this._forwardButton.disabled||this._updateNav(Math.min(this._navHistory.length,this._navPos+1))},_homeNav:function(){this._backButton.disabled||this._updateNav(1)},_onloadNav:function(e){if(e.type=="load"){Qn.DomEvent.on(this._iframe.contentWindow,"hashchange",this._onloadNav,this);let n=this._iframe.contentDocument.getElementsByTagName("a");for(var t=0;t<n.length;t++)De.isExternal(n[t].href)&&n[t].setAttribute("target","_blank")}if(this._navIgnore)this._navIgnore=!1;else{let n=this._iframe.contentWindow.location.href;n!==this._navHistory[this._navPos-1]&&(this._navHistory.splice(this._navPos,this._navHistory.length-this._navPos),this._navHistory.push(n),this._navPos=this._navHistory.length,this._disableNav())}}}),Jf=function(e,t){return new hh(e,t)};var se=Bt(Vt()),nl=se.Control.extend({options:{title:"Navigation mini-map. Grab to navigate",position:"topright",width:150,height:150,collapsedWidth:24,collapsedHeight:24,toggleDisplay:!0,autoToggleDisplay:!1,zoomLevelFixed:!1,zoomLevelOffset:-5,zoomAnimation:!1,aimingRectOptions:{color:"#FFFFFF",weight:1,clickable:!1},shadowRectOptions:{color:"#FDC82F",weight:1,opacity:0,fillOpacity:0,clickable:!1},strings:{hideText:"Hide map",showText:"Show map"}},initialize:function(e,t){se.Util.setOptions(this,t),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=e},onAdd:function(e){return this._mainMap=e,this._container=se.DomUtil.create("div","leaflet-control-extramap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._container.title=this.options.title,se.DomEvent.disableClickPropagation(this._container),se.DomEvent.on(this._container,"mousewheel",se.DomEvent.stopPropagation),this._extraMap=new se.Map(this._container,{attributionControl:!1,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:!this._isZoomLevelFixed(),scrollWheelZoom:!this._isZoomLevelFixed(),doubleClickZoom:!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed()}),this._layer.addTo(this._extraMap),this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._mainMap.whenReady(se.Util.bind(function(){this._extraMap.whenReady(se.Util.bind(function(){this._aimingRect=(0,se.rectangle)(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._extraMap),this._shadowRect=(0,se.rectangle)(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._extraMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._extraMap.on("movestart",this._onExtraMapMoveStarted,this),this._extraMap.on("move",this._onExtraMapMoving,this),this._extraMap.on("moveend",this._onExtraMapMoved,this),this._extraMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized())},this))},this)),this._container},onRemove:function(e){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._extraMap.off("moveend",this._onExtraMapMoved,this),this._extraMap.removeLayer(this._layer)},changeLayer:function(e){this._extraMap.removeLayer(this._layer),this._layer=e,this._extraMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._addButton("",this.options.strings.hideText,"leaflet-control-extramap-toggle-display leaflet-control-extramap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_addButton:function(e,t,n,s,a,r){let l=se.DomUtil.create("a",n,s);l.innerHTML=e,l.href="#",l.title=t;let u=se.DomEvent.stopPropagation;return se.DomEvent.on(l,"click",u).on(l,"mousedown",u).on(l,"dblclick",u).on(l,"click",se.DomEvent.preventDefault).on(l,"click",a,r),l},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?(this._restore(),this._toggleDisplayButton.title=this.options.strings.hideText):(this._minimize(),this._toggleDisplayButton.title=this.options.strings.showText)},_setDisplay:function(e){e!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position):this._container.style.display="none",this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,"")):this._container.style.display="block",this._minimized=!1},_onMainMapMoved:function(e){this._extraMapMoving?this._extraMapMoving=!1:(this._mainMapMoving=!0,this._extraMap.setView(this._mainMap.getCenter(),this._decideZoom(!0)),this._setDisplay(this._decideMinimized())),this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(e){this._aimingRect.setBounds(this._mainMap.getBounds())},_onExtraMapMoveStarted:function(e){let t=this._aimingRect.getBounds(),n=this._extraMap.latLngToContainerPoint(t.getSouthWest()),s=this._extraMap.latLngToContainerPoint(t.getNorthEast());this._lastAimingRectPosition={sw:n,ne:s}},_onExtraMapMoving:function(e){!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new se.LatLngBounds(this._extraMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._extraMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onExtraMapMoved:function(e){this._mainMapMoving?this._mainMapMoving=!1:(this._extraMapMoving=!0,this._mainMap.setView(this._extraMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){let e=this.options.zoomLevelFixed;return this._isDefined(e)&&this._isInteger(e)},_decideZoom:function(e){if(this._isZoomLevelFixed())return e?this.options.zoomLevelFixed:this._mainMap.getZoom();if(e)return this._mainMap.getZoom()+this.options.zoomLevelOffset;{let n=this._extraMap.getZoom()-this._mainMap.getZoom(),s=this._extraMap.getZoom()-this.options.zoomLevelOffset;var t;return n>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._extraMap.getMinZoom()-this.options.zoomLevelOffset?this._extraMap.getZoom()>this._lastExtraMapZoom?(t=this._mainMap.getZoom()+1,this._extraMap.setZoom(this._extraMap.getZoom()-1)):t=this._mainMap.getZoom():t=s,this._lastExtraMapZoom=this._extraMap.getZoom(),t}},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?!!this._mainMap.getBounds().contains(this._extraMap.getBounds()):this._minimized},_isInteger:function(e){return typeof e=="number"},_isDefined:function(e){return typeof e<"u"}}),Qf=function(e,t){return new nl(e,t)};se.Map.mergeOptions({extraMapControl:!1});se.Map.addInitHook(function(){this.options.extraMapControl&&(this.extraMapControl=new nl().addTo(this))});var Qe=Bt(Vt()),ke={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},uh="webkit moz o ms khtml".split(" ");if(typeof document.exitFullscreen<"u")ke.supportsFullScreen=!0;else for(La=0,dh=uh.length;La<dh;La++)if(ke.prefix=uh[La],typeof document[ke.prefix+"CancelFullScreen"]<"u"){ke.supportsFullScreen=!0;break}var La,dh;ke.supportsFullScreen&&(ke.fullScreenEventName=ke.prefix+"fullscreenchange",ke.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},ke.requestFullScreen=function(e){return this.prefix===""?e.requestFullscreen():e[this.prefix+"RequestFullScreen"]()},ke.cancelFullScreen=function(e){return this.prefix===""?document.exitFullscreen():document[this.prefix+"CancelFullScreen"]()});window.fullScreenApi=ke;var fh=Qe.Control.extend({options:{title:"Toggle full screen mode",position:"topleft",forceSeparateButton:!1},onAdd:function(e){let t="leaflet-control-zoom-fullscreen";var n;return e.zoomControl&&!this.options.forceSeparateButton?n=e.zoomControl._container:n=Qe.DomUtil.create("div","leaflet-bar"),this._addButton(this.options.title,t,n,this.toogleFullScreen,e),n},_addButton:function(e,t,n,s,a){let r=Qe.DomUtil.create("a",t,n);return r.href="#",r.title=e,Qe.DomEvent.addListener(r,"click",Qe.DomEvent.stopPropagation).addListener(r,"click",Qe.DomEvent.preventDefault).addListener(r,"click",s,a),Qe.DomEvent.addListener(n,ke.fullScreenEventName,Qe.DomEvent.stopPropagation).addListener(n,ke.fullScreenEventName,Qe.DomEvent.preventDefault).addListener(n,ke.fullScreenEventName,this._handleEscKey,a),r},toogleFullScreen:function(){this._exitFired=!1;let e=this._container;this._isFullscreen?(ke.supportsFullScreen?ke.cancelFullScreen(e):Qe.DomUtil.removeClass(e,"leaflet-pseudo-fullscreen"),this.invalidateSize(),this.fire("exitFullscreen"),this._exitFired=!0,this._isFullscreen=!1):(ke.supportsFullScreen?ke.requestFullScreen(e):Qe.DomUtil.addClass(e,"leaflet-pseudo-fullscreen"),this.invalidateSize(),this.fire("enterFullscreen"),this._isFullscreen=!0)},_handleEscKey:function(){!ke.isFullScreen(this)&&!this._exitFired&&(this.fire("exitFullscreen"),this._exitFired=!0,this._isFullscreen=!1)}}),tp=function(e){return new fh(e)};Qe.Map.addInitHook(function(){this.options.fullScreenControl&&(this.fullScreenControl=fullscreen(this.options.fullScreenControlOptions),this.addControl(this.fullScreenControl))});var ph=Bt(Vt());var mh=Je.extend({options:{title:"Image preferences",collapsed:!0,position:"topleft"},initialize:function(e){ph.Util.setOptions(this,e),this._className="visiomatic-control",this._id="visiomatic-image",this._sideClass="image",this._initsettings={}},saveSettings:function(e,t){if(!t)return;let n=e.visio;t.invertCMap=n.invertCMap,t.brightness=n.brightness,t.contrast=n.contrast,t.colorSaturation=n.colorSaturation,t.gamma=n.gamma,t.quality=n.quality},loadSettings:function(e,t){if(!t)return;let n=e.visio;n.invertCMap=t.invertCMap,this._updateInput(this._input.invertCMap,t.invertCMap),n.brightness=t.brightness,this._updateInput(this._input.brightness,t.brightness),n.contrast=t.contrast,this._updateInput(this._input.contrast,t.contrast),n.colorSaturation=t.colorSaturation,this._updateInput(this._input.colorSaturation,t.colorSaturation),n.gamma=t.gamma,this._updateInput(this._input.gamma,t.gamma),n.quality=t.quality,this._updateInput(this._input.quality,t.quality)},_initDialog:function(){let e=this,t=this._className,n=this._layer,s=n.visio,a=this._map;this._input={},this.saveSettings(n,this._initsettings),this._input.invertCMap=this._addSwitchInput(n,"invertCMap",this._dialog,"Invert:","Invert color map(s)",s.invertCMap),this._input.brightness=this._addNumericalInput(n,"brightness",this._dialog,"Brightness:","Adjust brightness. 0.0: normal",s.brightness,.1,-10,10),this._input.contrast=this._addNumericalInput(n,"contrast",this._dialog,"Contrast:","Adjust Contrast. 1.0: normal",s.contrast,.1,0,100),this._input.colorSaturation=this._addNumericalInput(n,"colorSaturation",this._dialog,"Color Sat.:","Adjust Color Saturation. 0: B&W, 1.0: normal",s.colorSaturation,.05,0,5,n.updateMix),this._input.gamma=this._addNumericalInput(n,"gamma",this._dialog,"Gamma:","Adjust Gamma correction. The standard value is 2.2",s.gamma,.05,.2,5),this._input.quality=this._addNumericalInput(n,"quality",this._dialog,"JPEG quality:","Adjust JPEG compression quality. 1: lowest, 100: highest",s.quality,1,1,100);let r=this._addDialogLine("Reset:",this._dialog),l=this._addDialogElement(r);this._addButton(t+"-button",l,"image-reset","Reset image settings",function(){e.loadSettings(n,e._initsettings),n.visio.mixingMode==="color"&&n.updateMix(),n.redraw()})}}),ep=function(e){return new mh(e)};var dn=Bt(Vt());var gh=dn.Control.extend({options:{title:"Pixel value(s)",position:"topright",valueSettings:[{type:"raw",label:"Raw",units:"",mag:!1,subtract:!1},{type:"sub",label:"-Bkg",units:"",mag:!1,subtract:!0},{type:"sbmag",label:"SB",units:"mag.arcsec\u207B\xB2",mag:!0,subtract:!1},{type:"sbmagsub",label:"SB-Bkg",units:"mag.arcsec\u207B\xB2",mag:!0,subtract:!0}]},onAdd:function(e){let t=this,n="leaflet-control-values";return this._pixelvaluesdialog=dn.DomUtil.create("div",n+"-dialog"),this._map.on("layeradd",this._checkVisiomatic,this),this._pixelvaluesdialog},_checkVisiomatic:function(e){let t=e.layer;!t||!t.visioDefault||(this._layer=t,this._reloadFlag?t.once("load",this._resetDialog,this):(this._initDialog(),this._reloadFlag=!0))},_initDialog:function(){let e=this,t=this._map.options.crs,n=t.projections,s=this.options.valueSettings,a="leaflet-control-values",r=this._pixelvaluesdialog,l=dn.DomUtil.create("select",a+"-select",r),u=[];dn.DomEvent.disableClickPropagation(l),this._currentSettings=s[0],l.id="leaflet-value-select",l.title="Switch display value";for(var f in s){u[f]=document.createElement("option"),u[f].text=s[f].label;var m=parseInt(f,10);u[f].value=m,m===0&&(u[f].selected=!0),l.add(u[f],null)}dn.DomEvent.on(l,"change",function(v){e._currentSettings=s[l.value],e._onUpdate()});let _=this._valueinput=dn.DomUtil.create("input",a+"-input",r);dn.DomEvent.disableClickPropagation(_),_.type="text",_.title=this.options.title,"webkitSpeechRecognition"in window&&_.setAttribute("x-webkit-speech","x-webkit-speech"),map.on("moveend zoomend",this._onUpdate,this),this._layer.on("channelupdate",this._onUpdate,this),this._onUpdate()},onRemove:function(e){e.off("moveend zoomend",this._onUpdate),this._layer.off("channelupdate",this._onUpdate)},_onUpdate:async function(e){let t=this._map.options.crs,n=-1,s=t.untransform(this._map._getCenterLayerPoint().add(this._map.getPixelOrigin()),this._map._zoom),a=this._layer,r=a.visio,l=r.channelUnits[r.channel],u=await fetch(a._url+`&CHAN=${r.channel+1}&VAL=${s.x.toFixed(0)},${s.y.toFixed(0)}`,{method:"GET"});if(u.status==200){let m=(await u.json()).values[0];m?(this._currentSettings.subtract&&(m-=r.backgroundLevel[r.channel]),this._currentSettings.mag&&(m=m>0?-2.5*Math.log10(m):999),this._valueinput.value=m.toPrecision(6)+" "+(this._currentSettings.units?this._currentSettings.units:l)):this._valueinput.value=null}else alert("Error "+u.status+" while getting pixel values")}}),ip=function(e){return new gh(e)};var $s=Bt(Vt());var _h=Je.extend({options:{title:"Preferences",collapsed:!0,position:"topleft"},initialize:function(e){$s.Util.setOptions(this,e),this._className="visiomatic-control",this._id="visiomatic-preferences",this._sideClass="preferences"},_initDialog:function(){let e=this._className,t=this._addDialogLine("Theme:",this._dialog),n=this._addDialogElement(t),s="visiomatic-theme-",a=localStorage.getItem("visiomaticDefaultTheme");this._themeList=getComputedStyle(document.documentElement).getPropertyValue("--visiomatic-theme-names").split(/\s+/),this._themeClassList=this._themeList.map(r=>s+r.toLowerCase()),this._defaultTheme=a||getComputedStyle(document.documentElement).getPropertyValue("--visiomatic-theme-default"),this._themeIndex=this._themeList.findIndex(r=>r===this._defaultTheme),$s.DomUtil.addClass(this._map._container,this._themeClassList[this._themeIndex]),this._themeSelect=this._addSelectMenu(this._className+"-select",n,this._themeList,void 0,this._themeIndex,"Select theme",()=>{let r=parseInt(this._themeSelect.selectedIndex-1,10);$s.DomUtil.removeClass(this._map._container,this._themeClassList[this._themeIndex]),$s.DomUtil.addClass(this._map._container,this._themeClassList[r]),this._themeIndex=r,localStorage.setItem("visiomaticDefaultTheme",this._themeList[r]),this._map.fire("themeChange")})}}),np=function(e){return new _h(e)};function So(e){return e+.5|0}var ts=(e,t,n)=>Math.max(Math.min(e,n),t);function Mo(e){return ts(So(e*2.55),0,255)}function es(e){return ts(So(e*255),0,255)}function Rn(e){return ts(So(e/2.55)/100,0,1)}function vh(e){return ts(So(e*100),0,100)}var Ui={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ol=[..."0123456789ABCDEF"],sp=e=>ol[e&15],op=e=>ol[(e&240)>>4]+ol[e&15],Ca=e=>(e&240)>>4===(e&15),ap=e=>Ca(e.r)&&Ca(e.g)&&Ca(e.b)&&Ca(e.a);function rp(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&Ui[e[1]]*17,g:255&Ui[e[2]]*17,b:255&Ui[e[3]]*17,a:t===5?Ui[e[4]]*17:255}:(t===7||t===9)&&(n={r:Ui[e[1]]<<4|Ui[e[2]],g:Ui[e[3]]<<4|Ui[e[4]],b:Ui[e[5]]<<4|Ui[e[6]],a:t===9?Ui[e[7]]<<4|Ui[e[8]]:255})),n}var lp=(e,t)=>e<255?t(e):"";function cp(e){var t=ap(e)?sp:op;return e?"#"+t(e.r)+t(e.g)+t(e.b)+lp(e.a,t):void 0}var hp=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function wh(e,t,n){let s=t*Math.min(n,1-n),a=(r,l=(r+e/30)%12)=>n-s*Math.max(Math.min(l-3,9-l,1),-1);return[a(0),a(8),a(4)]}function up(e,t,n){let s=(a,r=(a+e/60)%6)=>n-n*t*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function dp(e,t,n){let s=wh(e,1,.5),a;for(t+n>1&&(a=1/(t+n),t*=a,n*=a),a=0;a<3;a++)s[a]*=1-t-n,s[a]+=t;return s}function fp(e,t,n,s,a){return e===a?(t-n)/s+(t<n?6:0):t===a?(n-e)/s+2:(e-t)/s+4}function al(e){let n=e.r/255,s=e.g/255,a=e.b/255,r=Math.max(n,s,a),l=Math.min(n,s,a),u=(r+l)/2,f,m,_;return r!==l&&(_=r-l,m=u>.5?_/(2-r-l):_/(r+l),f=fp(n,s,a,_,r),f=f*60+.5),[f|0,m||0,u]}function rl(e,t,n,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,s)).map(es)}function ll(e,t,n){return rl(wh,e,t,n)}function pp(e,t,n){return rl(dp,e,t,n)}function mp(e,t,n){return rl(up,e,t,n)}function Mh(e){return(e%360+360)%360}function gp(e){let t=hp.exec(e),n=255,s;if(!t)return;t[5]!==s&&(n=t[6]?Mo(+t[5]):es(+t[5]));let a=Mh(+t[2]),r=+t[3]/100,l=+t[4]/100;return t[1]==="hwb"?s=pp(a,r,l):t[1]==="hsv"?s=mp(a,r,l):s=ll(a,r,l),{r:s[0],g:s[1],b:s[2],a:n}}function _p(e,t){var n=al(e);n[0]=Mh(n[0]+t),n=ll(n),e.r=n[0],e.g=n[1],e.b=n[2]}function vp(e){if(!e)return;let t=al(e),n=t[0],s=vh(t[1]),a=vh(t[2]);return e.a<255?`hsla(${n}, ${s}%, ${a}%, ${Rn(e.a)})`:`hsl(${n}, ${s}%, ${a}%)`}var bh={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},yh={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function bp(){let e={},t=Object.keys(yh),n=Object.keys(bh),s,a,r,l,u;for(s=0;s<t.length;s++){for(l=u=t[s],a=0;a<n.length;a++)r=n[a],u=u.replace(r,bh[r]);r=parseInt(yh[l],16),e[u]=[r>>16&255,r>>8&255,r&255]}return e}var ka;function yp(e){ka||(ka=bp(),ka.transparent=[0,0,0,0]);let t=ka[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}var xp=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function wp(e){let t=xp.exec(e),n=255,s,a,r;if(!!t){if(t[7]!==s){let l=+t[7];n=t[8]?Mo(l):ts(l*255,0,255)}return s=+t[1],a=+t[3],r=+t[5],s=255&(t[2]?Mo(s):ts(s,0,255)),a=255&(t[4]?Mo(a):ts(a,0,255)),r=255&(t[6]?Mo(r):ts(r,0,255)),{r:s,g:a,b:r,a:n}}}function Mp(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Rn(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}var sl=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Ks=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Sp(e,t,n){let s=Ks(Rn(e.r)),a=Ks(Rn(e.g)),r=Ks(Rn(e.b));return{r:es(sl(s+n*(Ks(Rn(t.r))-s))),g:es(sl(a+n*(Ks(Rn(t.g))-a))),b:es(sl(r+n*(Ks(Rn(t.b))-r))),a:e.a+n*(t.a-e.a)}}function Aa(e,t,n){if(e){let s=al(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*n,t===0?360:1)),s=ll(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function Sh(e,t){return e&&Object.assign(t||{},e)}function xh(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=es(e[3]))):(t=Sh(e,{r:0,g:0,b:0,a:1}),t.a=es(t.a)),t}function Pp(e){return e.charAt(0)==="r"?wp(e):gp(e)}var is=class{constructor(t){if(t instanceof is)return t;let n=typeof t,s;n==="object"?s=xh(t):n==="string"&&(s=rp(t)||yp(t)||Pp(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=Sh(this._rgb);return t&&(t.a=Rn(t.a)),t}set rgb(t){this._rgb=xh(t)}rgbString(){return this._valid?Mp(this._rgb):void 0}hexString(){return this._valid?cp(this._rgb):void 0}hslString(){return this._valid?vp(this._rgb):void 0}mix(t,n){if(t){let s=this.rgb,a=t.rgb,r,l=n===r?.5:n,u=2*l-1,f=s.a-a.a,m=((u*f===-1?u:(u+f)/(1+u*f))+1)/2;r=1-m,s.r=255&m*s.r+r*a.r+.5,s.g=255&m*s.g+r*a.g+.5,s.b=255&m*s.b+r*a.b+.5,s.a=l*s.a+(1-l)*a.a,this.rgb=s}return this}interpolate(t,n){return t&&(this._rgb=Sp(this._rgb,t._rgb,n)),this}clone(){return new is(this.rgb)}alpha(t){return this._rgb.a=es(t),this}clearer(t){let n=this._rgb;return n.a*=1-t,this}greyscale(){let t=this._rgb,n=So(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){let n=this._rgb;return n.a*=1+t,this}negate(){let t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Aa(this._rgb,2,t),this}darken(t){return Aa(this._rgb,2,-t),this}saturate(t){return Aa(this._rgb,1,t),this}desaturate(t){return Aa(this._rgb,1,-t),this}rotate(t){return _p(this._rgb,t),this}};function sn(){}var dl=(()=>{let e=0;return()=>e++})();function Nt(e){return e===null||typeof e>"u"}function Jt(e){if(Array.isArray&&Array.isArray(e))return!0;let t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ot(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function he(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function ui(e,t){return he(e)?e:t}function pt(e,t){return typeof e>"u"?t:e}var fl=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,za=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function bt(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Lt(e,t,n,s){let a,r,l;if(Jt(e))if(r=e.length,s)for(a=r-1;a>=0;a--)t.call(n,e[a],a);else for(a=0;a<r;a++)t.call(n,e[a],a);else if(Ot(e))for(l=Object.keys(e),r=l.length,a=0;a<r;a++)t.call(n,e[l[a]],l[a])}function to(e,t){let n,s,a,r;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(a=e[n],r=t[n],a.datasetIndex!==r.datasetIndex||a.index!==r.index)return!1;return!0}function To(e){if(Jt(e))return e.map(To);if(Ot(e)){let t=Object.create(null),n=Object.keys(e),s=n.length,a=0;for(;a<s;++a)t[n[a]]=To(e[n[a]]);return t}return e}function Dh(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function Rh(e,t,n,s){if(!Dh(e))return;let a=t[e],r=n[e];Ot(a)&&Ot(r)?ys(a,r,s):t[e]=To(r)}function ys(e,t,n){let s=Jt(t)?t:[t],a=s.length;if(!Ot(e))return e;n=n||{};let r=n.merger||Rh,l;for(let u=0;u<a;++u){if(l=s[u],!Ot(l))continue;let f=Object.keys(l);for(let m=0,_=f.length;m<_;++m)r(f[m],e,l,n)}return e}function xs(e,t){return ys(e,t,{merger:zh})}function zh(e,t,n){if(!Dh(e))return;let s=t[e],a=n[e];Ot(s)&&Ot(a)?xs(s,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=To(a))}var Ph={"":e=>e,x:e=>e.x,y:e=>e.y};function Fh(e){let t=e.split("."),n=[],s="";for(let a of t)s+=a,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Tp(e){let t=Fh(e);return n=>{for(let s of t){if(s==="")break;n=n&&n[s]}return n}}function gn(e,t){return(Ph[t]||(Ph[t]=Tp(t)))(e)}function ko(e){return e.charAt(0).toUpperCase()+e.slice(1)}var ws=e=>typeof e<"u",pn=e=>typeof e=="function",Fa=(e,t)=>{if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0};function pl(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}var ie=Math.PI,Qt=2*ie,Nh=Qt+ie,Lo=Number.POSITIVE_INFINITY,Bh=ie/180,ce=ie/2,ns=ie/4,hl=ie*2/3,mn=Math.log10,hi=Math.sign;function Ms(e,t,n){return Math.abs(e-t)<n}function Na(e){let t=Math.round(e);e=Ms(e,t,e/1e3)?t:e;let n=Math.pow(10,Math.floor(mn(e))),s=e/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function ml(e){let t=[],n=Math.sqrt(e),s;for(s=1;s<n;s++)e%s===0&&(t.push(s),t.push(e/s));return n===(n|0)&&t.push(n),t.sort((a,r)=>a-r).pop(),t}function os(e){return!isNaN(parseFloat(e))&&isFinite(e)}function gl(e,t){let n=Math.round(e);return n-t<=e&&n+t>=e}function Ba(e,t,n){let s,a,r;for(s=0,a=e.length;s<a;s++)r=e[s][n],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Ti(e){return e*(ie/180)}function Ao(e){return e*(180/ie)}function ja(e){if(!he(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Ha(e,t){let n=t.x-e.x,s=t.y-e.y,a=Math.sqrt(n*n+s*s),r=Math.atan2(s,n);return r<-.5*ie&&(r+=Qt),{angle:r,distance:a}}function Co(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function jh(e,t){return(e-t+Nh)%Qt-ie}function ci(e){return(e%Qt+Qt)%Qt}function Ss(e,t,n,s){let a=ci(e),r=ci(t),l=ci(n),u=ci(r-a),f=ci(l-a),m=ci(a-r),_=ci(a-l);return a===r||a===l||s&&r===l||u>f&&m<_}function we(e,t,n){return Math.max(t,Math.min(n,e))}function _l(e){return we(e,-32768,32767)}function on(e,t,n,s=1e-6){return e>=Math.min(t,n)-s&&e<=Math.max(t,n)+s}function Eo(e,t,n){n=n||(l=>e[l]<t);let s=e.length-1,a=0,r;for(;s-a>1;)r=a+s>>1,n(r)?a=r:s=r;return{lo:a,hi:s}}var en=(e,t,n,s)=>Eo(e,n,s?a=>{let r=e[a][t];return r<n||r===n&&e[a+1][t]===n}:a=>e[a][t]<n),vl=(e,t,n)=>Eo(e,n,s=>e[s][t]>=n);function bl(e,t,n){let s=0,a=e.length;for(;s<a&&e[s]<t;)s++;for(;a>s&&e[a-1]>n;)a--;return s>0||a<e.length?e.slice(s,a):e}var Hh=["push","pop","shift","splice","unshift"];function yl(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Hh.forEach(n=>{let s="_onData"+ko(n),a=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...r){let l=a.apply(this,r);return e._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...r)}),l}})})}function Va(e,t){let n=e._chartjs;if(!n)return;let s=n.listeners,a=s.indexOf(t);a!==-1&&s.splice(a,1),!(s.length>0)&&(Hh.forEach(r=>{delete e[r]}),delete e._chartjs)}function Za(e){let t=new Set(e);return t.size===e.length?e:Array.from(t)}var Wa=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function Ua(e,t){let n=[],s=!1;return function(...a){n=a,s||(s=!0,Wa.call(window,()=>{s=!1,e.apply(t,n)}))}}function xl(e,t){let n;return function(...s){return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}var Io=e=>e==="start"?"left":e==="end"?"right":"center",Re=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,wl=(e,t,n,s)=>e===(s?"left":"right")?n:e==="center"?(t+n)/2:t;function qa(e,t,n){let s=t.length,a=0,r=s;if(e._sorted){let{iScale:l,_parsed:u}=e,f=l.axis,{min:m,max:_,minDefined:v,maxDefined:y}=l.getUserBounds();v&&(a=we(Math.min(en(u,l.axis,m).lo,n?s:en(t,f,l.getPixelForValue(m)).lo),0,s-1)),y?r=we(Math.max(en(u,l.axis,_,!0).hi+1,n?0:en(t,f,l.getPixelForValue(_),!0).hi+1),a,s)-a:r=s-a}return{start:a,count:r}}function Ya(e){let{xScale:t,yScale:n,_scaleRanges:s}=e,a={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!s)return e._scaleRanges=a,!0;let r=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,a),r}var Ea=e=>e===0||e===1,Th=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Qt/n)),Lh=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Qt/n)+1,vs={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*ce)+1,easeOutSine:e=>Math.sin(e*ce),easeInOutSine:e=>-.5*(Math.cos(ie*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Ea(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ea(e)?e:Th(e,.075,.3),easeOutElastic:e=>Ea(e)?e:Lh(e,.075,.3),easeInOutElastic(e){return Ea(e)?e:e<.5?.5*Th(e*2,.1125,.45):.5+.5*Lh(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-vs.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?vs.easeInBounce(e*2)*.5:vs.easeOutBounce(e*2-1)*.5+.5};function Xa(e){if(e&&typeof e=="object"){let t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Ga(e){return Xa(e)?e:new is(e)}function Da(e){return Xa(e)?e:new is(e).saturate(.5).darken(.1).hexString()}var Lp=["x","y","borderWidth","radius","tension"],Cp=["color","borderColor","backgroundColor"];function kp(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:Cp},numbers:{type:"number",properties:Lp}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Ap(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var Ch=new Map;function Ep(e,t){t=t||{};let n=e+JSON.stringify(t),s=Ch.get(n);return s||(s=new Intl.NumberFormat(e,t),Ch.set(n,s)),s}function Ps(e,t,n){return Ep(t,n).format(e)}var Vh={values(e){return Jt(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";let s=this.chart.options.locale,a,r=e;if(n.length>1){let m=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(m<1e-4||m>1e15)&&(a="scientific"),r=Ip(e,n)}let l=mn(Math.abs(r)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),f={notation:a,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Ps(e,s,f)},logarithmic(e,t,n){if(e===0)return"0";let s=n[t].significand||e/Math.pow(10,Math.floor(mn(e)));return[1,2,3,5,10,15].includes(s)||t>.8*n.length?Vh.numeric.call(this,e,t,n):""}};function Ip(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var Oo={formatters:Vh};function Op(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Oo.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}var as=Object.create(null),$a=Object.create(null);function Po(e,t){if(!t)return e;let n=t.split(".");for(let s=0,a=n.length;s<a;++s){let r=n[s];e=e[r]||(e[r]=Object.create(null))}return e}function cl(e,t,n){return typeof t=="string"?ys(Po(e,t),n):ys(Po(e,""),t)}var ul=class{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,a)=>Da(a.backgroundColor),this.hoverBorderColor=(s,a)=>Da(a.borderColor),this.hoverColor=(s,a)=>Da(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return cl(this,t,n)}get(t){return Po(this,t)}describe(t,n){return cl($a,t,n)}override(t,n){return cl(as,t,n)}route(t,n,s,a){let r=Po(this,t),l=Po(this,s),u="_"+n;Object.defineProperties(r,{[u]:{value:r[n],writable:!0},[n]:{enumerable:!0,get(){let f=this[u],m=l[a];return Ot(f)?Object.assign({},m,f):pt(f,m)},set(f){this[u]=f}}})}apply(t){t.forEach(n=>n(this))}},de=new ul({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[kp,Ap,Op]);function Zh(e){return!e||Nt(e.size)||Nt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function Js(e,t,n,s,a){let r=t[a];return r||(r=t[a]=e.measureText(a).width,n.push(a)),r>s&&(s=r),s}function Ml(e,t,n,s){s=s||{};let a=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(a=s.data={},r=s.garbageCollect=[],s.font=t),e.save(),e.font=t;let l=0,u=n.length,f,m,_,v,y;for(f=0;f<u;f++)if(v=n[f],v!=null&&!Jt(v))l=Js(e,a,r,l,v);else if(Jt(v))for(m=0,_=v.length;m<_;m++)y=v[m],y!=null&&!Jt(y)&&(l=Js(e,a,r,l,y));e.restore();let w=r.length/2;if(w>n.length){for(f=0;f<w;f++)delete a[r[f]];r.splice(0,w)}return l}function Fn(e,t,n){let s=e.currentDevicePixelRatio,a=n!==0?Math.max(n/2,.5):0;return Math.round((t-a)*s)/s+a}function Ka(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Do(e,t,n,s){Ja(e,t,n,s,null)}function Ja(e,t,n,s,a){let r,l,u,f,m,_,v,y,w=t.pointStyle,k=t.rotation,A=t.radius,E=(k||0)*Bh;if(w&&typeof w=="object"&&(r=w.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){e.save(),e.translate(n,s),e.rotate(E),e.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),e.restore();return}if(!(isNaN(A)||A<=0)){switch(e.beginPath(),w){default:a?e.ellipse(n,s,a/2,A,0,0,Qt):e.arc(n,s,A,0,Qt),e.closePath();break;case"triangle":_=a?a/2:A,e.moveTo(n+Math.sin(E)*_,s-Math.cos(E)*A),E+=hl,e.lineTo(n+Math.sin(E)*_,s-Math.cos(E)*A),E+=hl,e.lineTo(n+Math.sin(E)*_,s-Math.cos(E)*A),e.closePath();break;case"rectRounded":m=A*.516,f=A-m,l=Math.cos(E+ns)*f,v=Math.cos(E+ns)*(a?a/2-m:f),u=Math.sin(E+ns)*f,y=Math.sin(E+ns)*(a?a/2-m:f),e.arc(n-v,s-u,m,E-ie,E-ce),e.arc(n+y,s-l,m,E-ce,E),e.arc(n+v,s+u,m,E,E+ce),e.arc(n-y,s+l,m,E+ce,E+ie),e.closePath();break;case"rect":if(!k){f=Math.SQRT1_2*A,_=a?a/2:f,e.rect(n-_,s-f,2*_,2*f);break}E+=ns;case"rectRot":v=Math.cos(E)*(a?a/2:A),l=Math.cos(E)*A,u=Math.sin(E)*A,y=Math.sin(E)*(a?a/2:A),e.moveTo(n-v,s-u),e.lineTo(n+y,s-l),e.lineTo(n+v,s+u),e.lineTo(n-y,s+l),e.closePath();break;case"crossRot":E+=ns;case"cross":v=Math.cos(E)*(a?a/2:A),l=Math.cos(E)*A,u=Math.sin(E)*A,y=Math.sin(E)*(a?a/2:A),e.moveTo(n-v,s-u),e.lineTo(n+v,s+u),e.moveTo(n+y,s-l),e.lineTo(n-y,s+l);break;case"star":v=Math.cos(E)*(a?a/2:A),l=Math.cos(E)*A,u=Math.sin(E)*A,y=Math.sin(E)*(a?a/2:A),e.moveTo(n-v,s-u),e.lineTo(n+v,s+u),e.moveTo(n+y,s-l),e.lineTo(n-y,s+l),E+=ns,v=Math.cos(E)*(a?a/2:A),l=Math.cos(E)*A,u=Math.sin(E)*A,y=Math.sin(E)*(a?a/2:A),e.moveTo(n-v,s-u),e.lineTo(n+v,s+u),e.moveTo(n+y,s-l),e.lineTo(n-y,s+l);break;case"line":l=a?a/2:Math.cos(E)*A,u=Math.sin(E)*A,e.moveTo(n-l,s-u),e.lineTo(n+l,s+u);break;case"dash":e.moveTo(n,s),e.lineTo(n+Math.cos(E)*(a?a/2:A),s+Math.sin(E)*A);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function nn(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function eo(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function io(e){e.restore()}function Sl(e,t,n,s,a){if(!t)return e.lineTo(n.x,n.y);if(a==="middle"){let r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else a==="after"!=!!s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Pl(e,t,n,s){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function Dp(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Nt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function Rp(e,t,n,s,a){if(a.strikethrough||a.underline){let r=e.measureText(s),l=t-r.actualBoundingBoxLeft,u=t+r.actualBoundingBoxRight,f=n-r.actualBoundingBoxAscent,m=n+r.actualBoundingBoxDescent,_=a.strikethrough?(f+m)/2:m;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(l,_),e.lineTo(u,_),e.stroke()}}function zp(e,t){let n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Nn(e,t,n,s,a,r={}){let l=Jt(t)?t:[t],u=r.strokeWidth>0&&r.strokeColor!=="",f,m;for(e.save(),e.font=a.string,Dp(e,r),f=0;f<l.length;++f)m=l[f],r.backdrop&&zp(e,r.backdrop),u&&(r.strokeColor&&(e.strokeStyle=r.strokeColor),Nt(r.strokeWidth)||(e.lineWidth=r.strokeWidth),e.strokeText(m,n,s,r.maxWidth)),e.fillText(m,n,s,r.maxWidth),Rp(e,n,s,m,r),s+=Number(a.lineHeight);e.restore()}function Ts(e,t){let{x:n,y:s,w:a,h:r,radius:l}=t;e.arc(n+l.topLeft,s+l.topLeft,l.topLeft,-ce,ie,!0),e.lineTo(n,s+r-l.bottomLeft),e.arc(n+l.bottomLeft,s+r-l.bottomLeft,l.bottomLeft,ie,ce,!0),e.lineTo(n+a-l.bottomRight,s+r),e.arc(n+a-l.bottomRight,s+r-l.bottomRight,l.bottomRight,ce,0,!0),e.lineTo(n+a,s+l.topRight),e.arc(n+a-l.topRight,s+l.topRight,l.topRight,0,-ce,!0),e.lineTo(n+l.topLeft,s)}var Fp=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Np=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Wh(e,t){let n=(""+e).match(Fp);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}var Bp=e=>+e||0;function Ro(e,t){let n={},s=Ot(t),a=s?Object.keys(t):t,r=Ot(e)?s?l=>pt(e[l],e[t[l]]):l=>e[l]:()=>e;for(let l of a)n[l]=Bp(r(l));return n}function Qa(e){return Ro(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Bn(e){return Ro(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ze(e){let t=Qa(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function me(e,t){e=e||{},t=t||de.font;let n=pt(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let s=pt(e.style,t.style);s&&!(""+s).match(Np)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);let a={family:pt(e.family,t.family),lineHeight:Wh(pt(e.lineHeight,t.lineHeight),n),size:n,style:s,weight:pt(e.weight,t.weight),string:""};return a.string=Zh(a),a}function Ls(e,t,n,s){let a=!0,r,l,u;for(r=0,l=e.length;r<l;++r)if(u=e[r],u!==void 0&&(t!==void 0&&typeof u=="function"&&(u=u(t),a=!1),n!==void 0&&Jt(u)&&(u=u[n%u.length],a=!1),u!==void 0))return s&&!a&&(s.cacheable=!1),u}function Tl(e,t,n){let{min:s,max:a}=e,r=za(t,(a-s)/2),l=(u,f)=>n&&u===0?0:u+f;return{min:l(s,-Math.abs(r)),max:l(a,r)}}function _n(e,t){return Object.assign(Object.create(e),t)}function zo(e,t=[""],n,s,a=()=>e[0]){let r=n||e;typeof s>"u"&&(s=Yh("_fallback",e));let l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:r,_fallback:s,_getTarget:a,override:u=>zo([u,...e],t,r,s)};return new Proxy(l,{deleteProperty(u,f){return delete u[f],delete u._keys,delete e[0][f],!0},get(u,f){return Uh(u,f,()=>Yp(f,t,e,u))},getOwnPropertyDescriptor(u,f){return Reflect.getOwnPropertyDescriptor(u._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(u,f){return Ah(u).includes(f)},ownKeys(u){return Ah(u)},set(u,f,m){let _=u._storage||(u._storage=a());return u[f]=_[f]=m,delete u._keys,!0}})}function ss(e,t,n,s){let a={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:tr(e,s),setContext:r=>ss(e,r,n,s),override:r=>ss(e.override(r),t,n,s)};return new Proxy(a,{deleteProperty(r,l){return delete r[l],delete e[l],!0},get(r,l,u){return Uh(r,l,()=>Hp(r,l,u))},getOwnPropertyDescriptor(r,l){return r._descriptors.allKeys?Reflect.has(e,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,l)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(r,l){return Reflect.has(e,l)},ownKeys(){return Reflect.ownKeys(e)},set(r,l,u){return e[l]=u,delete r[l],!0}})}function tr(e,t={scriptable:!0,indexable:!0}){let{_scriptable:n=t.scriptable,_indexable:s=t.indexable,_allKeys:a=t.allKeys}=e;return{allKeys:a,scriptable:n,indexable:s,isScriptable:pn(n)?n:()=>n,isIndexable:pn(s)?s:()=>s}}var jp=(e,t)=>e?e+ko(t):t,Ll=(e,t)=>Ot(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Uh(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];let s=n();return e[t]=s,s}function Hp(e,t,n){let{_proxy:s,_context:a,_subProxy:r,_descriptors:l}=e,u=s[t];return pn(u)&&l.isScriptable(t)&&(u=Vp(t,u,e,n)),Jt(u)&&u.length&&(u=Zp(t,u,e,l.isIndexable)),Ll(t,u)&&(u=ss(u,a,r&&r[t],l)),u}function Vp(e,t,n,s){let{_proxy:a,_context:r,_subProxy:l,_stack:u}=n;if(u.has(e))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+e);u.add(e);let f=t(r,l||s);return u.delete(e),Ll(e,f)&&(f=Cl(a._scopes,a,e,f)),f}function Zp(e,t,n,s){let{_proxy:a,_context:r,_subProxy:l,_descriptors:u}=n;if(typeof r.index<"u"&&s(e))return t[r.index%t.length];if(Ot(t[0])){let f=t,m=a._scopes.filter(_=>_!==f);t=[];for(let _ of f){let v=Cl(m,a,e,_);t.push(ss(v,r,l&&l[e],u))}}return t}function qh(e,t,n){return pn(e)?e(t,n):e}var Wp=(e,t)=>e===!0?t:typeof e=="string"?gn(t,e):void 0;function Up(e,t,n,s,a){for(let r of t){let l=Wp(n,r);if(l){e.add(l);let u=qh(l._fallback,n,a);if(typeof u<"u"&&u!==n&&u!==s)return u}else if(l===!1&&typeof s<"u"&&n!==s)return null}return!1}function Cl(e,t,n,s){let a=t._rootScopes,r=qh(t._fallback,n,s),l=[...e,...a],u=new Set;u.add(s);let f=kh(u,l,n,r||n,s);return f===null||typeof r<"u"&&r!==n&&(f=kh(u,l,r,f,s),f===null)?!1:zo(Array.from(u),[""],a,r,()=>qp(t,n,s))}function kh(e,t,n,s,a){for(;n;)n=Up(e,t,n,s,a);return n}function qp(e,t,n){let s=e._getTarget();t in s||(s[t]={});let a=s[t];return Jt(a)&&Ot(n)?n:a||{}}function Yp(e,t,n,s){let a;for(let r of t)if(a=Yh(jp(r,e),n),typeof a<"u")return Ll(e,a)?Cl(n,s,e,a):a}function Yh(e,t){for(let n of t){if(!n)continue;let s=n[e];if(typeof s<"u")return s}}function Ah(e){let t=e._keys;return t||(t=e._keys=Xp(e._scopes)),t}function Xp(e){let t=new Set;for(let n of e)for(let s of Object.keys(n).filter(a=>!a.startsWith("_")))t.add(s);return Array.from(t)}function er(e,t,n,s){let{iScale:a}=e,{key:r="r"}=this._parsing,l=new Array(s),u,f,m,_;for(u=0,f=s;u<f;++u)m=u+n,_=t[m],l[u]={r:a.parse(gn(_,r),m)};return l}var Gp=Number.EPSILON||1e-14,Qs=(e,t)=>t<e.length&&!e[t].skip&&e[t],Xh=e=>e==="x"?"y":"x";function Gh(e,t,n,s){let a=e.skip?t:e,r=t,l=n.skip?t:n,u=Co(r,a),f=Co(l,r),m=u/(u+f),_=f/(u+f);m=isNaN(m)?0:m,_=isNaN(_)?0:_;let v=s*m,y=s*_;return{previous:{x:r.x-v*(l.x-a.x),y:r.y-v*(l.y-a.y)},next:{x:r.x+y*(l.x-a.x),y:r.y+y*(l.y-a.y)}}}function $p(e,t,n){let s=e.length,a,r,l,u,f,m=Qs(e,0);for(let _=0;_<s-1;++_)if(f=m,m=Qs(e,_+1),!(!f||!m)){if(Ms(t[_],0,Gp)){n[_]=n[_+1]=0;continue}a=n[_]/t[_],r=n[_+1]/t[_],u=Math.pow(a,2)+Math.pow(r,2),!(u<=9)&&(l=3/Math.sqrt(u),n[_]=a*l*t[_],n[_+1]=r*l*t[_])}}function Kp(e,t,n="x"){let s=Xh(n),a=e.length,r,l,u,f=Qs(e,0);for(let m=0;m<a;++m){if(l=u,u=f,f=Qs(e,m+1),!u)continue;let _=u[n],v=u[s];l&&(r=(_-l[n])/3,u[`cp1${n}`]=_-r,u[`cp1${s}`]=v-r*t[m]),f&&(r=(f[n]-_)/3,u[`cp2${n}`]=_+r,u[`cp2${s}`]=v+r*t[m])}}function $h(e,t="x"){let n=Xh(t),s=e.length,a=Array(s).fill(0),r=Array(s),l,u,f,m=Qs(e,0);for(l=0;l<s;++l)if(u=f,f=m,m=Qs(e,l+1),!!f){if(m){let _=m[t]-f[t];a[l]=_!==0?(m[n]-f[n])/_:0}r[l]=u?m?hi(a[l-1])!==hi(a[l])?0:(a[l-1]+a[l])/2:a[l-1]:a[l]}$p(e,a,r),Kp(e,r,t)}function Ia(e,t,n){return Math.max(Math.min(e,n),t)}function Jp(e,t){let n,s,a,r,l,u=nn(e[0],t);for(n=0,s=e.length;n<s;++n)l=r,r=u,u=n<s-1&&nn(e[n+1],t),r&&(a=e[n],l&&(a.cp1x=Ia(a.cp1x,t.left,t.right),a.cp1y=Ia(a.cp1y,t.top,t.bottom)),u&&(a.cp2x=Ia(a.cp2x,t.left,t.right),a.cp2y=Ia(a.cp2y,t.top,t.bottom)))}function kl(e,t,n,s,a){let r,l,u,f;if(t.spanGaps&&(e=e.filter(m=>!m.skip)),t.cubicInterpolationMode==="monotone")$h(e,a);else{let m=s?e[e.length-1]:e[0];for(r=0,l=e.length;r<l;++r)u=e[r],f=Gh(m,u,e[Math.min(r+1,l-(s?0:1))%l],t.tension),u.cp1x=f.previous.x,u.cp1y=f.previous.y,u.cp2x=f.next.x,u.cp2y=f.next.y,m=u}t.capBezierPoints&&Jp(e,n)}function ir(){return typeof window<"u"&&typeof document<"u"}function Fo(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Ra(e,t,n){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[n])):s=e,s}var nr=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function Kh(e,t){return nr(e).getPropertyValue(t)}var Qp=["top","right","bottom","left"];function bs(e,t,n){let s={};n=n?"-"+n:"";for(let a=0;a<4;a++){let r=Qp[a];s[r]=parseFloat(e[t+"-"+r+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}var tm=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function em(e,t){let n=e.touches,s=n&&n.length?n[0]:e,{offsetX:a,offsetY:r}=s,l=!1,u,f;if(tm(a,r,e.target))u=a,f=r;else{let m=t.getBoundingClientRect();u=s.clientX-m.left,f=s.clientY-m.top,l=!0}return{x:u,y:f,box:l}}function Li(e,t){if("native"in e)return e;let{canvas:n,currentDevicePixelRatio:s}=t,a=nr(n),r=a.boxSizing==="border-box",l=bs(a,"padding"),u=bs(a,"border","width"),{x:f,y:m,box:_}=em(e,n),v=l.left+(_&&u.left),y=l.top+(_&&u.top),{width:w,height:k}=t;return r&&(w-=l.width+u.width,k-=l.height+u.height),{x:Math.round((f-v)/w*n.width/s),y:Math.round((m-y)/k*n.height/s)}}function im(e,t,n){let s,a;if(t===void 0||n===void 0){let r=Fo(e);if(!r)t=e.clientWidth,n=e.clientHeight;else{let l=r.getBoundingClientRect(),u=nr(r),f=bs(u,"border","width"),m=bs(u,"padding");t=l.width-m.width-f.width,n=l.height-m.height-f.height,s=Ra(u.maxWidth,r,"clientWidth"),a=Ra(u.maxHeight,r,"clientHeight")}}return{width:t,height:n,maxWidth:s||Lo,maxHeight:a||Lo}}var Oa=e=>Math.round(e*10)/10;function Al(e,t,n,s){let a=nr(e),r=bs(a,"margin"),l=Ra(a.maxWidth,e,"clientWidth")||Lo,u=Ra(a.maxHeight,e,"clientHeight")||Lo,f=im(e,t,n),{width:m,height:_}=f;if(a.boxSizing==="content-box"){let y=bs(a,"border","width"),w=bs(a,"padding");m-=w.width+y.width,_-=w.height+y.height}return m=Math.max(0,m-r.width),_=Math.max(0,s?m/s:_-r.height),m=Oa(Math.min(m,l,f.maxWidth)),_=Oa(Math.min(_,u,f.maxHeight)),m&&!_&&(_=Oa(m/2)),(t!==void 0||n!==void 0)&&s&&f.height&&_>f.height&&(_=f.height,m=Oa(Math.floor(_*s))),{width:m,height:_}}function sr(e,t,n){let s=t||1,a=Math.floor(e.height*s),r=Math.floor(e.width*s);e.height=Math.floor(e.height),e.width=Math.floor(e.width);let l=e.canvas;return l.style&&(n||!l.style.height&&!l.style.width)&&(l.style.height=`${e.height}px`,l.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||l.height!==a||l.width!==r?(e.currentDevicePixelRatio=s,l.height=a,l.width=r,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}var El=function(){let e=!1;try{let t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}();function or(e,t){let n=Kh(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function zn(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Il(e,t,n,s){return{x:e.x+n*(t.x-e.x),y:s==="middle"?n<.5?e.y:t.y:s==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function Ol(e,t,n,s){let a={x:e.cp2x,y:e.cp2y},r={x:t.cp1x,y:t.cp1y},l=zn(e,a,n),u=zn(a,r,n),f=zn(r,t,n),m=zn(l,u,n),_=zn(u,f,n);return zn(m,_,n)}var nm=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},sm=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function rs(e,t,n){return e?nm(t,n):sm()}function ar(e,t){let n,s;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)}function rr(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Jh(e){return e==="angle"?{between:Ss,compare:jh,normalize:ci}:{between:on,compare:(t,n)=>t-n,normalize:t=>t}}function Eh({start:e,end:t,count:n,loop:s,style:a}){return{start:e%n,end:t%n,loop:s&&(t-e+1)%n===0,style:a}}function om(e,t,n){let{property:s,start:a,end:r}=n,{between:l,normalize:u}=Jh(s),f=t.length,{start:m,end:_,loop:v}=e,y,w;if(v){for(m+=f,_+=f,y=0,w=f;y<w&&l(u(t[m%f][s]),a,r);++y)m--,_--;m%=f,_%=f}return _<m&&(_+=f),{start:m,end:_,loop:v,style:e.style}}function lr(e,t,n){if(!n)return[e];let{property:s,start:a,end:r}=n,l=t.length,{compare:u,between:f,normalize:m}=Jh(s),{start:_,end:v,loop:y,style:w}=om(e,t,n),k=[],A=!1,E=null,D,z,V,W=()=>f(a,V,D)&&u(a,V)!==0,H=()=>u(r,D)===0||f(r,V,D),X=()=>A||W(),$=()=>!A||H();for(let G=_,B=_;G<=v;++G)z=t[G%l],!z.skip&&(D=m(z[s]),D!==V&&(A=f(D,a,r),E===null&&X()&&(E=u(D,a)===0?G:B),E!==null&&$()&&(k.push(Eh({start:E,end:G,loop:y,count:l,style:w})),E=null),B=G,V=D));return E!==null&&k.push(Eh({start:E,end:v,loop:y,count:l,style:w})),k}function cr(e,t){let n=[],s=e.segments;for(let a=0;a<s.length;a++){let r=lr(s[a],e.points,t);r.length&&n.push(...r)}return n}function am(e,t,n,s){let a=0,r=t-1;if(n&&!s)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,n&&(r+=a);r>a&&e[r%t].skip;)r--;return r%=t,{start:a,end:r}}function rm(e,t,n,s){let a=e.length,r=[],l=t,u=e[t],f;for(f=t+1;f<=n;++f){let m=e[f%a];m.skip||m.stop?u.skip||(s=!1,r.push({start:t%a,end:(f-1)%a,loop:s}),t=l=m.stop?f:null):(l=f,u.skip&&(t=f)),u=m}return l!==null&&r.push({start:t%a,end:l%a,loop:s}),r}function Dl(e,t){let n=e.points,s=e.options.spanGaps,a=n.length;if(!a)return[];let r=!!e._loop,{start:l,end:u}=am(n,a,r,s);if(s===!0)return Ih(e,[{start:l,end:u,loop:r}],n,t);let f=u<l?u+a:u,m=!!e._fullLoop&&l===0&&u===a-1;return Ih(e,rm(n,l,f,m),n,t)}function Ih(e,t,n,s){return!s||!s.setContext||!n?t:lm(e,t,n,s)}function lm(e,t,n,s){let a=e._chart.getContext(),r=Oh(e.options),{_datasetIndex:l,options:{spanGaps:u}}=e,f=n.length,m=[],_=r,v=t[0].start,y=v;function w(k,A,E,D){let z=u?-1:1;if(k!==A){for(k+=f;n[k%f].skip;)k-=z;for(;n[A%f].skip;)A+=z;k%f!==A%f&&(m.push({start:k%f,end:A%f,loop:E,style:D}),_=D,v=A%f)}}for(let k of t){v=u?v:k.start;let A=n[v%f],E;for(y=v+1;y<=k.end;y++){let D=n[y%f];E=Oh(s.setContext(_n(a,{type:"segment",p0:A,p1:D,p0DataIndex:(y-1)%f,p1DataIndex:y%f,datasetIndex:l}))),cm(E,_)&&w(v,y-1,k.loop,_),A=D,_=E}v<y-1&&w(v,y-1,k.loop,_)}return m}function Oh(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function cm(e,t){if(!t)return!1;let n=[],s=function(a,r){return Xa(r)?(n.includes(r)||n.push(r),n.indexOf(r)):r};return JSON.stringify(e,s)!==JSON.stringify(t,s)}var Wl=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,s,a){let r=n.listeners[a],l=n.duration;r.forEach(u=>u({chart:t,initial:n.initial,numSteps:l,currentStep:Math.min(s-n.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=Wa.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((s,a)=>{if(!s.running||!s.items.length)return;let r=s.items,l=r.length-1,u=!1,f;for(;l>=0;--l)f=r[l],f._active?(f._total>s.duration&&(s.duration=f._total),f.tick(t),u=!0):(r[l]=r[r.length-1],r.pop());u&&(a.draw(),this._notify(a,s,t,"progress")),r.length||(s.running=!1,this._notify(a,s,t,"complete"),s.initial=!1),n+=r.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){let n=this._charts,s=n.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,s)),s}listen(t,n,s){this._getAnims(t).listeners[n].push(s)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){let n=this._charts.get(t);!n||(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,a)=>Math.max(s,a._duration),0),this._refresh())}running(t){if(!this._running)return!1;let n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){let n=this._charts.get(t);if(!n||!n.items.length)return;let s=n.items,a=s.length-1;for(;a>=0;--a)s[a].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}},jn=new Wl,Qh="transparent",hm={boolean(e,t,n){return n>.5?t:e},color(e,t,n){let s=Ga(e||Qh),a=s.valid&&Ga(t||Qh);return a&&a.valid?a.mix(s,n).hexString():t},number(e,t,n){return e+(t-e)*n}},Ul=class{constructor(t,n,s,a){let r=n[s];a=Ls([t.to,a,r,t.from]);let l=Ls([t.from,r,a]);this._active=!0,this._fn=t.fn||hm[t.type||typeof l],this._easing=vs[t.easing]||vs.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=s,this._from=l,this._to=a,this._promises=void 0}active(){return this._active}update(t,n,s){if(this._active){this._notify(!1);let a=this._target[this._prop],r=s-this._start,l=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(l,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=Ls([t.to,n,a,t.from]),this._from=Ls([t.from,a,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){let n=t-this._start,s=this._duration,a=this._prop,r=this._from,l=this._loop,u=this._to,f;if(this._active=r!==u&&(l||n<s),!this._active){this._target[a]=u,this._notify(!0);return}if(n<0){this._target[a]=r;return}f=n/s%2,f=l&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[a]=this._fn(r,u,f)}wait(){let t=this._promises||(this._promises=[]);return new Promise((n,s)=>{t.push({res:n,rej:s})})}_notify(t){let n=t?"res":"rej",s=this._promises||[];for(let a=0;a<s.length;a++)s[a][n]()}},vr=class{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!Ot(t))return;let n=Object.keys(de.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(a=>{let r=t[a];if(!Ot(r))return;let l={};for(let u of n)l[u]=r[u];(Jt(r.properties)&&r.properties||[a]).forEach(u=>{(u===a||!s.has(u))&&s.set(u,l)})})}_animateOptions(t,n){let s=n.options,a=dm(t,s);if(!a)return[];let r=this._createAnimations(a,s);return s.$shared&&um(t.options.$animations,s).then(()=>{t.options=s},()=>{}),r}_createAnimations(t,n){let s=this._properties,a=[],r=t.$animations||(t.$animations={}),l=Object.keys(n),u=Date.now(),f;for(f=l.length-1;f>=0;--f){let m=l[f];if(m.charAt(0)==="$")continue;if(m==="options"){a.push(...this._animateOptions(t,n));continue}let _=n[m],v=r[m],y=s.get(m);if(v)if(y&&v.active()){v.update(y,_,u);continue}else v.cancel();if(!y||!y.duration){t[m]=_;continue}r[m]=v=new Ul(y,t,m,_),a.push(v)}return a}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}let s=this._createAnimations(t,n);if(s.length)return jn.add(this._chart,s),!0}};function um(e,t){let n=[],s=Object.keys(t);for(let a=0;a<s.length;a++){let r=e[s[a]];r&&r.active()&&n.push(r.wait())}return Promise.all(n)}function dm(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function tu(e,t){let n=e&&e.options||{},s=n.reverse,a=n.min===void 0?t:0,r=n.max===void 0?t:0;return{start:s?r:a,end:s?a:r}}function fm(e,t,n){if(n===!1)return!1;let s=tu(e,n),a=tu(t,n);return{top:a.end,right:s.end,bottom:a.start,left:s.start}}function pm(e){let t,n,s,a;return Ot(e)?(t=e.top,n=e.right,s=e.bottom,a=e.left):t=n=s=a=e,{top:t,right:n,bottom:s,left:a,disabled:e===!1}}function Ju(e,t){let n=[],s=e._getSortedDatasetMetas(t),a,r;for(a=0,r=s.length;a<r;++a)n.push(s[a].index);return n}function eu(e,t,n,s={}){let a=e.keys,r=s.mode==="single",l,u,f,m;if(t!==null){for(l=0,u=a.length;l<u;++l){if(f=+a[l],f===n){if(s.all)continue;break}m=e.values[f],he(m)&&(r||t===0||hi(t)===hi(m))&&(t+=m)}return t}}function mm(e){let t=Object.keys(e),n=new Array(t.length),s,a,r;for(s=0,a=t.length;s<a;++s)r=t[s],n[s]={x:r,y:e[r]};return n}function iu(e,t){let n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function gm(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function _m(e){let{min:t,max:n,minDefined:s,maxDefined:a}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}function vm(e,t,n){let s=e[t]||(e[t]={});return s[n]||(s[n]={})}function nu(e,t,n,s){for(let a of t.getMatchingVisibleMetas(s).reverse()){let r=e[a.index];if(n&&r>0||!n&&r<0)return a.index}return null}function su(e,t){let{chart:n,_cachedMeta:s}=e,a=n._stacks||(n._stacks={}),{iScale:r,vScale:l,index:u}=s,f=r.axis,m=l.axis,_=gm(r,l,s),v=t.length,y;for(let w=0;w<v;++w){let k=t[w],{[f]:A,[m]:E}=k,D=k._stacks||(k._stacks={});y=D[m]=vm(a,_,A),y[u]=E,y._top=nu(y,l,!0,s.type),y._bottom=nu(y,l,!1,s.type);let z=y._visualValues||(y._visualValues={});z[u]=E}}function Rl(e,t){let n=e.scales;return Object.keys(n).filter(s=>n[s].axis===t).shift()}function bm(e,t){return _n(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function ym(e,t,n){return _n(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function No(e,t){let n=e.controller.index,s=e.vScale&&e.vScale.axis;if(!!s){t=t||e._parsed;for(let a of t){let r=a._stacks;if(!r||r[s]===void 0||r[s][n]===void 0)return;delete r[s][n],r[s]._visualValues!==void 0&&r[s]._visualValues[n]!==void 0&&delete r[s]._visualValues[n]}}}var zl=e=>e==="reset"||e==="none",ou=(e,t)=>t?e:Object.assign({},e),xm=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:Ju(n,!0),values:null},Ci=class{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=iu(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&No(this._cachedMeta),this.index=t}linkScales(){let t=this.chart,n=this._cachedMeta,s=this.getDataset(),a=(v,y,w,k)=>v==="x"?y:v==="r"?k:w,r=n.xAxisID=pt(s.xAxisID,Rl(t,"x")),l=n.yAxisID=pt(s.yAxisID,Rl(t,"y")),u=n.rAxisID=pt(s.rAxisID,Rl(t,"r")),f=n.indexAxis,m=n.iAxisID=a(f,r,l,u),_=n.vAxisID=a(f,l,r,u);n.xScale=this.getScaleForId(r),n.yScale=this.getScaleForId(l),n.rScale=this.getScaleForId(u),n.iScale=this.getScaleForId(m),n.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){let n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){let t=this._cachedMeta;this._data&&Va(this._data,this),t._stacked&&No(t)}_dataCheck(){let t=this.getDataset(),n=t.data||(t.data=[]),s=this._data;if(Ot(n))this._data=mm(n);else if(s!==n){if(s){Va(s,this);let a=this._cachedMeta;No(a),a._parsed=[]}n&&Object.isExtensible(n)&&yl(n,this),this._syncList=[],this._data=n}}addElements(){let t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){let n=this._cachedMeta,s=this.getDataset(),a=!1;this._dataCheck();let r=n._stacked;n._stacked=iu(n.vScale,n),n.stack!==s.stack&&(a=!0,No(n),n.stack=s.stack),this._resyncElements(t),(a||r!==n._stacked)&&su(this,n._parsed)}configure(){let t=this.chart.config,n=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){let{_cachedMeta:s,_data:a}=this,{iScale:r,_stacked:l}=s,u=r.axis,f=t===0&&n===a.length?!0:s._sorted,m=t>0&&s._parsed[t-1],_,v,y;if(this._parsing===!1)s._parsed=a,s._sorted=!0,y=a;else{Jt(a[t])?y=this.parseArrayData(s,a,t,n):Ot(a[t])?y=this.parseObjectData(s,a,t,n):y=this.parsePrimitiveData(s,a,t,n);let w=()=>v[u]===null||m&&v[u]<m[u];for(_=0;_<n;++_)s._parsed[_+t]=v=y[_],f&&(w()&&(f=!1),m=v);s._sorted=f}l&&su(this,y)}parsePrimitiveData(t,n,s,a){let{iScale:r,vScale:l}=t,u=r.axis,f=l.axis,m=r.getLabels(),_=r===l,v=new Array(a),y,w,k;for(y=0,w=a;y<w;++y)k=y+s,v[y]={[u]:_||r.parse(m[k],k),[f]:l.parse(n[k],k)};return v}parseArrayData(t,n,s,a){let{xScale:r,yScale:l}=t,u=new Array(a),f,m,_,v;for(f=0,m=a;f<m;++f)_=f+s,v=n[_],u[f]={x:r.parse(v[0],_),y:l.parse(v[1],_)};return u}parseObjectData(t,n,s,a){let{xScale:r,yScale:l}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=new Array(a),_,v,y,w;for(_=0,v=a;_<v;++_)y=_+s,w=n[y],m[_]={x:r.parse(gn(w,u),y),y:l.parse(gn(w,f),y)};return m}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,s){let a=this.chart,r=this._cachedMeta,l=n[t.axis],u={keys:Ju(a,!0),values:n._stacks[t.axis]._visualValues};return eu(u,l,r.index,{mode:s})}updateRangeFromParsed(t,n,s,a){let r=s[n.axis],l=r===null?NaN:r,u=a&&s._stacks[n.axis];a&&u&&(a.values=u,l=eu(a,r,this._cachedMeta.index)),t.min=Math.min(t.min,l),t.max=Math.max(t.max,l)}getMinMax(t,n){let s=this._cachedMeta,a=s._parsed,r=s._sorted&&t===s.iScale,l=a.length,u=this._getOtherScale(t),f=xm(n,s,this.chart),m={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:v}=_m(u),y,w;function k(){w=a[y];let A=w[u.axis];return!he(w[t.axis])||_>A||v<A}for(y=0;y<l&&!(!k()&&(this.updateRangeFromParsed(m,t,w,f),r));++y);if(r){for(y=l-1;y>=0;--y)if(!k()){this.updateRangeFromParsed(m,t,w,f);break}}return m}getAllParsedValues(t){let n=this._cachedMeta._parsed,s=[],a,r,l;for(a=0,r=n.length;a<r;++a)l=n[a][t.axis],he(l)&&s.push(l);return s}getMaxOverflow(){return!1}getLabelAndValue(t){let n=this._cachedMeta,s=n.iScale,a=n.vScale,r=this.getParsed(t);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:a?""+a.getLabelForValue(r[a.axis]):""}}_update(t){let n=this._cachedMeta;this.update(t||"default"),n._clip=pm(pt(this.options.clip,fm(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){let t=this._ctx,n=this.chart,s=this._cachedMeta,a=s.data||[],r=n.chartArea,l=[],u=this._drawStart||0,f=this._drawCount||a.length-u,m=this.options.drawActiveElementsOnTop,_;for(s.dataset&&s.dataset.draw(t,r,u,f),_=u;_<u+f;++_){let v=a[_];v.hidden||(v.active&&m?l.push(v):v.draw(t,r))}for(_=0;_<l.length;++_)l[_].draw(t,r)}getStyle(t,n){let s=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,n,s){let a=this.getDataset(),r;if(t>=0&&t<this._cachedMeta.data.length){let l=this._cachedMeta.data[t];r=l.$context||(l.$context=ym(this.getContext(),t,l)),r.parsed=this.getParsed(t),r.raw=a.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=bm(this.chart.getContext(),this.index)),r.dataset=a,r.index=r.datasetIndex=this.index;return r.active=!!n,r.mode=s,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",s){let a=n==="active",r=this._cachedDataOpts,l=t+"-"+n,u=r[l],f=this.enableOptionSharing&&ws(s);if(u)return ou(u,f);let m=this.chart.config,_=m.datasetElementScopeKeys(this._type,t),v=a?[`${t}Hover`,"hover",t,""]:[t,""],y=m.getOptionScopes(this.getDataset(),_),w=Object.keys(de.elements[t]),k=()=>this.getContext(s,a,n),A=m.resolveNamedOptions(y,w,k,v);return A.$shared&&(A.$shared=f,r[l]=Object.freeze(ou(A,f))),A}_resolveAnimations(t,n,s){let a=this.chart,r=this._cachedDataOpts,l=`animation-${n}`,u=r[l];if(u)return u;let f;if(a.options.animation!==!1){let _=this.chart.config,v=_.datasetAnimationScopeKeys(this._type,n),y=_.getOptionScopes(this.getDataset(),v);f=_.createResolver(y,this.getContext(t,s,n))}let m=new vr(a,f&&f.animations);return f&&f._cacheable&&(r[l]=Object.freeze(m)),m}getSharedOptions(t){if(!!t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||zl(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){let s=this.resolveDataElementOptions(t,n),a=this._sharedOptions,r=this.getSharedOptions(s),l=this.includeOptions(n,r)||r!==a;return this.updateSharedOptions(r,n,s),{sharedOptions:r,includeOptions:l}}updateElement(t,n,s,a){zl(a)?Object.assign(t,s):this._resolveAnimations(n,a).update(t,s)}updateSharedOptions(t,n,s){t&&!zl(n)&&this._resolveAnimations(void 0,n).update(t,s)}_setStyle(t,n,s,a){t.active=a;let r=this.getStyle(n,a);this._resolveAnimations(n,s,a).update(t,{options:!a&&this.getSharedOptions(r)||r})}removeHoverStyle(t,n,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,n,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){let t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){let n=this._data,s=this._cachedMeta.data;for(let[u,f,m]of this._syncList)this[u](f,m);this._syncList=[];let a=s.length,r=n.length,l=Math.min(r,a);l&&this.parse(0,l),r>a?this._insertElements(a,r-a,t):r<a&&this._removeElements(r,a-r)}_insertElements(t,n,s=!0){let a=this._cachedMeta,r=a.data,l=t+n,u,f=m=>{for(m.length+=n,u=m.length-1;u>=l;u--)m[u]=m[u-n]};for(f(r),u=t;u<l;++u)r[u]=new this.dataElementType;this._parsing&&f(a._parsed),this.parse(t,n),s&&this.updateElements(r,t,n,"reset")}updateElements(t,n,s,a){}_removeElements(t,n){let s=this._cachedMeta;if(this._parsing){let a=s._parsed.splice(t,n);s._stacked&&No(s,a)}s.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{let[n,s,a]=t;this[n](s,a)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){let t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);let s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}};st(Ci,"defaults",{}),st(Ci,"datasetElementType",null),st(Ci,"dataElementType",null);function wm(e,t){if(!e._cache.$bar){let n=e.getMatchingVisibleMetas(t),s=[];for(let a=0,r=n.length;a<r;a++)s=s.concat(n[a].controller.getAllParsedValues(e));e._cache.$bar=Za(s.sort((a,r)=>a-r))}return e._cache.$bar}function Mm(e){let t=e.iScale,n=wm(t,e.type),s=t._length,a,r,l,u,f=()=>{l===32767||l===-32768||(ws(u)&&(s=Math.min(s,Math.abs(l-u)||s)),u=l)};for(a=0,r=n.length;a<r;++a)l=t.getPixelForValue(n[a]),f();for(u=void 0,a=0,r=t.ticks.length;a<r;++a)l=t.getPixelForTick(a),f();return s}function Sm(e,t,n,s){let a=n.barThickness,r,l;return Nt(a)?(r=t.min*n.categoryPercentage,l=n.barPercentage):(r=a*s,l=1),{chunk:r/s,ratio:l,start:t.pixels[e]-r/2}}function Pm(e,t,n,s){let a=t.pixels,r=a[e],l=e>0?a[e-1]:null,u=e<a.length-1?a[e+1]:null,f=n.categoryPercentage;l===null&&(l=r-(u===null?t.end-t.start:u-r)),u===null&&(u=r+r-l);let m=r-(r-Math.min(l,u))/2*f;return{chunk:Math.abs(u-l)/2*f/s,ratio:n.barPercentage,start:m}}function Tm(e,t,n,s){let a=n.parse(e[0],s),r=n.parse(e[1],s),l=Math.min(a,r),u=Math.max(a,r),f=l,m=u;Math.abs(l)>Math.abs(u)&&(f=u,m=l),t[n.axis]=m,t._custom={barStart:f,barEnd:m,start:a,end:r,min:l,max:u}}function Qu(e,t,n,s){return Jt(e)?Tm(e,t,n,s):t[n.axis]=n.parse(e,s),t}function au(e,t,n,s){let a=e.iScale,r=e.vScale,l=a.getLabels(),u=a===r,f=[],m,_,v,y;for(m=n,_=n+s;m<_;++m)y=t[m],v={},v[a.axis]=u||a.parse(l[m],m),f.push(Qu(y,v,r,m));return f}function Fl(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Lm(e,t,n){return e!==0?hi(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function Cm(e){let t,n,s,a,r;return e.horizontal?(t=e.base>e.x,n="left",s="right"):(t=e.base<e.y,n="bottom",s="top"),t?(a="end",r="start"):(a="start",r="end"),{start:n,end:s,reverse:t,top:a,bottom:r}}function km(e,t,n,s){let a=t.borderSkipped,r={};if(!a){e.borderSkipped=r;return}if(a===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:l,end:u,reverse:f,top:m,bottom:_}=Cm(e);a==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===s?a=m:(n._bottom||0)===s?a=_:(r[ru(_,l,u,f)]=!0,a=m)),r[ru(a,l,u,f)]=!0,e.borderSkipped=r}function ru(e,t,n,s){return s?(e=Am(e,t,n),e=lu(e,n,t)):e=lu(e,t,n),e}function Am(e,t,n){return e===t?n:e===n?t:e}function lu(e,t,n){return e==="start"?t:e==="end"?n:e}function Em(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}var so=class extends Ci{parsePrimitiveData(t,n,s,a){return au(t,n,s,a)}parseArrayData(t,n,s,a){return au(t,n,s,a)}parseObjectData(t,n,s,a){let{iScale:r,vScale:l}=t,{xAxisKey:u="x",yAxisKey:f="y"}=this._parsing,m=r.axis==="x"?u:f,_=l.axis==="x"?u:f,v=[],y,w,k,A;for(y=s,w=s+a;y<w;++y)A=n[y],k={},k[r.axis]=r.parse(gn(A,m),y),v.push(Qu(gn(A,_),k,l,y));return v}updateRangeFromParsed(t,n,s,a){super.updateRangeFromParsed(t,n,s,a);let r=s._custom;r&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){let n=this._cachedMeta,{iScale:s,vScale:a}=n,r=this.getParsed(t),l=r._custom,u=Fl(l)?"["+l.start+", "+l.end+"]":""+a.getLabelForValue(r[a.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();let t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){let n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,s,a){let r=a==="reset",{index:l,_cachedMeta:{vScale:u}}=this,f=u.getBasePixel(),m=u.isHorizontal(),_=this._getRuler(),{sharedOptions:v,includeOptions:y}=this._getSharedOptions(n,a);for(let w=n;w<n+s;w++){let k=this.getParsed(w),A=r||Nt(k[u.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),E=this._calculateBarIndexPixels(w,_),D=(k._stacks||{})[u.axis],z={horizontal:m,base:A.base,enableBorderRadius:!D||Fl(k._custom)||l===D._top||l===D._bottom,x:m?A.head:E.center,y:m?E.center:A.head,height:m?E.size:Math.abs(A.size),width:m?Math.abs(A.size):E.size};y&&(z.options=v||this.resolveDataElementOptions(w,t[w].active?"active":a));let V=z.options||t[w].options;km(z,V,D,l),Em(z,V,_.ratio),this.updateElement(t[w],w,z,a)}}_getStacks(t,n){let{iScale:s}=this._cachedMeta,a=s.getMatchingVisibleMetas(this._type).filter(f=>f.controller.options.grouped),r=s.options.stacked,l=[],u=f=>{let m=f.controller.getParsed(n),_=m&&m[f.vScale.axis];if(Nt(_)||isNaN(_))return!0};for(let f of a)if(!(n!==void 0&&u(f))&&((r===!1||l.indexOf(f.stack)===-1||r===void 0&&f.stack===void 0)&&l.push(f.stack),f.index===t))break;return l.length||l.push(void 0),l}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,s){let a=this._getStacks(t,s),r=n!==void 0?a.indexOf(n):-1;return r===-1?a.length-1:r}_getRuler(){let t=this.options,n=this._cachedMeta,s=n.iScale,a=[],r,l;for(r=0,l=n.data.length;r<l;++r)a.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));let u=t.barThickness;return{min:u||Mm(n),pixels:a,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:u?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){let{_cachedMeta:{vScale:n,_stacked:s,index:a},options:{base:r,minBarLength:l}}=this,u=r||0,f=this.getParsed(t),m=f._custom,_=Fl(m),v=f[n.axis],y=0,w=s?this.applyStack(n,f,s):v,k,A;w!==v&&(y=w-v,w=v),_&&(v=m.barStart,w=m.barEnd-m.barStart,v!==0&&hi(v)!==hi(m.barEnd)&&(y=0),y+=v);let E=!Nt(r)&&!_?r:y,D=n.getPixelForValue(E);if(this.chart.getDataVisibility(t)?k=n.getPixelForValue(y+w):k=D,A=k-D,Math.abs(A)<l){A=Lm(A,n,u)*l,v===u&&(D-=A/2);let z=n.getPixelForDecimal(0),V=n.getPixelForDecimal(1),W=Math.min(z,V),H=Math.max(z,V);D=Math.max(Math.min(D,H),W),k=D+A,s&&!_&&(f._stacks[n.axis]._visualValues[a]=n.getValueForPixel(k)-n.getValueForPixel(D))}if(D===n.getPixelForValue(u)){let z=hi(A)*n.getLineWidthForValue(u)/2;D+=z,A-=z}return{size:A,base:D,head:k,center:k+A/2}}_calculateBarIndexPixels(t,n){let s=n.scale,a=this.options,r=a.skipNull,l=pt(a.maxBarThickness,1/0),u,f;if(n.grouped){let m=r?this._getStackCount(t):n.stackCount,_=a.barThickness==="flex"?Pm(t,n,a,m):Sm(t,n,a,m),v=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);u=_.start+_.chunk*v+_.chunk/2,f=Math.min(l,_.chunk*_.ratio)}else u=s.getPixelForValue(this.getParsed(t)[s.axis],t),f=Math.min(l,n.min*n.ratio);return{base:u-f/2,head:u+f/2,center:u,size:f}}draw(){let t=this._cachedMeta,n=t.vScale,s=t.data,a=s.length,r=0;for(;r<a;++r)this.getParsed(r)[n.axis]!==null&&s[r].draw(this._ctx)}};st(so,"id","bar"),st(so,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),st(so,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});var oo=class extends Ci{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,s,a){let r=super.parsePrimitiveData(t,n,s,a);for(let l=0;l<r.length;l++)r[l]._custom=this.resolveDataElementOptions(l+s).radius;return r}parseArrayData(t,n,s,a){let r=super.parseArrayData(t,n,s,a);for(let l=0;l<r.length;l++){let u=n[s+l];r[l]._custom=pt(u[2],this.resolveDataElementOptions(l+s).radius)}return r}parseObjectData(t,n,s,a){let r=super.parseObjectData(t,n,s,a);for(let l=0;l<r.length;l++){let u=n[s+l];r[l]._custom=pt(u&&u.r&&+u.r,this.resolveDataElementOptions(l+s).radius)}return r}getMaxOverflow(){let t=this._cachedMeta.data,n=0;for(let s=t.length-1;s>=0;--s)n=Math.max(n,t[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(t){let n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:a,yScale:r}=n,l=this.getParsed(t),u=a.getLabelForValue(l.x),f=r.getLabelForValue(l.y),m=l._custom;return{label:s[t]||"",value:"("+u+", "+f+(m?", "+m:"")+")"}}update(t){let n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,s,a){let r=a==="reset",{iScale:l,vScale:u}=this._cachedMeta,{sharedOptions:f,includeOptions:m}=this._getSharedOptions(n,a),_=l.axis,v=u.axis;for(let y=n;y<n+s;y++){let w=t[y],k=!r&&this.getParsed(y),A={},E=A[_]=r?l.getPixelForDecimal(.5):l.getPixelForValue(k[_]),D=A[v]=r?u.getBasePixel():u.getPixelForValue(k[v]);A.skip=isNaN(E)||isNaN(D),m&&(A.options=f||this.resolveDataElementOptions(y,w.active?"active":a),r&&(A.options.radius=0)),this.updateElement(w,y,A,a)}}resolveDataElementOptions(t,n){let s=this.getParsed(t),a=super.resolveDataElementOptions(t,n);a.$shared&&(a=Object.assign({},a,{$shared:!1}));let r=a.radius;return n!=="active"&&(a.radius=0),a.radius+=pt(s&&s._custom,r),a}};st(oo,"id","bubble"),st(oo,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),st(oo,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function Im(e,t,n){let s=1,a=1,r=0,l=0;if(t<Qt){let u=e,f=u+t,m=Math.cos(u),_=Math.sin(u),v=Math.cos(f),y=Math.sin(f),w=(V,W,H)=>Ss(V,u,f,!0)?1:Math.max(W,W*n,H,H*n),k=(V,W,H)=>Ss(V,u,f,!0)?-1:Math.min(W,W*n,H,H*n),A=w(0,m,v),E=w(ce,_,y),D=k(ie,m,v),z=k(ie+ce,_,y);s=(A-D)/2,a=(E-z)/2,r=-(A+D)/2,l=-(E+z)/2}return{ratioX:s,ratioY:a,offsetX:r,offsetY:l}}var Vn=class extends Ci{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){let s=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=s;else{let r=f=>+s[f];if(Ot(s[t])){let{key:f="value"}=this._parsing;r=m=>+gn(s[m],f)}let l,u;for(l=t,u=t+n;l<u;++l)a._parsed[l]=r(l)}}_getRotation(){return Ti(this.options.rotation-90)}_getCircumference(){return Ti(this.options.circumference)}_getRotationExtents(){let t=Qt,n=-Qt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){let a=this.chart.getDatasetMeta(s).controller,r=a._getRotation(),l=a._getCircumference();t=Math.min(t,r),n=Math.max(n,r+l)}return{rotation:t,circumference:n-t}}update(t){let n=this.chart,{chartArea:s}=n,a=this._cachedMeta,r=a.data,l=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-l)/2,0),f=Math.min(fl(this.options.cutout,u),1),m=this._getRingWeight(this.index),{circumference:_,rotation:v}=this._getRotationExtents(),{ratioX:y,ratioY:w,offsetX:k,offsetY:A}=Im(v,_,f),E=(s.width-l)/y,D=(s.height-l)/w,z=Math.max(Math.min(E,D)/2,0),V=za(this.options.radius,z),W=Math.max(V*f,0),H=(V-W)/this._getVisibleDatasetWeightTotal();this.offsetX=k*V,this.offsetY=A*V,a.total=this.calculateTotal(),this.outerRadius=V-H*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-H*m,0),this.updateElements(r,0,r.length,t)}_circumference(t,n){let s=this.options,a=this._cachedMeta,r=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||a._parsed[t]===null||a.data[t].hidden?0:this.calculateCircumference(a._parsed[t]*r/Qt)}updateElements(t,n,s,a){let r=a==="reset",l=this.chart,u=l.chartArea,m=l.options.animation,_=(u.left+u.right)/2,v=(u.top+u.bottom)/2,y=r&&m.animateScale,w=y?0:this.innerRadius,k=y?0:this.outerRadius,{sharedOptions:A,includeOptions:E}=this._getSharedOptions(n,a),D=this._getRotation(),z;for(z=0;z<n;++z)D+=this._circumference(z,r);for(z=n;z<n+s;++z){let V=this._circumference(z,r),W=t[z],H={x:_+this.offsetX,y:v+this.offsetY,startAngle:D,endAngle:D+V,circumference:V,outerRadius:k,innerRadius:w};E&&(H.options=A||this.resolveDataElementOptions(z,W.active?"active":a)),D+=V,this.updateElement(W,z,H,a)}}calculateTotal(){let t=this._cachedMeta,n=t.data,s=0,a;for(a=0;a<n.length;a++){let r=t._parsed[a];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(a)&&!n[a].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(t){let n=this._cachedMeta.total;return n>0&&!isNaN(t)?Qt*(Math.abs(t)/n):0}getLabelAndValue(t){let n=this._cachedMeta,s=this.chart,a=s.data.labels||[],r=Ps(n._parsed[t],s.options.locale);return{label:a[t]||"",value:r}}getMaxBorderWidth(t){let n=0,s=this.chart,a,r,l,u,f;if(!t){for(a=0,r=s.data.datasets.length;a<r;++a)if(s.isDatasetVisible(a)){l=s.getDatasetMeta(a),t=l.data,u=l.controller;break}}if(!t)return 0;for(a=0,r=t.length;a<r;++a)f=u.resolveDataElementOptions(a),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let s=0,a=t.length;s<a;++s){let r=this.resolveDataElementOptions(s);n=Math.max(n,r.offset||0,r.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(t){return Math.max(pt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}};st(Vn,"id","doughnut"),st(Vn,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),st(Vn,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),st(Vn,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let n=t.data;if(n.labels.length&&n.datasets.length){let{labels:{pointStyle:s,color:a}}=t.legend.options;return n.labels.map((r,l)=>{let f=t.getDatasetMeta(0).controller.getStyle(l);return{text:r,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:a,lineWidth:f.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}});var ao=class extends Ci{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){let n=this._cachedMeta,{dataset:s,data:a=[],_dataset:r}=n,l=this.chart._animationsDisabled,{start:u,count:f}=qa(n,a,l);this._drawStart=u,this._drawCount=f,Ya(n)&&(u=0,f=a.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=a;let m=this.resolveDatasetElementOptions(t);this.options.showLine||(m.borderWidth=0),m.segment=this.options.segment,this.updateElement(s,void 0,{animated:!l,options:m},t),this.updateElements(a,u,f,t)}updateElements(t,n,s,a){let r=a==="reset",{iScale:l,vScale:u,_stacked:f,_dataset:m}=this._cachedMeta,{sharedOptions:_,includeOptions:v}=this._getSharedOptions(n,a),y=l.axis,w=u.axis,{spanGaps:k,segment:A}=this.options,E=os(k)?k:Number.POSITIVE_INFINITY,D=this.chart._animationsDisabled||r||a==="none",z=n+s,V=t.length,W=n>0&&this.getParsed(n-1);for(let H=0;H<V;++H){let X=t[H],$=D?X:{};if(H<n||H>=z){$.skip=!0;continue}let G=this.getParsed(H),B=Nt(G[w]),ot=$[y]=l.getPixelForValue(G[y],H),ut=$[w]=r||B?u.getBasePixel():u.getPixelForValue(f?this.applyStack(u,G,f):G[w],H);$.skip=isNaN(ot)||isNaN(ut)||B,$.stop=H>0&&Math.abs(G[y]-W[y])>E,A&&($.parsed=G,$.raw=m.data[H]),v&&($.options=_||this.resolveDataElementOptions(H,X.active?"active":a)),D||this.updateElement(X,H,$,a),W=G}}getMaxOverflow(){let t=this._cachedMeta,n=t.dataset,s=n.options&&n.options.borderWidth||0,a=t.data||[];if(!a.length)return s;let r=a[0].size(this.resolveDataElementOptions(0)),l=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,r,l)/2}draw(){let t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}};st(ao,"id","line"),st(ao,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),st(ao,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});var Is=class extends Ci{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){let n=this._cachedMeta,s=this.chart,a=s.data.labels||[],r=Ps(n._parsed[t].r,s.options.locale);return{label:a[t]||"",value:r}}parseObjectData(t,n,s,a){return er.bind(this)(t,n,s,a)}update(t){let n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){let t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,a)=>{let r=this.getParsed(a).r;!isNaN(r)&&this.chart.getDataVisibility(a)&&(r<n.min&&(n.min=r),r>n.max&&(n.max=r))}),n}_updateRadius(){let t=this.chart,n=t.chartArea,s=t.options,a=Math.min(n.right-n.left,n.bottom-n.top),r=Math.max(a/2,0),l=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),u=(r-l)/t.getVisibleDatasetCount();this.outerRadius=r-u*this.index,this.innerRadius=this.outerRadius-u}updateElements(t,n,s,a){let r=a==="reset",l=this.chart,f=l.options.animation,m=this._cachedMeta.rScale,_=m.xCenter,v=m.yCenter,y=m.getIndexAngle(0)-.5*ie,w=y,k,A=360/this.countVisibleElements();for(k=0;k<n;++k)w+=this._computeAngle(k,a,A);for(k=n;k<n+s;k++){let E=t[k],D=w,z=w+this._computeAngle(k,a,A),V=l.getDataVisibility(k)?m.getDistanceFromCenterForValue(this.getParsed(k).r):0;w=z,r&&(f.animateScale&&(V=0),f.animateRotate&&(D=z=y));let W={x:_,y:v,innerRadius:0,outerRadius:V,startAngle:D,endAngle:z,options:this.resolveDataElementOptions(k,E.active?"active":a)};this.updateElement(E,k,W,a)}}countVisibleElements(){let t=this._cachedMeta,n=0;return t.data.forEach((s,a)=>{!isNaN(this.getParsed(a).r)&&this.chart.getDataVisibility(a)&&n++}),n}_computeAngle(t,n,s){return this.chart.getDataVisibility(t)?Ti(this.resolveDataElementOptions(t,n).angle||s):0}};st(Is,"id","polarArea"),st(Is,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),st(Is,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){let n=t.data;if(n.labels.length&&n.datasets.length){let{labels:{pointStyle:s,color:a}}=t.legend.options;return n.labels.map((r,l)=>{let f=t.getDatasetMeta(0).controller.getStyle(l);return{text:r,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:a,lineWidth:f.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});var Zo=class extends Vn{};st(Zo,"id","pie"),st(Zo,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});var ro=class extends Ci{getLabelAndValue(t){let n=this._cachedMeta.vScale,s=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(t,n,s,a){return er.bind(this)(t,n,s,a)}update(t){let n=this._cachedMeta,s=n.dataset,a=n.data||[],r=n.iScale.getLabels();if(s.points=a,t!=="resize"){let l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0);let u={_loop:!0,_fullLoop:r.length===a.length,options:l};this.updateElement(s,void 0,u,t)}this.updateElements(a,0,a.length,t)}updateElements(t,n,s,a){let r=this._cachedMeta.rScale,l=a==="reset";for(let u=n;u<n+s;u++){let f=t[u],m=this.resolveDataElementOptions(u,f.active?"active":a),_=r.getPointPositionForValue(u,this.getParsed(u).r),v=l?r.xCenter:_.x,y=l?r.yCenter:_.y,w={x:v,y,angle:_.angle,skip:isNaN(v)||isNaN(y),options:m};this.updateElement(f,u,w,a)}}};st(ro,"id","radar"),st(ro,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),st(ro,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});var lo=class extends Ci{getLabelAndValue(t){let n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:a,yScale:r}=n,l=this.getParsed(t),u=a.getLabelForValue(l.x),f=r.getLabelForValue(l.y);return{label:s[t]||"",value:"("+u+", "+f+")"}}update(t){let n=this._cachedMeta,{data:s=[]}=n,a=this.chart._animationsDisabled,{start:r,count:l}=qa(n,s,a);if(this._drawStart=r,this._drawCount=l,Ya(n)&&(r=0,l=s.length),this.options.showLine){let{dataset:u,_dataset:f}=n;u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!f._decimated,u.points=s;let m=this.resolveDatasetElementOptions(t);m.segment=this.options.segment,this.updateElement(u,void 0,{animated:!a,options:m},t)}this.updateElements(s,r,l,t)}addElements(){let{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,n,s,a){let r=a==="reset",{iScale:l,vScale:u,_stacked:f,_dataset:m}=this._cachedMeta,_=this.resolveDataElementOptions(n,a),v=this.getSharedOptions(_),y=this.includeOptions(a,v),w=l.axis,k=u.axis,{spanGaps:A,segment:E}=this.options,D=os(A)?A:Number.POSITIVE_INFINITY,z=this.chart._animationsDisabled||r||a==="none",V=n>0&&this.getParsed(n-1);for(let W=n;W<n+s;++W){let H=t[W],X=this.getParsed(W),$=z?H:{},G=Nt(X[k]),B=$[w]=l.getPixelForValue(X[w],W),ot=$[k]=r||G?u.getBasePixel():u.getPixelForValue(f?this.applyStack(u,X,f):X[k],W);$.skip=isNaN(B)||isNaN(ot)||G,$.stop=W>0&&Math.abs(X[w]-V[w])>D,E&&($.parsed=X,$.raw=m.data[W]),y&&($.options=v||this.resolveDataElementOptions(W,H.active?"active":a)),z||this.updateElement(H,W,$,a),V=X}this.updateSharedOptions(v,a,_)}getMaxOverflow(){let t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let u=0;for(let f=n.length-1;f>=0;--f)u=Math.max(u,n[f].size(this.resolveDataElementOptions(f))/2);return u>0&&u}let s=t.dataset,a=s.options&&s.options.borderWidth||0;if(!n.length)return a;let r=n[0].size(this.resolveDataElementOptions(0)),l=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(a,r,l)/2}};st(lo,"id","scatter"),st(lo,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),st(lo,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Om=Object.freeze({__proto__:null,BarController:so,BubbleController:oo,DoughnutController:Vn,LineController:ao,PieController:Zo,PolarAreaController:Is,RadarController:ro,ScatterController:lo});function Cs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var Ko=class{static override(t){Object.assign(Ko.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Cs()}parse(){return Cs()}format(){return Cs()}add(){return Cs()}diff(){return Cs()}startOf(){return Cs()}endOf(){return Cs()}},Dm={_date:Ko};function Rm(e,t,n,s){let{controller:a,data:r,_sorted:l}=e,u=a._cachedMeta.iScale;if(u&&t===u.axis&&t!=="r"&&l&&r.length){let f=u._reversePixels?vl:en;if(s){if(a._sharedOptions){let m=r[0],_=typeof m.getRange=="function"&&m.getRange(t);if(_){let v=f(r,t,n-_),y=f(r,t,n+_);return{lo:v.lo,hi:y.hi}}}}else return f(r,t,n)}return{lo:0,hi:r.length-1}}function ea(e,t,n,s,a){let r=e.getSortedVisibleDatasetMetas(),l=n[t];for(let u=0,f=r.length;u<f;++u){let{index:m,data:_}=r[u],{lo:v,hi:y}=Rm(r[u],t,l,a);for(let w=v;w<=y;++w){let k=_[w];k.skip||s(k,m,w)}}}function zm(e){let t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(s,a){let r=t?Math.abs(s.x-a.x):0,l=n?Math.abs(s.y-a.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(l,2))}}function Nl(e,t,n,s,a){let r=[];return!a&&!e.isPointInArea(t)||ea(e,n,t,function(u,f,m){!a&&!nn(u,e.chartArea,0)||u.inRange(t.x,t.y,s)&&r.push({element:u,datasetIndex:f,index:m})},!0),r}function Fm(e,t,n,s){let a=[];function r(l,u,f){let{startAngle:m,endAngle:_}=l.getProps(["startAngle","endAngle"],s),{angle:v}=Ha(l,{x:t.x,y:t.y});Ss(v,m,_)&&a.push({element:l,datasetIndex:u,index:f})}return ea(e,n,t,r),a}function Nm(e,t,n,s,a,r){let l=[],u=zm(n),f=Number.POSITIVE_INFINITY;function m(_,v,y){let w=_.inRange(t.x,t.y,a);if(s&&!w)return;let k=_.getCenterPoint(a);if(!(!!r||e.isPointInArea(k))&&!w)return;let E=u(t,k);E<f?(l=[{element:_,datasetIndex:v,index:y}],f=E):E===f&&l.push({element:_,datasetIndex:v,index:y})}return ea(e,n,t,m),l}function Bl(e,t,n,s,a,r){return!r&&!e.isPointInArea(t)?[]:n==="r"&&!s?Fm(e,t,n,a):Nm(e,t,n,s,a,r)}function cu(e,t,n,s,a){let r=[],l=n==="x"?"inXRange":"inYRange",u=!1;return ea(e,n,t,(f,m,_)=>{f[l](t[n],a)&&(r.push({element:f,datasetIndex:m,index:_}),u=u||f.inRange(t.x,t.y,a))}),s&&!u?[]:r}var Bm={evaluateInteractionItems:ea,modes:{index(e,t,n,s){let a=Li(t,e),r=n.axis||"x",l=n.includeInvisible||!1,u=n.intersect?Nl(e,a,r,s,l):Bl(e,a,r,!1,s,l),f=[];return u.length?(e.getSortedVisibleDatasetMetas().forEach(m=>{let _=u[0].index,v=m.data[_];v&&!v.skip&&f.push({element:v,datasetIndex:m.index,index:_})}),f):[]},dataset(e,t,n,s){let a=Li(t,e),r=n.axis||"xy",l=n.includeInvisible||!1,u=n.intersect?Nl(e,a,r,s,l):Bl(e,a,r,!1,s,l);if(u.length>0){let f=u[0].datasetIndex,m=e.getDatasetMeta(f).data;u=[];for(let _=0;_<m.length;++_)u.push({element:m[_],datasetIndex:f,index:_})}return u},point(e,t,n,s){let a=Li(t,e),r=n.axis||"xy",l=n.includeInvisible||!1;return Nl(e,a,r,s,l)},nearest(e,t,n,s){let a=Li(t,e),r=n.axis||"xy",l=n.includeInvisible||!1;return Bl(e,a,r,n.intersect,s,l)},x(e,t,n,s){let a=Li(t,e);return cu(e,a,"x",n.intersect,s)},y(e,t,n,s){let a=Li(t,e);return cu(e,a,"y",n.intersect,s)}}},td=["left","top","right","bottom"];function Bo(e,t){return e.filter(n=>n.pos===t)}function hu(e,t){return e.filter(n=>td.indexOf(n.pos)===-1&&n.box.axis===t)}function jo(e,t){return e.sort((n,s)=>{let a=t?s:n,r=t?n:s;return a.weight===r.weight?a.index-r.index:a.weight-r.weight})}function jm(e){let t=[],n,s,a,r,l,u;for(n=0,s=(e||[]).length;n<s;++n)a=e[n],{position:r,options:{stack:l,stackWeight:u=1}}=a,t.push({index:n,box:a,pos:r,horizontal:a.isHorizontal(),weight:a.weight,stack:l&&r+l,stackWeight:u});return t}function Hm(e){let t={};for(let n of e){let{stack:s,pos:a,stackWeight:r}=n;if(!s||!td.includes(a))continue;let l=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=r}return t}function Vm(e,t){let n=Hm(e),{vBoxMaxWidth:s,hBoxMaxHeight:a}=t,r,l,u;for(r=0,l=e.length;r<l;++r){u=e[r];let{fullSize:f}=u.box,m=n[u.stack],_=m&&u.stackWeight/m.weight;u.horizontal?(u.width=_?_*s:f&&t.availableWidth,u.height=a):(u.width=s,u.height=_?_*a:f&&t.availableHeight)}return n}function Zm(e){let t=jm(e),n=jo(t.filter(m=>m.box.fullSize),!0),s=jo(Bo(t,"left"),!0),a=jo(Bo(t,"right")),r=jo(Bo(t,"top"),!0),l=jo(Bo(t,"bottom")),u=hu(t,"x"),f=hu(t,"y");return{fullSize:n,leftAndTop:s.concat(r),rightAndBottom:a.concat(f).concat(l).concat(u),chartArea:Bo(t,"chartArea"),vertical:s.concat(a).concat(f),horizontal:r.concat(l).concat(u)}}function uu(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function ed(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Wm(e,t,n,s){let{pos:a,box:r}=n,l=e.maxPadding;if(!Ot(a)){n.size&&(e[a]-=n.size);let v=s[n.stack]||{size:0,count:1};v.size=Math.max(v.size,n.horizontal?r.height:r.width),n.size=v.size/v.count,e[a]+=n.size}r.getPadding&&ed(l,r.getPadding());let u=Math.max(0,t.outerWidth-uu(l,e,"left","right")),f=Math.max(0,t.outerHeight-uu(l,e,"top","bottom")),m=u!==e.w,_=f!==e.h;return e.w=u,e.h=f,n.horizontal?{same:m,other:_}:{same:_,other:m}}function Um(e){let t=e.maxPadding;function n(s){let a=Math.max(t[s]-e[s],0);return e[s]+=a,a}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function qm(e,t){let n=t.maxPadding;function s(a){let r={left:0,top:0,right:0,bottom:0};return a.forEach(l=>{r[l]=Math.max(t[l],n[l])}),r}return s(e?["left","right"]:["top","bottom"])}function Wo(e,t,n,s){let a=[],r,l,u,f,m,_;for(r=0,l=e.length,m=0;r<l;++r){u=e[r],f=u.box,f.update(u.width||t.w,u.height||t.h,qm(u.horizontal,t));let{same:v,other:y}=Wm(t,n,u,s);m|=v&&a.length,_=_||y,f.fullSize||a.push(u)}return m&&Wo(a,t,n,s)||_}function hr(e,t,n,s,a){e.top=n,e.left=t,e.right=t+s,e.bottom=n+a,e.width=s,e.height=a}function du(e,t,n,s){let a=n.padding,{x:r,y:l}=t;for(let u of e){let f=u.box,m=s[u.stack]||{count:1,placed:0,weight:1},_=u.stackWeight/m.weight||1;if(u.horizontal){let v=t.w*_,y=m.size||f.height;ws(m.start)&&(l=m.start),f.fullSize?hr(f,a.left,l,n.outerWidth-a.right-a.left,y):hr(f,t.left+m.placed,l,v,y),m.start=l,m.placed+=v,l=f.bottom}else{let v=t.h*_,y=m.size||f.width;ws(m.start)&&(r=m.start),f.fullSize?hr(f,r,a.top,y,n.outerHeight-a.bottom-a.top):hr(f,r,t.top+m.placed,y,v),m.start=r,m.placed+=v,r=f.right}}t.x=r,t.y=l}var ti={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){let n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,s){if(!e)return;let a=ze(e.options.layout.padding),r=Math.max(t-a.width,0),l=Math.max(n-a.height,0),u=Zm(e.boxes),f=u.vertical,m=u.horizontal;Lt(e.boxes,A=>{typeof A.beforeLayout=="function"&&A.beforeLayout()});let _=f.reduce((A,E)=>E.box.options&&E.box.options.display===!1?A:A+1,0)||1,v=Object.freeze({outerWidth:t,outerHeight:n,padding:a,availableWidth:r,availableHeight:l,vBoxMaxWidth:r/2/_,hBoxMaxHeight:l/2}),y=Object.assign({},a);ed(y,ze(s));let w=Object.assign({maxPadding:y,w:r,h:l,x:a.left,y:a.top},a),k=Vm(f.concat(m),v);Wo(u.fullSize,w,v,k),Wo(f,w,v,k),Wo(m,w,v,k)&&Wo(f,w,v,k),Um(w),du(u.leftAndTop,w,v,k),w.x+=w.w,w.y+=w.h,du(u.rightAndBottom,w,v,k),e.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},Lt(u.chartArea,A=>{let E=A.box;Object.assign(E,e.chartArea),E.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}},br=class{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,s){}removeEventListener(t,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,s,a){return n=Math.max(0,n||t.width),s=s||t.height,{width:n,height:Math.max(0,a?Math.floor(n/a):s)}}isAttached(t){return!0}updateConfig(t){}},ql=class extends br{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}},gr="$chartjs",Ym={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},fu=e=>e===null||e==="";function Xm(e,t){let n=e.style,s=e.getAttribute("height"),a=e.getAttribute("width");if(e[gr]={initial:{height:s,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",fu(a)){let r=or(e,"width");r!==void 0&&(e.width=r)}if(fu(s))if(e.style.height==="")e.height=e.width/(t||2);else{let r=or(e,"height");r!==void 0&&(e.height=r)}return e}var id=El?{passive:!0}:!1;function Gm(e,t,n){e.addEventListener(t,n,id)}function $m(e,t,n){e.canvas.removeEventListener(t,n,id)}function Km(e,t){let n=Ym[e.type]||e.type,{x:s,y:a}=Li(e,t);return{type:n,chart:t,native:e,x:s!==void 0?s:null,y:a!==void 0?a:null}}function yr(e,t){for(let n of e)if(n===t||n.contains(t))return!0}function Jm(e,t,n){let s=e.canvas,a=new MutationObserver(r=>{let l=!1;for(let u of r)l=l||yr(u.addedNodes,s),l=l&&!yr(u.removedNodes,s);l&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}function Qm(e,t,n){let s=e.canvas,a=new MutationObserver(r=>{let l=!1;for(let u of r)l=l||yr(u.removedNodes,s),l=l&&!yr(u.addedNodes,s);l&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}var Jo=new Map,pu=0;function nd(){let e=window.devicePixelRatio;e!==pu&&(pu=e,Jo.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function tg(e,t){Jo.size||window.addEventListener("resize",nd),Jo.set(e,t)}function eg(e){Jo.delete(e),Jo.size||window.removeEventListener("resize",nd)}function ig(e,t,n){let s=e.canvas,a=s&&Fo(s);if(!a)return;let r=Ua((u,f)=>{let m=a.clientWidth;n(u,f),m<a.clientWidth&&n()},window),l=new ResizeObserver(u=>{let f=u[0],m=f.contentRect.width,_=f.contentRect.height;m===0&&_===0||r(m,_)});return l.observe(a),tg(e,r),l}function jl(e,t,n){n&&n.disconnect(),t==="resize"&&eg(e)}function ng(e,t,n){let s=e.canvas,a=Ua(r=>{e.ctx!==null&&n(Km(r,e))},e);return Gm(s,t,a),a}var Yl=class extends br{acquireContext(t,n){let s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(Xm(t,n),s):null}releaseContext(t){let n=t.canvas;if(!n[gr])return!1;let s=n[gr].initial;["height","width"].forEach(r=>{let l=s[r];Nt(l)?n.removeAttribute(r):n.setAttribute(r,l)});let a=s.style||{};return Object.keys(a).forEach(r=>{n.style[r]=a[r]}),n.width=n.width,delete n[gr],!0}addEventListener(t,n,s){this.removeEventListener(t,n);let a=t.$proxies||(t.$proxies={}),l={attach:Jm,detach:Qm,resize:ig}[n]||ng;a[n]=l(t,n,s)}removeEventListener(t,n){let s=t.$proxies||(t.$proxies={}),a=s[n];if(!a)return;({attach:jl,detach:jl,resize:jl}[n]||$m)(t,n,a),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,s,a){return Al(t,n,s,a)}isAttached(t){let n=Fo(t);return!!(n&&n.isConnected)}};function sg(e){return!ir()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?ql:Yl}var ki=class{x;y;active=!1;options;$animations;tooltipPosition(t){let{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}hasValue(){return os(this.x)&&os(this.y)}getProps(t,n){let s=this.$animations;if(!n||!s)return this;let a={};return t.forEach(r=>{a[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),a}};st(ki,"defaults",{}),st(ki,"defaultRoutes");function og(e,t){let n=e.options.ticks,s=ag(e),a=Math.min(n.maxTicksLimit||s,s),r=n.major.enabled?lg(t):[],l=r.length,u=r[0],f=r[l-1],m=[];if(l>a)return cg(t,m,r,l/a),m;let _=rg(r,t,a);if(l>0){let v,y,w=l>1?Math.round((f-u)/(l-1)):null;for(ur(t,m,_,Nt(w)?0:u-w,u),v=0,y=l-1;v<y;v++)ur(t,m,_,r[v],r[v+1]);return ur(t,m,_,f,Nt(w)?t.length:f+w),m}return ur(t,m,_),m}function ag(e){let t=e.options.offset,n=e._tickSize(),s=e._length/n+(t?0:1),a=e._maxLength/n;return Math.floor(Math.min(s,a))}function rg(e,t,n){let s=hg(e),a=t.length/n;if(!s)return Math.max(a,1);let r=ml(s);for(let l=0,u=r.length-1;l<u;l++){let f=r[l];if(f>a)return f}return Math.max(a,1)}function lg(e){let t=[],n,s;for(n=0,s=e.length;n<s;n++)e[n].major&&t.push(n);return t}function cg(e,t,n,s){let a=0,r=n[0],l;for(s=Math.ceil(s),l=0;l<e.length;l++)l===r&&(t.push(e[l]),a++,r=n[a*s])}function ur(e,t,n,s,a){let r=pt(s,0),l=Math.min(pt(a,e.length),e.length),u=0,f,m,_;for(n=Math.ceil(n),a&&(f=a-s,n=f/Math.floor(f/n)),_=r;_<0;)u++,_=Math.round(r+u*n);for(m=Math.max(r,0);m<l;m++)m===_&&(t.push(e[m]),u++,_=Math.round(r+u*n))}function hg(e){let t=e.length,n,s;if(t<2)return!1;for(s=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==s)return!1;return s}var ug=e=>e==="left"?"right":e==="right"?"left":e,mu=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,gu=(e,t)=>Math.min(t||e,e);function _u(e,t){let n=[],s=e.length/t,a=e.length,r=0;for(;r<a;r+=s)n.push(e[Math.floor(r)]);return n}function dg(e,t,n){let s=e.ticks.length,a=Math.min(t,s-1),r=e._startPixel,l=e._endPixel,u=1e-6,f=e.getPixelForTick(a),m;if(!(n&&(s===1?m=Math.max(f-r,l-f):t===0?m=(e.getPixelForTick(1)-f)/2:m=(f-e.getPixelForTick(a-1))/2,f+=a<t?m:-m,f<r-u||f>l+u)))return f}function fg(e,t){Lt(e,n=>{let s=n.gc,a=s.length/2,r;if(a>t){for(r=0;r<a;++r)delete n.data[s[r]];s.splice(0,a)}})}function Ho(e){return e.drawTicks?e.tickLength:0}function vu(e,t){if(!e.display)return 0;let n=me(e.font,t),s=ze(e.padding);return(Jt(e.text)?e.text.length:1)*n.lineHeight+s.height}function pg(e,t){return _n(e,{scale:t,type:"scale"})}function mg(e,t,n){return _n(e,{tick:n,index:t,type:"tick"})}function gg(e,t,n){let s=Io(e);return(n&&t!=="right"||!n&&t==="right")&&(s=ug(s)),s}function _g(e,t,n,s){let{top:a,left:r,bottom:l,right:u,chart:f}=e,{chartArea:m,scales:_}=f,v=0,y,w,k,A=l-a,E=u-r;if(e.isHorizontal()){if(w=Re(s,r,u),Ot(n)){let D=Object.keys(n)[0],z=n[D];k=_[D].getPixelForValue(z)+A-t}else n==="center"?k=(m.bottom+m.top)/2+A-t:k=mu(e,n,t);y=u-r}else{if(Ot(n)){let D=Object.keys(n)[0],z=n[D];w=_[D].getPixelForValue(z)-E+t}else n==="center"?w=(m.left+m.right)/2-E+t:w=mu(e,n,t);k=Re(s,l,a),v=n==="left"?-ce:ce}return{titleX:w,titleY:k,maxWidth:y,rotation:v}}var Zn=class extends ki{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:s,_suggestedMax:a}=this;return t=ui(t,Number.POSITIVE_INFINITY),n=ui(n,Number.NEGATIVE_INFINITY),s=ui(s,Number.POSITIVE_INFINITY),a=ui(a,Number.NEGATIVE_INFINITY),{min:ui(t,s),max:ui(n,a),minDefined:he(t),maxDefined:he(n)}}getMinMax(t){let{min:n,max:s,minDefined:a,maxDefined:r}=this.getUserBounds(),l;if(a&&r)return{min:n,max:s};let u=this.getMatchingVisibleMetas();for(let f=0,m=u.length;f<m;++f)l=u[f].controller.getMinMax(this,t),a||(n=Math.min(n,l.min)),r||(s=Math.max(s,l.max));return n=r&&n>s?s:n,s=a&&n>s?n:s,{min:ui(n,ui(s,n)),max:ui(s,ui(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){bt(this.options.beforeUpdate,[this])}update(t,n,s){let{beginAtZero:a,grace:r,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Tl(this,r,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let f=u<this.ticks.length;this._convertTicksToLabels(f?_u(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=og(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,t=!t),this._startPixel=n,this._endPixel=s,this._reversePixels=t,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){bt(this.options.afterUpdate,[this])}beforeSetDimensions(){bt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){bt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),bt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){bt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){let n=this.options.ticks,s,a,r;for(s=0,a=t.length;s<a;s++)r=t[s],r.label=bt(n.callback,[r.value,s,t],this)}afterTickToLabelConversion(){bt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){bt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let t=this.options,n=t.ticks,s=gu(this.ticks.length,t.ticks.maxTicksLimit),a=n.minRotation||0,r=n.maxRotation,l=a,u,f,m;if(!this._isVisible()||!n.display||a>=r||s<=1||!this.isHorizontal()){this.labelRotation=a;return}let _=this._getLabelSizes(),v=_.widest.width,y=_.highest.height,w=we(this.chart.width-v,0,this.maxWidth);u=t.offset?this.maxWidth/s:w/(s-1),v+6>u&&(u=w/(s-(t.offset?.5:1)),f=this.maxHeight-Ho(t.grid)-n.padding-vu(t.title,this.chart.options.font),m=Math.sqrt(v*v+y*y),l=Ao(Math.min(Math.asin(we((_.highest.height+6)/u,-1,1)),Math.asin(we(f/m,-1,1))-Math.asin(we(y/m,-1,1)))),l=Math.max(a,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){bt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){bt(this.options.beforeFit,[this])}fit(){let t={width:0,height:0},{chart:n,options:{ticks:s,title:a,grid:r}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){let f=vu(a,n.options.font);if(u?(t.width=this.maxWidth,t.height=Ho(r)+f):(t.height=this.maxHeight,t.width=Ho(r)+f),s.display&&this.ticks.length){let{first:m,last:_,widest:v,highest:y}=this._getLabelSizes(),w=s.padding*2,k=Ti(this.labelRotation),A=Math.cos(k),E=Math.sin(k);if(u){let D=s.mirror?0:E*v.width+A*y.height;t.height=Math.min(this.maxHeight,t.height+D+w)}else{let D=s.mirror?0:A*v.width+E*y.height;t.width=Math.min(this.maxWidth,t.width+D+w)}this._calculatePadding(m,_,E,A)}}this._handleMargins(),u?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,s,a){let{ticks:{align:r,padding:l},position:u}=this.options,f=this.labelRotation!==0,m=u!=="top"&&this.axis==="x";if(this.isHorizontal()){let _=this.getPixelForTick(0)-this.left,v=this.right-this.getPixelForTick(this.ticks.length-1),y=0,w=0;f?m?(y=a*t.width,w=s*n.height):(y=s*t.height,w=a*n.width):r==="start"?w=n.width:r==="end"?y=t.width:r!=="inner"&&(y=t.width/2,w=n.width/2),this.paddingLeft=Math.max((y-_+l)*this.width/(this.width-_),0),this.paddingRight=Math.max((w-v+l)*this.width/(this.width-v),0)}else{let _=n.height/2,v=t.height/2;r==="start"?(_=0,v=t.height):r==="end"&&(_=n.height,v=0),this.paddingTop=_+l,this.paddingBottom=v+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){bt(this.options.afterFit,[this])}isHorizontal(){let{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,s;for(n=0,s=t.length;n<s;n++)Nt(t[n].label)&&(t.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){let n=this.options.ticks.sampleSize,s=this.ticks;n<s.length&&(s=_u(s,n)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,s){let{ctx:a,_longestTextCache:r}=this,l=[],u=[],f=Math.floor(n/gu(n,s)),m=0,_=0,v,y,w,k,A,E,D,z,V,W,H;for(v=0;v<n;v+=f){if(k=t[v].label,A=this._resolveTickFontOptions(v),a.font=E=A.string,D=r[E]=r[E]||{data:{},gc:[]},z=A.lineHeight,V=W=0,!Nt(k)&&!Jt(k))V=Js(a,D.data,D.gc,V,k),W=z;else if(Jt(k))for(y=0,w=k.length;y<w;++y)H=k[y],!Nt(H)&&!Jt(H)&&(V=Js(a,D.data,D.gc,V,H),W+=z);l.push(V),u.push(W),m=Math.max(V,m),_=Math.max(W,_)}fg(r,n);let X=l.indexOf(m),$=u.indexOf(_),G=B=>({width:l[B]||0,height:u[B]||0});return{first:G(0),last:G(n-1),widest:G(X),highest:G($),widths:l,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){let n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);let n=this._startPixel+t*this._length;return _l(this._alignToPixels?Fn(this.chart,n,0):n)}getDecimalForPixel(t){let n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){let n=this.ticks||[];if(t>=0&&t<n.length){let s=n[t];return s.$context||(s.$context=mg(this.getContext(),t,s))}return this.$context||(this.$context=pg(this.chart.getContext(),this))}_tickSize(){let t=this.options.ticks,n=Ti(this.labelRotation),s=Math.abs(Math.cos(n)),a=Math.abs(Math.sin(n)),r=this._getLabelSizes(),l=t.autoSkipPadding||0,u=r?r.widest.width+l:0,f=r?r.highest.height+l:0;return this.isHorizontal()?f*s>u*a?u/s:f/a:f*a<u*s?f/s:u/a}_isVisible(){let t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){let n=this.axis,s=this.chart,a=this.options,{grid:r,position:l,border:u}=a,f=r.offset,m=this.isHorizontal(),v=this.ticks.length+(f?1:0),y=Ho(r),w=[],k=u.setContext(this.getContext()),A=k.display?k.width:0,E=A/2,D=function(tt){return Fn(s,tt,A)},z,V,W,H,X,$,G,B,ot,ut,Q,$t;if(l==="top")z=D(this.bottom),$=this.bottom-y,B=z-E,ut=D(t.top)+E,$t=t.bottom;else if(l==="bottom")z=D(this.top),ut=t.top,$t=D(t.bottom)-E,$=z+E,B=this.top+y;else if(l==="left")z=D(this.right),X=this.right-y,G=z-E,ot=D(t.left)+E,Q=t.right;else if(l==="right")z=D(this.left),ot=t.left,Q=D(t.right)-E,X=z+E,G=this.left+y;else if(n==="x"){if(l==="center")z=D((t.top+t.bottom)/2+.5);else if(Ot(l)){let tt=Object.keys(l)[0],At=l[tt];z=D(this.chart.scales[tt].getPixelForValue(At))}ut=t.top,$t=t.bottom,$=z+E,B=$+y}else if(n==="y"){if(l==="center")z=D((t.left+t.right)/2);else if(Ot(l)){let tt=Object.keys(l)[0],At=l[tt];z=D(this.chart.scales[tt].getPixelForValue(At))}X=z-E,G=X-y,ot=t.left,Q=t.right}let St=pt(a.ticks.maxTicksLimit,v),kt=Math.max(1,Math.ceil(v/St));for(V=0;V<v;V+=kt){let tt=this.getContext(V),At=r.setContext(tt),nt=u.setContext(tt),wt=At.lineWidth,te=At.color,Dt=nt.dash||[],Ct=nt.dashOffset,Pt=At.tickWidth,Mt=At.tickColor,Se=At.tickBorderDash||[],jt=At.tickBorderDashOffset;W=dg(this,V,f),W!==void 0&&(H=Fn(s,W,wt),m?X=G=ot=Q=H:$=B=ut=$t=H,w.push({tx1:X,ty1:$,tx2:G,ty2:B,x1:ot,y1:ut,x2:Q,y2:$t,width:wt,color:te,borderDash:Dt,borderDashOffset:Ct,tickWidth:Pt,tickColor:Mt,tickBorderDash:Se,tickBorderDashOffset:jt}))}return this._ticksLength=v,this._borderValue=z,w}_computeLabelItems(t){let n=this.axis,s=this.options,{position:a,ticks:r}=s,l=this.isHorizontal(),u=this.ticks,{align:f,crossAlign:m,padding:_,mirror:v}=r,y=Ho(s.grid),w=y+_,k=v?-_:w,A=-Ti(this.labelRotation),E=[],D,z,V,W,H,X,$,G,B,ot,ut,Q,$t="middle";if(a==="top")X=this.bottom-k,$=this._getXAxisLabelAlignment();else if(a==="bottom")X=this.top+k,$=this._getXAxisLabelAlignment();else if(a==="left"){let kt=this._getYAxisLabelAlignment(y);$=kt.textAlign,H=kt.x}else if(a==="right"){let kt=this._getYAxisLabelAlignment(y);$=kt.textAlign,H=kt.x}else if(n==="x"){if(a==="center")X=(t.top+t.bottom)/2+w;else if(Ot(a)){let kt=Object.keys(a)[0],tt=a[kt];X=this.chart.scales[kt].getPixelForValue(tt)+w}$=this._getXAxisLabelAlignment()}else if(n==="y"){if(a==="center")H=(t.left+t.right)/2-w;else if(Ot(a)){let kt=Object.keys(a)[0],tt=a[kt];H=this.chart.scales[kt].getPixelForValue(tt)}$=this._getYAxisLabelAlignment(y).textAlign}n==="y"&&(f==="start"?$t="top":f==="end"&&($t="bottom"));let St=this._getLabelSizes();for(D=0,z=u.length;D<z;++D){V=u[D],W=V.label;let kt=r.setContext(this.getContext(D));G=this.getPixelForTick(D)+r.labelOffset,B=this._resolveTickFontOptions(D),ot=B.lineHeight,ut=Jt(W)?W.length:1;let tt=ut/2,At=kt.color,nt=kt.textStrokeColor,wt=kt.textStrokeWidth,te=$;l?(H=G,$==="inner"&&(D===z-1?te=this.options.reverse?"left":"right":D===0?te=this.options.reverse?"right":"left":te="center"),a==="top"?m==="near"||A!==0?Q=-ut*ot+ot/2:m==="center"?Q=-St.highest.height/2-tt*ot+ot:Q=-St.highest.height+ot/2:m==="near"||A!==0?Q=ot/2:m==="center"?Q=St.highest.height/2-tt*ot:Q=St.highest.height-ut*ot,v&&(Q*=-1),A!==0&&!kt.showLabelBackdrop&&(H+=ot/2*Math.sin(A))):(X=G,Q=(1-ut)*ot/2);let Dt;if(kt.showLabelBackdrop){let Ct=ze(kt.backdropPadding),Pt=St.heights[D],Mt=St.widths[D],Se=Q-Ct.top,jt=0-Ct.left;switch($t){case"middle":Se-=Pt/2;break;case"bottom":Se-=Pt;break}switch($){case"center":jt-=Mt/2;break;case"right":jt-=Mt;break}Dt={left:jt,top:Se,width:Mt+Ct.width,height:Pt+Ct.height,color:kt.backdropColor}}E.push({label:W,font:B,textOffset:Q,options:{rotation:A,color:At,strokeColor:nt,strokeWidth:wt,textAlign:te,textBaseline:$t,translation:[H,X],backdrop:Dt}})}return E}_getXAxisLabelAlignment(){let{position:t,ticks:n}=this.options;if(-Ti(this.labelRotation))return t==="top"?"left":"right";let a="center";return n.align==="start"?a="left":n.align==="end"?a="right":n.align==="inner"&&(a="inner"),a}_getYAxisLabelAlignment(t){let{position:n,ticks:{crossAlign:s,mirror:a,padding:r}}=this.options,l=this._getLabelSizes(),u=t+r,f=l.widest.width,m,_;return n==="left"?a?(_=this.right+r,s==="near"?m="left":s==="center"?(m="center",_+=f/2):(m="right",_+=f)):(_=this.right-u,s==="near"?m="right":s==="center"?(m="center",_-=f/2):(m="left",_=this.left)):n==="right"?a?(_=this.left+r,s==="near"?m="right":s==="center"?(m="center",_-=f/2):(m="left",_-=f)):(_=this.left+u,s==="near"?m="left":s==="center"?(m="center",_+=f/2):(m="right",_=this.right)):m="right",{textAlign:m,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;let t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){let{ctx:t,options:{backgroundColor:n},left:s,top:a,width:r,height:l}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(s,a,r,l),t.restore())}getLineWidthForValue(t){let n=this.options.grid;if(!this._isVisible()||!n.display)return 0;let a=this.ticks.findIndex(r=>r.value===t);return a>=0?n.setContext(this.getContext(a)).lineWidth:0}drawGrid(t){let n=this.options.grid,s=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t)),r,l,u=(f,m,_)=>{!_.width||!_.color||(s.save(),s.lineWidth=_.width,s.strokeStyle=_.color,s.setLineDash(_.borderDash||[]),s.lineDashOffset=_.borderDashOffset,s.beginPath(),s.moveTo(f.x,f.y),s.lineTo(m.x,m.y),s.stroke(),s.restore())};if(n.display)for(r=0,l=a.length;r<l;++r){let f=a[r];n.drawOnChartArea&&u({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&u({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){let{chart:t,ctx:n,options:{border:s,grid:a}}=this,r=s.setContext(this.getContext()),l=s.display?r.width:0;if(!l)return;let u=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue,m,_,v,y;this.isHorizontal()?(m=Fn(t,this.left,l)-l/2,_=Fn(t,this.right,u)+u/2,v=y=f):(v=Fn(t,this.top,l)-l/2,y=Fn(t,this.bottom,u)+u/2,m=_=f),n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.beginPath(),n.moveTo(m,v),n.lineTo(_,y),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;let s=this.ctx,a=this._computeLabelArea();a&&eo(s,a);let r=this.getLabelItems(t);for(let l of r){let u=l.options,f=l.font,m=l.label,_=l.textOffset;Nn(s,m,0,_,f,u)}a&&io(s)}drawTitle(){let{ctx:t,options:{position:n,title:s,reverse:a}}=this;if(!s.display)return;let r=me(s.font),l=ze(s.padding),u=s.align,f=r.lineHeight/2;n==="bottom"||n==="center"||Ot(n)?(f+=l.bottom,Jt(s.text)&&(f+=r.lineHeight*(s.text.length-1))):f+=l.top;let{titleX:m,titleY:_,maxWidth:v,rotation:y}=_g(this,f,n,u);Nn(t,s.text,0,0,r,{color:s.color,maxWidth:v,rotation:y,textAlign:gg(u,n,a),textBaseline:"middle",translation:[m,_]})}draw(t){!this._isVisible()||(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){let t=this.options,n=t.ticks&&t.ticks.z||0,s=pt(t.grid&&t.grid.z,-1),a=pt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Zn.prototype.draw?[{z:n,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:n,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){let n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",a=[],r,l;for(r=0,l=n.length;r<l;++r){let u=n[r];u[s]===this.id&&(!t||u.type===t)&&a.push(u)}return a}_resolveTickFontOptions(t){let n=this.options.ticks.setContext(this.getContext(t));return me(n.font)}_maxDigits(){let t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},uo=class{constructor(t,n,s){this.type=t,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){let n=Object.getPrototypeOf(t),s;yg(n)&&(s=this.register(n));let a=this.items,r=t.id,l=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in a||(a[r]=t,vg(t,l,s),this.override&&de.override(t.id,t.overrides)),l}get(t){return this.items[t]}unregister(t){let n=this.items,s=t.id,a=this.scope;s in n&&delete n[s],a&&s in de[a]&&(delete de[a][s],this.override&&delete as[s])}};function vg(e,t,n){let s=ys(Object.create(null),[n?de.get(n):{},de.get(t),e.defaults]);de.set(t,s),e.defaultRoutes&&bg(t,e.defaultRoutes),e.descriptors&&de.describe(t,e.descriptors)}function bg(e,t){Object.keys(t).forEach(n=>{let s=n.split("."),a=s.pop(),r=[e].concat(s).join("."),l=t[n].split("."),u=l.pop(),f=l.join(".");de.route(r,a,f,u)})}function yg(e){return"id"in e&&"defaults"in e}var Xl=class{constructor(){this.controllers=new uo(Ci,"datasets",!0),this.elements=new uo(ki,"elements"),this.plugins=new uo(Object,"plugins"),this.scales=new uo(Zn,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,s){[...n].forEach(a=>{let r=s||this._getRegistryForType(a);s||r.isForType(a)||r===this.plugins&&a.id?this._exec(t,r,a):Lt(a,l=>{let u=s||this._getRegistryForType(l);this._exec(t,u,l)})})}_exec(t,n,s){let a=ko(t);bt(s["before"+a],[],s),n[t](s),bt(s["after"+a],[],s)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){let s=this._typedRegistries[n];if(s.isForType(t))return s}return this.plugins}_get(t,n,s){let a=n.get(t);if(a===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return a}},bn=new Xl,Gl=class{constructor(){this._init=[]}notify(t,n,s,a){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));let r=a?this._descriptors(t).filter(a):this._descriptors(t),l=this._notify(r,t,n,s);return n==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),l}_notify(t,n,s,a){a=a||{};for(let r of t){let l=r.plugin,u=l[s],f=[n,a,r.options];if(bt(u,f,l)===!1&&a.cancelable)return!1}return!0}invalidate(){Nt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;let n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){let s=t&&t.config,a=pt(s.options&&s.options.plugins,{}),r=xg(s);return a===!1&&!n?[]:Mg(t,r,a,n)}_notifyStateChanges(t){let n=this._oldCache||[],s=this._cache,a=(r,l)=>r.filter(u=>!l.some(f=>u.plugin.id===f.plugin.id));this._notify(a(n,s),t,"stop"),this._notify(a(s,n),t,"start")}};function xg(e){let t={},n=[],s=Object.keys(bn.plugins.items);for(let r=0;r<s.length;r++)n.push(bn.getPlugin(s[r]));let a=e.plugins||[];for(let r=0;r<a.length;r++){let l=a[r];n.indexOf(l)===-1&&(n.push(l),t[l.id]=!0)}return{plugins:n,localIds:t}}function wg(e,t){return!t&&e===!1?null:e===!0?{}:e}function Mg(e,{plugins:t,localIds:n},s,a){let r=[],l=e.getContext();for(let u of t){let f=u.id,m=wg(s[f],a);m!==null&&r.push({plugin:u,options:Sg(e.config,{plugin:u,local:n[f]},m,l)})}return r}function Sg(e,{plugin:t,local:n},s,a){let r=e.pluginScopeKeys(t),l=e.getOptionScopes(s,r);return n&&t.defaults&&l.push(t.defaults),e.createResolver(l,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function $l(e,t){let n=de.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Pg(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function Tg(e,t){return e===t?"_index_":"_value_"}function bu(e){if(e==="x"||e==="y"||e==="r")return e}function Lg(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Kl(e,...t){if(bu(e))return e;for(let n of t){let s=n.axis||Lg(n.position)||e.length>1&&bu(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function yu(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Cg(e,t){if(t.data&&t.data.datasets){let n=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(n.length)return yu(e,"x",n[0])||yu(e,"y",n[0])}return{}}function kg(e,t){let n=as[e.type]||{scales:{}},s=t.scales||{},a=$l(e.type,t),r=Object.create(null);return Object.keys(s).forEach(l=>{let u=s[l];if(!Ot(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);let f=Kl(l,u,Cg(l,e),de.scales[u.type]),m=Tg(f,a),_=n.scales||{};r[l]=xs(Object.create(null),[{axis:f},u,_[f],_[m]])}),e.data.datasets.forEach(l=>{let u=l.type||e.type,f=l.indexAxis||$l(u,t),_=(as[u]||{}).scales||{};Object.keys(_).forEach(v=>{let y=Pg(v,f),w=l[y+"AxisID"]||y;r[w]=r[w]||Object.create(null),xs(r[w],[{axis:y},s[w],_[v]])})}),Object.keys(r).forEach(l=>{let u=r[l];xs(u,[de.scales[u.type],de.scale])}),r}function sd(e){let t=e.options||(e.options={});t.plugins=pt(t.plugins,{}),t.scales=kg(e,t)}function od(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function Ag(e){return e=e||{},e.data=od(e.data),sd(e),e}var xu=new Map,ad=new Set;function dr(e,t){let n=xu.get(e);return n||(n=t(),xu.set(e,n),ad.add(n)),n}var Vo=(e,t,n)=>{let s=gn(t,n);s!==void 0&&e.add(s)},Jl=class{constructor(t){this._config=Ag(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=od(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){let t=this._config;this.clearCache(),sd(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return dr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return dr(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return dr(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){let n=t.id,s=this.type;return dr(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){let s=this._scopeCache,a=s.get(t);return(!a||n)&&(a=new Map,s.set(t,a)),a}getOptionScopes(t,n,s){let{options:a,type:r}=this,l=this._cachedScopes(t,s),u=l.get(n);if(u)return u;let f=new Set;n.forEach(_=>{t&&(f.add(t),_.forEach(v=>Vo(f,t,v))),_.forEach(v=>Vo(f,a,v)),_.forEach(v=>Vo(f,as[r]||{},v)),_.forEach(v=>Vo(f,de,v)),_.forEach(v=>Vo(f,$a,v))});let m=Array.from(f);return m.length===0&&m.push(Object.create(null)),ad.has(n)&&l.set(n,m),m}chartOptionScopes(){let{options:t,type:n}=this;return[t,as[n]||{},de.datasets[n]||{},{type:n},de,$a]}resolveNamedOptions(t,n,s,a=[""]){let r={$shared:!0},{resolver:l,subPrefixes:u}=wu(this._resolverCache,t,a),f=l;if(Ig(l,n)){r.$shared=!1,s=pn(s)?s():s;let m=this.createResolver(t,s,u);f=ss(l,s,m)}for(let m of n)r[m]=f[m];return r}createResolver(t,n,s=[""],a){let{resolver:r}=wu(this._resolverCache,t,s);return Ot(n)?ss(r,n,void 0,a):r}};function wu(e,t,n){let s=e.get(t);s||(s=new Map,e.set(t,s));let a=n.join(),r=s.get(a);return r||(r={resolver:zo(t,n),subPrefixes:n.filter(u=>!u.toLowerCase().includes("hover"))},s.set(a,r)),r}var Eg=e=>Ot(e)&&Object.getOwnPropertyNames(e).reduce((t,n)=>t||pn(e[n]),!1);function Ig(e,t){let{isScriptable:n,isIndexable:s}=tr(e);for(let a of t){let r=n(a),l=s(a),u=(l||r)&&e[a];if(r&&(pn(u)||Eg(u))||l&&Jt(u))return!0}return!1}var Og="4.3.0",Dg=["top","bottom","left","right","chartArea"];function Mu(e,t){return e==="top"||e==="bottom"||Dg.indexOf(e)===-1&&t==="x"}function Su(e,t){return function(n,s){return n[e]===s[e]?n[t]-s[t]:n[e]-s[e]}}function Pu(e){let t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),bt(n&&n.onComplete,[e],t)}function Rg(e){let t=e.chart,n=t.options.animation;bt(n&&n.onProgress,[e],t)}function rd(e){return ir()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var _r={},Tu=e=>{let t=rd(e);return Object.values(_r).filter(n=>n.canvas===t).pop()};function zg(e,t,n){let s=Object.keys(e);for(let a of s){let r=+a;if(r>=t){let l=e[a];delete e[a],(n>0||r>t)&&(e[r+n]=l)}}}function Fg(e,t,n,s){return!n||e.type==="mouseout"?null:s?t:e}function Ng(e){let{xScale:t,yScale:n}=e;if(t&&n)return{left:t.left,right:t.right,top:n.top,bottom:n.bottom}}var qi=class{static register(...t){bn.add(...t),Lu()}static unregister(...t){bn.remove(...t),Lu()}constructor(t,n){let s=this.config=new Jl(n),a=rd(t),r=Tu(a);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");let l=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||sg(a)),this.platform.updateConfig(s);let u=this.platform.acquireContext(a,l.aspectRatio),f=u&&u.canvas,m=f&&f.height,_=f&&f.width;if(this.id=dl(),this.ctx=u,this.canvas=f,this.width=_,this.height=m,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Gl,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=xl(v=>this.update(v),l.resizeDelay||0),this._dataChanges=[],_r[this.id]=this,!u||!f){console.error("Failed to create chart: can't acquire context from the given item");return}jn.listen(this,"complete",Pu),jn.listen(this,"progress",Rg),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:t,maintainAspectRatio:n},width:s,height:a,_aspectRatio:r}=this;return Nt(t)?n&&r?r:a?s/a:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return bn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sr(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ka(this.canvas,this.ctx),this}stop(){return jn.stop(this),this}resize(t,n){jn.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){let s=this.options,a=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(a,t,n,r),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,sr(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),bt(s.onResize,[this,l],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){let n=this.options.scales||{};Lt(n,(s,a)=>{s.id=a})}buildOrUpdateScales(){let t=this.options,n=t.scales,s=this.scales,a=Object.keys(s).reduce((l,u)=>(l[u]=!1,l),{}),r=[];n&&(r=r.concat(Object.keys(n).map(l=>{let u=n[l],f=Kl(l,u),m=f==="r",_=f==="x";return{options:u,dposition:m?"chartArea":_?"bottom":"left",dtype:m?"radialLinear":_?"category":"linear"}}))),Lt(r,l=>{let u=l.options,f=u.id,m=Kl(f,u),_=pt(u.type,l.dtype);(u.position===void 0||Mu(u.position,m)!==Mu(l.dposition))&&(u.position=l.dposition),a[f]=!0;let v=null;if(f in s&&s[f].type===_)v=s[f];else{let y=bn.getScale(_);v=new y({id:f,type:_,ctx:this.ctx,chart:this}),s[v.id]=v}v.init(u,t)}),Lt(a,(l,u)=>{l||delete s[u]}),Lt(s,l=>{ti.configure(this,l,l.options),ti.addBox(this,l)})}_updateMetasets(){let t=this._metasets,n=this.data.datasets.length,s=t.length;if(t.sort((a,r)=>a.index-r.index),s>n){for(let a=n;a<s;++a)this._destroyDatasetMeta(a);t.splice(n,s-n)}this._sortedMetasets=t.slice(0).sort(Su("order","index"))}_removeUnreferencedMetasets(){let{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((s,a)=>{n.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){let t=[],n=this.data.datasets,s,a;for(this._removeUnreferencedMetasets(),s=0,a=n.length;s<a;s++){let r=n[s],l=this.getDatasetMeta(s),u=r.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(s),l=this.getDatasetMeta(s)),l.type=u,l.indexAxis=r.indexAxis||$l(u,this.options),l.order=r.order||0,l.index=s,l.label=""+r.label,l.visible=this.isDatasetVisible(s),l.controller)l.controller.updateIndex(s),l.controller.linkScales();else{let f=bn.getController(u),{datasetElementType:m,dataElementType:_}=de.datasets[u];Object.assign(f,{dataElementType:bn.getElement(_),datasetElementType:m&&bn.getElement(m)}),l.controller=new f(this,s),t.push(l.controller)}}return this._updateMetasets(),t}_resetElements(){Lt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){let n=this.config;n.update();let s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;let r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let m=0,_=this.data.datasets.length;m<_;m++){let{controller:v}=this.getDatasetMeta(m),y=!a&&r.indexOf(v)===-1;v.buildOrUpdateElements(y),l=Math.max(+v.getMaxOverflow(),l)}l=this._minPadding=s.layout.autoPadding?l:0,this._updateLayout(l),a||Lt(r,m=>{m.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Su("z","_idx"));let{_active:u,_lastEvent:f}=this;f?this._eventHandler(f,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){Lt(this.scales,t=>{ti.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let t=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!Fa(n,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(let{method:s,start:a,count:r}of n){let l=s==="_removeElements"?-r:r;zg(t,a,l)}}_getUniformDataChanges(){let t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];let n=this.data.datasets.length,s=r=>new Set(t.filter(l=>l[0]===r).map((l,u)=>u+","+l.splice(1).join(","))),a=s(0);for(let r=1;r<n;r++)if(!Fa(a,s(r)))return;return Array.from(a).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ti.update(this,this.width,this.height,t);let n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Lt(this.boxes,a=>{s&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,r)=>{a._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,pn(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){let s=this.getDatasetMeta(t),a={meta:s,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(s.controller._update(n),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(jn.has(this)?this.attached&&!jn.running(this)&&jn.start(this):(this.draw(),Pu({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){let{width:s,height:a}=this._resizeBeforeDraw;this._resize(s,a),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){let n=this._sortedMetasets,s=[],a,r;for(a=0,r=n.length;a<r;++a){let l=n[a];(!t||l.visible)&&s.push(l)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){let n=this.ctx,s=t._clip,a=!s.disabled,r=Ng(t)||this.chartArea,l={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",l)!==!1&&(a&&eo(n,{left:s.left===!1?0:r.left-s.left,right:s.right===!1?this.width:r.right+s.right,top:s.top===!1?0:r.top-s.top,bottom:s.bottom===!1?this.height:r.bottom+s.bottom}),t.controller.draw(),a&&io(n),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}isPointInArea(t){return nn(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,s,a){let r=Bm.modes[n];return typeof r=="function"?r(this,t,s,a):[]}getDatasetMeta(t){let n=this.data.datasets[t],s=this._metasets,a=s.filter(r=>r&&r._dataset===n).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},s.push(a)),a}getContext(){return this.$context||(this.$context=_n(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){let n=this.data.datasets[t];if(!n)return!1;let s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(t,n){let s=this.getDatasetMeta(t);s.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,s){let a=s?"show":"hide",r=this.getDatasetMeta(t),l=r.controller._resolveAnimations(void 0,a);ws(n)?(r.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),l.update(r,{visible:s}),this.update(u=>u.datasetIndex===t?a:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){let n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),jn.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Ka(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete _r[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let t=this._listeners,n=this.platform,s=(r,l)=>{n.addEventListener(this,r,l),t[r]=l},a=(r,l,u)=>{r.offsetX=l,r.offsetY=u,this._eventHandler(r)};Lt(this.options.events,r=>s(r,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let t=this._responsiveListeners,n=this.platform,s=(f,m)=>{n.addEventListener(this,f,m),t[f]=m},a=(f,m)=>{t[f]&&(n.removeEventListener(this,f,m),delete t[f])},r=(f,m)=>{this.canvas&&this.resize(f,m)},l,u=()=>{a("attach",u),this.attached=!0,this.resize(),s("resize",r),s("detach",l)};l=()=>{this.attached=!1,a("resize",r),this._stop(),this._resize(0,0),s("attach",u)},n.isAttached(this.canvas)?u():l()}unbindEvents(){Lt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Lt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,s){let a=s?"set":"remove",r,l,u,f;for(n==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+a+"DatasetHoverStyle"]()),u=0,f=t.length;u<f;++u){l=t[u];let m=l&&this.getDatasetMeta(l.datasetIndex).controller;m&&m[a+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){let n=this._active||[],s=t.map(({datasetIndex:r,index:l})=>{let u=this.getDatasetMeta(r);if(!u)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:u.data[l],index:l}});!to(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(t,n,s){return this._plugins.notify(this,t,n,s)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,s){let a=this.options.hover,r=(f,m)=>f.filter(_=>!m.some(v=>_.datasetIndex===v.datasetIndex&&_.index===v.index)),l=r(n,t),u=s?t:r(t,n);l.length&&this.updateHoverStyle(l,a.mode,!1),u.length&&a.mode&&this.updateHoverStyle(u,a.mode,!0)}_eventHandler(t,n){let s={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},a=l=>(l.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,a)===!1)return;let r=this._handleEvent(t,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,a),(r||s.changed)&&this.render(),this}_handleEvent(t,n,s){let{_active:a=[],options:r}=this,l=n,u=this._getActiveElements(t,a,s,l),f=pl(t),m=Fg(t,this._lastEvent,s,f);s&&(this._lastEvent=null,bt(r.onHover,[t,u,this],this),f&&bt(r.onClick,[t,u,this],this));let _=!to(u,a);return(_||n)&&(this._active=u,this._updateHoverStyles(u,a,n)),this._lastEvent=m,_}_getActiveElements(t,n,s,a){if(t.type==="mouseout")return[];if(!s)return n;let r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,a)}};st(qi,"defaults",de),st(qi,"instances",_r),st(qi,"overrides",as),st(qi,"registry",bn),st(qi,"version",Og),st(qi,"getChart",Tu);function Lu(){return Lt(qi.instances,e=>e._plugins.invalidate())}function Bg(e,t,n){let{startAngle:s,pixelMargin:a,x:r,y:l,outerRadius:u,innerRadius:f}=t,m=a/u;e.beginPath(),e.arc(r,l,u,s-m,n+m),f>a?(m=a/f,e.arc(r,l,f,n+m,s-m,!0)):e.arc(r,l,a,n+ce,s-ce),e.closePath(),e.clip()}function jg(e){return Ro(e,["outerStart","outerEnd","innerStart","innerEnd"])}function Hg(e,t,n,s){let a=jg(e.options.borderRadius),r=(n-t)/2,l=Math.min(r,s*t/2),u=f=>{let m=(n-Math.min(r,f))*s/2;return we(f,0,Math.min(r,m))};return{outerStart:u(a.outerStart),outerEnd:u(a.outerEnd),innerStart:we(a.innerStart,0,l),innerEnd:we(a.innerEnd,0,l)}}function no(e,t,n,s){return{x:n+e*Math.cos(t),y:s+e*Math.sin(t)}}function xr(e,t,n,s,a,r){let{x:l,y:u,startAngle:f,pixelMargin:m,innerRadius:_}=t,v=Math.max(t.outerRadius+s+n-m,0),y=_>0?_+s+n+m:0,w=0,k=a-f;if(s){let kt=_>0?_-s:0,tt=v>0?v-s:0,At=(kt+tt)/2,nt=At!==0?k*At/(At+s):k;w=(k-nt)/2}let A=Math.max(.001,k*v-n/ie)/v,E=(k-A)/2,D=f+E+w,z=a-E-w,{outerStart:V,outerEnd:W,innerStart:H,innerEnd:X}=Hg(t,y,v,z-D),$=v-V,G=v-W,B=D+V/$,ot=z-W/G,ut=y+H,Q=y+X,$t=D+H/ut,St=z-X/Q;if(e.beginPath(),r){let kt=(B+ot)/2;if(e.arc(l,u,v,B,kt),e.arc(l,u,v,kt,ot),W>0){let wt=no(G,ot,l,u);e.arc(wt.x,wt.y,W,ot,z+ce)}let tt=no(Q,z,l,u);if(e.lineTo(tt.x,tt.y),X>0){let wt=no(Q,St,l,u);e.arc(wt.x,wt.y,X,z+ce,St+Math.PI)}let At=(z-X/y+(D+H/y))/2;if(e.arc(l,u,y,z-X/y,At,!0),e.arc(l,u,y,At,D+H/y,!0),H>0){let wt=no(ut,$t,l,u);e.arc(wt.x,wt.y,H,$t+Math.PI,D-ce)}let nt=no($,D,l,u);if(e.lineTo(nt.x,nt.y),V>0){let wt=no($,B,l,u);e.arc(wt.x,wt.y,V,D-ce,B)}}else{e.moveTo(l,u);let kt=Math.cos(B)*v+l,tt=Math.sin(B)*v+u;e.lineTo(kt,tt);let At=Math.cos(ot)*v+l,nt=Math.sin(ot)*v+u;e.lineTo(At,nt)}e.closePath()}function Vg(e,t,n,s,a){let{fullCircles:r,startAngle:l,circumference:u}=t,f=t.endAngle;if(r){xr(e,t,n,s,f,a);for(let m=0;m<r;++m)e.fill();isNaN(u)||(f=l+(u%Qt||Qt))}return xr(e,t,n,s,f,a),e.fill(),f}function Zg(e,t,n,s,a){let{fullCircles:r,startAngle:l,circumference:u,options:f}=t,{borderWidth:m,borderJoinStyle:_,borderDash:v,borderDashOffset:y}=f,w=f.borderAlign==="inner";if(!m)return;e.setLineDash(v||[]),e.lineDashOffset=y,w?(e.lineWidth=m*2,e.lineJoin=_||"round"):(e.lineWidth=m,e.lineJoin=_||"bevel");let k=t.endAngle;if(r){xr(e,t,n,s,k,a);for(let A=0;A<r;++A)e.stroke();isNaN(u)||(k=l+(u%Qt||Qt))}w&&Bg(e,t,k),r||(xr(e,t,n,s,k,a),e.stroke())}var As=class extends ki{circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,s){let a=this.getProps(["x","y"],s),{angle:r,distance:l}=Ha(a,{x:t,y:n}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:_,circumference:v}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),y=(this.options.spacing+this.options.borderWidth)/2,k=pt(v,f-u)>=Qt||Ss(r,u,f),A=on(l,m+y,_+y);return k&&A}getCenterPoint(t){let{x:n,y:s,startAngle:a,endAngle:r,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,_=(a+r)/2,v=(l+u+m+f)/2;return{x:n+Math.cos(_)*v,y:s+Math.sin(_)*v}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){let{options:n,circumference:s}=this,a=(n.offset||0)/4,r=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Qt?Math.floor(s/Qt):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let u=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(u)*a,Math.sin(u)*a);let f=1-Math.sin(Math.min(ie,s||0)),m=a*f;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,Vg(t,this,m,r,l),Zg(t,this,m,r,l),t.restore()}};st(As,"id","arc"),st(As,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),st(As,"defaultRoutes",{backgroundColor:"backgroundColor"}),st(As,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function ld(e,t,n=t){e.lineCap=pt(n.borderCapStyle,t.borderCapStyle),e.setLineDash(pt(n.borderDash,t.borderDash)),e.lineDashOffset=pt(n.borderDashOffset,t.borderDashOffset),e.lineJoin=pt(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=pt(n.borderWidth,t.borderWidth),e.strokeStyle=pt(n.borderColor,t.borderColor)}function Wg(e,t,n){e.lineTo(n.x,n.y)}function Ug(e){return e.stepped?Sl:e.tension||e.cubicInterpolationMode==="monotone"?Pl:Wg}function cd(e,t,n={}){let s=e.length,{start:a=0,end:r=s-1}=n,{start:l,end:u}=t,f=Math.max(a,l),m=Math.min(r,u),_=a<l&&r<l||a>u&&r>u;return{count:s,start:f,loop:t.loop,ilen:m<f&&!_?s+m-f:m-f}}function qg(e,t,n,s){let{points:a,options:r}=t,{count:l,start:u,loop:f,ilen:m}=cd(a,n,s),_=Ug(r),{move:v=!0,reverse:y}=s||{},w,k,A;for(w=0;w<=m;++w)k=a[(u+(y?m-w:w))%l],!k.skip&&(v?(e.moveTo(k.x,k.y),v=!1):_(e,A,k,y,r.stepped),A=k);return f&&(k=a[(u+(y?m:0))%l],_(e,A,k,y,r.stepped)),!!f}function Yg(e,t,n,s){let a=t.points,{count:r,start:l,ilen:u}=cd(a,n,s),{move:f=!0,reverse:m}=s||{},_=0,v=0,y,w,k,A,E,D,z=W=>(l+(m?u-W:W))%r,V=()=>{A!==E&&(e.lineTo(_,E),e.lineTo(_,A),e.lineTo(_,D))};for(f&&(w=a[z(0)],e.moveTo(w.x,w.y)),y=0;y<=u;++y){if(w=a[z(y)],w.skip)continue;let W=w.x,H=w.y,X=W|0;X===k?(H<A?A=H:H>E&&(E=H),_=(v*_+W)/++v):(V(),e.lineTo(W,H),k=X,v=0,A=E=H),D=H}V()}function Ql(e){let t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?Yg:qg}function Xg(e){return e.stepped?Il:e.tension||e.cubicInterpolationMode==="monotone"?Ol:zn}function Gg(e,t,n,s){let a=t._path;a||(a=t._path=new Path2D,t.path(a,n,s)&&a.closePath()),ld(e,t.options),e.stroke(a)}function $g(e,t,n,s){let{segments:a,options:r}=t,l=Ql(t);for(let u of a)ld(e,r,u.style),e.beginPath(),l(e,t,u,{start:n,end:n+s-1})&&e.closePath(),e.stroke()}var Kg=typeof Path2D=="function";function Jg(e,t,n,s){Kg&&!t.options.segment?Gg(e,t,n,s):$g(e,t,n,s)}var yn=class extends ki{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){let s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){let a=s.spanGaps?this._loop:this._fullLoop;kl(this._points,s,t,a,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Dl(this,this.options.segment))}first(){let t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){let t=this.segments,n=this.points,s=t.length;return s&&n[t[s-1].end]}interpolate(t,n){let s=this.options,a=t[n],r=this.points,l=cr(this,{property:n,start:a,end:a});if(!l.length)return;let u=[],f=Xg(s),m,_;for(m=0,_=l.length;m<_;++m){let{start:v,end:y}=l[m],w=r[v],k=r[y];if(w===k){u.push(w);continue}let A=Math.abs((a-w[n])/(k[n]-w[n])),E=f(w,k,A,s.stepped);E[n]=t[n],u.push(E)}return u.length===1?u[0]:u}pathSegment(t,n,s){return Ql(this)(t,this,n,s)}path(t,n,s){let a=this.segments,r=Ql(this),l=this._loop;n=n||0,s=s||this.points.length-n;for(let u of a)l&=r(t,this,u,{start:n,end:n+s-1});return!!l}draw(t,n,s,a){let r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),Jg(t,this,s,a),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}};st(yn,"id","line"),st(yn,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),st(yn,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),st(yn,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Cu(e,t,n,s){let a=e.options,{[n]:r}=e.getProps([n],s);return Math.abs(t-r)<a.radius+a.hitRadius}var co=class extends ki{parsed;skip;stop;constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,s){let a=this.options,{x:r,y:l}=this.getProps(["x","y"],s);return Math.pow(t-r,2)+Math.pow(n-l,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(t,n){return Cu(this,t,"x",n)}inYRange(t,n){return Cu(this,t,"y",n)}getCenterPoint(t){let{x:n,y:s}=this.getProps(["x","y"],t);return{x:n,y:s}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);let s=n&&t.borderWidth||0;return(n+s)*2}draw(t,n){let s=this.options;this.skip||s.radius<.1||!nn(this,n,this.size(s)/2)||(t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.fillStyle=s.backgroundColor,Do(t,s,this.x,this.y))}getRange(){let t=this.options||{};return t.radius+t.hitRadius}};st(co,"id","point"),st(co,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),st(co,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function hd(e,t){let{x:n,y:s,base:a,width:r,height:l}=e.getProps(["x","y","base","width","height"],t),u,f,m,_,v;return e.horizontal?(v=l/2,u=Math.min(n,a),f=Math.max(n,a),m=s-v,_=s+v):(v=r/2,u=n-v,f=n+v,m=Math.min(s,a),_=Math.max(s,a)),{left:u,top:m,right:f,bottom:_}}function ls(e,t,n,s){return e?0:we(t,n,s)}function Qg(e,t,n){let s=e.options.borderWidth,a=e.borderSkipped,r=Qa(s);return{t:ls(a.top,r.top,0,n),r:ls(a.right,r.right,0,t),b:ls(a.bottom,r.bottom,0,n),l:ls(a.left,r.left,0,t)}}function t_(e,t,n){let{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),a=e.options.borderRadius,r=Bn(a),l=Math.min(t,n),u=e.borderSkipped,f=s||Ot(a);return{topLeft:ls(!f||u.top||u.left,r.topLeft,0,l),topRight:ls(!f||u.top||u.right,r.topRight,0,l),bottomLeft:ls(!f||u.bottom||u.left,r.bottomLeft,0,l),bottomRight:ls(!f||u.bottom||u.right,r.bottomRight,0,l)}}function e_(e){let t=hd(e),n=t.right-t.left,s=t.bottom-t.top,a=Qg(e,n/2,s/2),r=t_(e,n/2,s/2);return{outer:{x:t.left,y:t.top,w:n,h:s,radius:r},inner:{x:t.left+a.l,y:t.top+a.t,w:n-a.l-a.r,h:s-a.t-a.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,r.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(a.b,a.r))}}}}function Hl(e,t,n,s){let a=t===null,r=n===null,u=e&&!(a&&r)&&hd(e,s);return u&&(a||on(t,u.left,u.right))&&(r||on(n,u.top,u.bottom))}function i_(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function n_(e,t){e.rect(t.x,t.y,t.w,t.h)}function Vl(e,t,n={}){let s=e.x!==n.x?-t:0,a=e.y!==n.y?-t:0,r=(e.x+e.w!==n.x+n.w?t:0)-s,l=(e.y+e.h!==n.y+n.h?t:0)-a;return{x:e.x+s,y:e.y+a,w:e.w+r,h:e.h+l,radius:e.radius}}var ho=class extends ki{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){let{inflateAmount:n,options:{borderColor:s,backgroundColor:a}}=this,{inner:r,outer:l}=e_(this),u=i_(l.radius)?Ts:n_;t.save(),(l.w!==r.w||l.h!==r.h)&&(t.beginPath(),u(t,Vl(l,n,r)),t.clip(),u(t,Vl(r,-n,l)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),u(t,Vl(r,n)),t.fillStyle=a,t.fill(),t.restore()}inRange(t,n,s){return Hl(this,t,n,s)}inXRange(t,n){return Hl(this,t,null,n)}inYRange(t,n){return Hl(this,null,t,n)}getCenterPoint(t){let{x:n,y:s,base:a,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(n+a)/2:n,y:r?s:(s+a)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}};st(ho,"id","bar"),st(ho,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),st(ho,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var s_=Object.freeze({__proto__:null,ArcElement:As,BarElement:ho,LineElement:yn,PointElement:co}),tc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],ku=tc.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function ud(e){return tc[e%tc.length]}function dd(e){return ku[e%ku.length]}function o_(e,t){return e.borderColor=ud(t),e.backgroundColor=dd(t),++t}function a_(e,t){return e.backgroundColor=e.data.map(()=>ud(t++)),t}function r_(e,t){return e.backgroundColor=e.data.map(()=>dd(t++)),t}function l_(e){let t=0;return(n,s)=>{let a=e.getDatasetMeta(s).controller;a instanceof Vn?t=a_(n,t):a instanceof Is?t=r_(n,t):a&&(t=o_(n,t))}}function Au(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function c_(e){return e&&(e.borderColor||e.backgroundColor)}var h_={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,n){if(!n.enabled)return;let{data:{datasets:s},options:a}=e.config,{elements:r}=a;if(!n.forceOverride&&(Au(s)||c_(a)||r&&Au(r)))return;let l=l_(e);s.forEach(l)}};function u_(e,t,n,s,a){let r=a.samples||s;if(r>=n)return e.slice(t,t+n);let l=[],u=(n-2)/(r-2),f=0,m=t+n-1,_=t,v,y,w,k,A;for(l[f++]=e[_],v=0;v<r-2;v++){let E=0,D=0,z,V=Math.floor((v+1)*u)+1+t,W=Math.min(Math.floor((v+2)*u)+1,n)+t,H=W-V;for(z=V;z<W;z++)E+=e[z].x,D+=e[z].y;E/=H,D/=H;let X=Math.floor(v*u)+1+t,$=Math.min(Math.floor((v+1)*u)+1,n)+t,{x:G,y:B}=e[_];for(w=k=-1,z=X;z<$;z++)k=.5*Math.abs((G-E)*(e[z].y-B)-(G-e[z].x)*(D-B)),k>w&&(w=k,y=e[z],A=z);l[f++]=y,_=A}return l[f++]=e[m],l}function d_(e,t,n,s){let a=0,r=0,l,u,f,m,_,v,y,w,k,A,E=[],D=t+n-1,z=e[t].x,W=e[D].x-z;for(l=t;l<t+n;++l){u=e[l],f=(u.x-z)/W*s,m=u.y;let H=f|0;if(H===_)m<k?(k=m,v=l):m>A&&(A=m,y=l),a=(r*a+u.x)/++r;else{let X=l-1;if(!Nt(v)&&!Nt(y)){let $=Math.min(v,y),G=Math.max(v,y);$!==w&&$!==X&&E.push({...e[$],x:a}),G!==w&&G!==X&&E.push({...e[G],x:a})}l>0&&X!==w&&E.push(e[X]),E.push(u),_=H,r=0,k=A=m,v=y=w=l}}return E}function fd(e){if(e._decimated){let t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function Eu(e){e.data.datasets.forEach(t=>{fd(t)})}function f_(e,t){let n=t.length,s=0,a,{iScale:r}=e,{min:l,max:u,minDefined:f,maxDefined:m}=r.getUserBounds();return f&&(s=we(en(t,r.axis,l).lo,0,n-1)),m?a=we(en(t,r.axis,u).hi+1,s,n)-s:a=n-s,{start:s,count:a}}var p_={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){Eu(e);return}let s=e.width;e.data.datasets.forEach((a,r)=>{let{_data:l,indexAxis:u}=a,f=e.getDatasetMeta(r),m=l||a.data;if(Ls([u,e.options.indexAxis])==="y"||!f.controller.supportsDecimation)return;let _=e.scales[f.xAxisID];if(_.type!=="linear"&&_.type!=="time"||e.options.parsing)return;let{start:v,count:y}=f_(f,m),w=n.threshold||4*s;if(y<=w){fd(a);return}Nt(l)&&(a._data=m,delete a.data,Object.defineProperty(a,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(A){this._data=A}}));let k;switch(n.algorithm){case"lttb":k=u_(m,v,y,s,n);break;case"min-max":k=d_(m,v,y,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}a._decimated=k})},destroy(e){Eu(e)}};function m_(e,t,n){let s=e.segments,a=e.points,r=t.points,l=[];for(let u of s){let{start:f,end:m}=u;m=nc(f,m,a);let _=ec(n,a[f],a[m],u.loop);if(!t.segments){l.push({source:u,target:_,start:a[f],end:a[m]});continue}let v=cr(t,_);for(let y of v){let w=ec(n,r[y.start],r[y.end],y.loop),k=lr(u,a,w);for(let A of k)l.push({source:A,target:y,start:{[n]:Iu(_,w,"start",Math.max)},end:{[n]:Iu(_,w,"end",Math.min)}})}}return l}function ec(e,t,n,s){if(s)return;let a=t[e],r=n[e];return e==="angle"&&(a=ci(a),r=ci(r)),{property:e,start:a,end:r}}function g_(e,t){let{x:n=null,y:s=null}=e||{},a=t.points,r=[];return t.segments.forEach(({start:l,end:u})=>{u=nc(l,u,a);let f=a[l],m=a[u];s!==null?(r.push({x:f.x,y:s}),r.push({x:m.x,y:s})):n!==null&&(r.push({x:n,y:f.y}),r.push({x:n,y:m.y}))}),r}function nc(e,t,n){for(;t>e;t--){let s=n[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function Iu(e,t,n,s){return e&&t?s(e[n],t[n]):e?e[n]:t?t[n]:0}function pd(e,t){let n=[],s=!1;return Jt(e)?(s=!0,n=e):n=g_(e,t),n.length?new yn({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function Ou(e){return e&&e.fill!==!1}function __(e,t,n){let a=e[t].fill,r=[t],l;if(!n)return a;for(;a!==!1&&r.indexOf(a)===-1;){if(!he(a))return a;if(l=e[a],!l)return!1;if(l.visible)return a;r.push(a),a=l.fill}return!1}function v_(e,t,n){let s=w_(e);if(Ot(s))return isNaN(s.value)?!1:s;let a=parseFloat(s);return he(a)&&Math.floor(a)===a?b_(s[0],t,a,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function b_(e,t,n,s){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=s?!1:n}function y_(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:Ot(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function x_(e,t,n){let s;return e==="start"?s=n:e==="end"?s=t.options.reverse?t.min:t.max:Ot(e)?s=e.value:s=t.getBaseValue(),s}function w_(e){let t=e.options,n=t.fill,s=pt(n&&n.target,n);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function M_(e){let{scale:t,index:n,line:s}=e,a=[],r=s.segments,l=s.points,u=S_(t,n);u.push(pd({x:null,y:t.bottom},s));for(let f=0;f<r.length;f++){let m=r[f];for(let _=m.start;_<=m.end;_++)P_(a,l[_],u)}return new yn({points:a,options:{}})}function S_(e,t){let n=[],s=e.getMatchingVisibleMetas("line");for(let a=0;a<s.length;a++){let r=s[a];if(r.index===t)break;r.hidden||n.unshift(r.dataset)}return n}function P_(e,t,n){let s=[];for(let a=0;a<n.length;a++){let r=n[a],{first:l,last:u,point:f}=T_(r,t,"x");if(!(!f||l&&u)){if(l)s.unshift(f);else if(e.push(f),!u)break}}e.push(...s)}function T_(e,t,n){let s=e.interpolate(t,n);if(!s)return{};let a=s[n],r=e.segments,l=e.points,u=!1,f=!1;for(let m=0;m<r.length;m++){let _=r[m],v=l[_.start][n],y=l[_.end][n];if(on(a,v,y)){u=a===v,f=a===y;break}}return{first:u,last:f,point:s}}var wr=class{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,s){let{x:a,y:r,radius:l}=this;return n=n||{start:0,end:Qt},t.arc(a,r,l,n.end,n.start,!0),!s.bounds}interpolate(t){let{x:n,y:s,radius:a}=this,r=t.angle;return{x:n+Math.cos(r)*a,y:s+Math.sin(r)*a,angle:r}}};function L_(e){let{chart:t,fill:n,line:s}=e;if(he(n))return C_(t,n);if(n==="stack")return M_(e);if(n==="shape")return!0;let a=k_(e);return a instanceof wr?a:pd(a,s)}function C_(e,t){let n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function k_(e){return(e.scale||{}).getPointPositionForValue?E_(e):A_(e)}function A_(e){let{scale:t={},fill:n}=e,s=y_(n,t);if(he(s)){let a=t.isHorizontal();return{x:a?s:null,y:a?null:s}}return null}function E_(e){let{scale:t,fill:n}=e,s=t.options,a=t.getLabels().length,r=s.reverse?t.max:t.min,l=x_(n,t,r),u=[];if(s.grid.circular){let f=t.getPointPositionForValue(0,r);return new wr({x:f.x,y:f.y,radius:t.getDistanceFromCenterForValue(l)})}for(let f=0;f<a;++f)u.push(t.getPointPositionForValue(f,l));return u}function Zl(e,t,n){let s=L_(t),{line:a,scale:r,axis:l}=t,u=a.options,f=u.fill,m=u.backgroundColor,{above:_=m,below:v=m}=f||{};s&&a.points.length&&(eo(e,n),I_(e,{line:a,target:s,above:_,below:v,area:n,scale:r,axis:l}),io(e))}function I_(e,t){let{line:n,target:s,above:a,below:r,area:l,scale:u}=t,f=n._loop?"angle":t.axis;e.save(),f==="x"&&r!==a&&(Du(e,s,l.top),Ru(e,{line:n,target:s,color:a,scale:u,property:f}),e.restore(),e.save(),Du(e,s,l.bottom)),Ru(e,{line:n,target:s,color:r,scale:u,property:f}),e.restore()}function Du(e,t,n){let{segments:s,points:a}=t,r=!0,l=!1;e.beginPath();for(let u of s){let{start:f,end:m}=u,_=a[f],v=a[nc(f,m,a)];r?(e.moveTo(_.x,_.y),r=!1):(e.lineTo(_.x,n),e.lineTo(_.x,_.y)),l=!!t.pathSegment(e,u,{move:l}),l?e.closePath():e.lineTo(v.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Ru(e,t){let{line:n,target:s,property:a,color:r,scale:l}=t,u=m_(n,s,a);for(let{source:f,target:m,start:_,end:v}of u){let{style:{backgroundColor:y=r}={}}=f,w=s!==!0;e.save(),e.fillStyle=y,O_(e,l,w&&ec(a,_,v)),e.beginPath();let k=!!n.pathSegment(e,f),A;if(w){k?e.closePath():zu(e,s,v,a);let E=!!s.pathSegment(e,m,{move:k,reverse:!0});A=k&&E,A||zu(e,s,_,a)}e.closePath(),e.fill(A?"evenodd":"nonzero"),e.restore()}}function O_(e,t,n){let{top:s,bottom:a}=t.chart.chartArea,{property:r,start:l,end:u}=n||{};r==="x"&&(e.beginPath(),e.rect(l,s,u-l,a-s),e.clip())}function zu(e,t,n,s){let a=t.interpolate(n,s);a&&e.lineTo(a.x,a.y)}var D_={id:"filler",afterDatasetsUpdate(e,t,n){let s=(e.data.datasets||[]).length,a=[],r,l,u,f;for(l=0;l<s;++l)r=e.getDatasetMeta(l),u=r.dataset,f=null,u&&u.options&&u instanceof yn&&(f={visible:e.isDatasetVisible(l),index:l,fill:v_(u,l,s),chart:e,axis:r.controller.options.indexAxis,scale:r.vScale,line:u}),r.$filler=f,a.push(f);for(l=0;l<s;++l)f=a[l],!(!f||f.fill===!1)&&(f.fill=__(a,l,n.propagate))},beforeDraw(e,t,n){let s=n.drawTime==="beforeDraw",a=e.getSortedVisibleDatasetMetas(),r=e.chartArea;for(let l=a.length-1;l>=0;--l){let u=a[l].$filler;!u||(u.line.updateControlPoints(r,u.axis),s&&u.fill&&Zl(e.ctx,u,r))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;let s=e.getSortedVisibleDatasetMetas();for(let a=s.length-1;a>=0;--a){let r=s[a].$filler;Ou(r)&&Zl(e.ctx,r,e.chartArea)}},beforeDatasetDraw(e,t,n){let s=t.meta.$filler;!Ou(s)||n.drawTime!=="beforeDatasetDraw"||Zl(e.ctx,s,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},Fu=(e,t)=>{let{boxHeight:n=t,boxWidth:s=t}=e;return e.usePointStyle&&(n=Math.min(n,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(t,n)}},R_=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index,Mr=class extends ki{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,s){this.maxWidth=t,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let t=this.options.labels||{},n=bt(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(s=>t.filter(s,this.chart.data))),t.sort&&(n=n.sort((s,a)=>t.sort(s,a,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){let{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}let s=t.labels,a=me(s.font),r=a.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:f}=Fu(s,r),m,_;n.font=a.string,this.isHorizontal()?(m=this.maxWidth,_=this._fitRows(l,r,u,f)+10):(_=this.maxHeight,m=this._fitCols(l,a,u,f)+10),this.width=Math.min(m,t.maxWidth||this.maxWidth),this.height=Math.min(_,t.maxHeight||this.maxHeight)}_fitRows(t,n,s,a){let{ctx:r,maxWidth:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.lineWidths=[0],_=a+u,v=t;r.textAlign="left",r.textBaseline="middle";let y=-1,w=-_;return this.legendItems.forEach((k,A)=>{let E=s+n/2+r.measureText(k.text).width;(A===0||m[m.length-1]+E+2*u>l)&&(v+=_,m[m.length-(A>0?0:1)]=0,w+=_,y++),f[A]={left:0,top:w,row:y,width:E,height:a},m[m.length-1]+=E+u}),v}_fitCols(t,n,s,a){let{ctx:r,maxHeight:l,options:{labels:{padding:u}}}=this,f=this.legendHitBoxes=[],m=this.columnSizes=[],_=l-t,v=u,y=0,w=0,k=0,A=0;return this.legendItems.forEach((E,D)=>{let{itemWidth:z,itemHeight:V}=z_(s,n,r,E,a);D>0&&w+V+2*u>_&&(v+=y+u,m.push({width:y,height:w}),k+=y+u,A++,y=w=0),f[D]={left:k,top:w,col:A,width:z,height:V},y=Math.max(y,z),w+=V+u}),v+=y,m.push({width:y,height:w}),v}adjustHitBoxes(){if(!this.options.display)return;let t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:a},rtl:r}}=this,l=rs(r,this.left,this.width);if(this.isHorizontal()){let u=0,f=Re(s,this.left+a,this.right-this.lineWidths[u]);for(let m of n)u!==m.row&&(u=m.row,f=Re(s,this.left+a,this.right-this.lineWidths[u])),m.top+=this.top+t+a,m.left=l.leftForLtr(l.x(f),m.width),f+=m.width+a}else{let u=0,f=Re(s,this.top+t+a,this.bottom-this.columnSizes[u].height);for(let m of n)m.col!==u&&(u=m.col,f=Re(s,this.top+t+a,this.bottom-this.columnSizes[u].height)),m.top=f,m.left+=this.left+a,m.left=l.leftForLtr(l.x(m.left),m.width),f+=m.height+a}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let t=this.ctx;eo(t,this),this._draw(),io(t)}}_draw(){let{options:t,columnSizes:n,lineWidths:s,ctx:a}=this,{align:r,labels:l}=t,u=de.color,f=rs(t.rtl,this.left,this.width),m=me(l.font),{padding:_}=l,v=m.size,y=v/2,w;this.drawTitle(),a.textAlign=f.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=m.string;let{boxWidth:k,boxHeight:A,itemHeight:E}=Fu(l,v),D=function(X,$,G){if(isNaN(k)||k<=0||isNaN(A)||A<0)return;a.save();let B=pt(G.lineWidth,1);if(a.fillStyle=pt(G.fillStyle,u),a.lineCap=pt(G.lineCap,"butt"),a.lineDashOffset=pt(G.lineDashOffset,0),a.lineJoin=pt(G.lineJoin,"miter"),a.lineWidth=B,a.strokeStyle=pt(G.strokeStyle,u),a.setLineDash(pt(G.lineDash,[])),l.usePointStyle){let ot={radius:A*Math.SQRT2/2,pointStyle:G.pointStyle,rotation:G.rotation,borderWidth:B},ut=f.xPlus(X,k/2),Q=$+y;Ja(a,ot,ut,Q,l.pointStyleWidth&&k)}else{let ot=$+Math.max((v-A)/2,0),ut=f.leftForLtr(X,k),Q=Bn(G.borderRadius);a.beginPath(),Object.values(Q).some($t=>$t!==0)?Ts(a,{x:ut,y:ot,w:k,h:A,radius:Q}):a.rect(ut,ot,k,A),a.fill(),B!==0&&a.stroke()}a.restore()},z=function(X,$,G){Nn(a,G.text,X,$+E/2,m,{strikethrough:G.hidden,textAlign:f.textAlign(G.textAlign)})},V=this.isHorizontal(),W=this._computeTitleHeight();V?w={x:Re(r,this.left+_,this.right-s[0]),y:this.top+_+W,line:0}:w={x:this.left+_,y:Re(r,this.top+W+_,this.bottom-n[0].height),line:0},ar(this.ctx,t.textDirection);let H=E+_;this.legendItems.forEach((X,$)=>{a.strokeStyle=X.fontColor,a.fillStyle=X.fontColor;let G=a.measureText(X.text).width,B=f.textAlign(X.textAlign||(X.textAlign=l.textAlign)),ot=k+y+G,ut=w.x,Q=w.y;f.setWidth(this.width),V?$>0&&ut+ot+_>this.right&&(Q=w.y+=H,w.line++,ut=w.x=Re(r,this.left+_,this.right-s[w.line])):$>0&&Q+H>this.bottom&&(ut=w.x=ut+n[w.line].width+_,w.line++,Q=w.y=Re(r,this.top+W+_,this.bottom-n[w.line].height));let $t=f.x(ut);if(D($t,Q,X),ut=wl(B,ut+k+y,V?ut+ot:this.right,t.rtl),z(f.x(ut),Q,X),V)w.x+=ot+_;else if(typeof X.text!="string"){let St=m.lineHeight;w.y+=md(X,St)}else w.y+=H}),rr(this.ctx,t.textDirection)}drawTitle(){let t=this.options,n=t.title,s=me(n.font),a=ze(n.padding);if(!n.display)return;let r=rs(t.rtl,this.left,this.width),l=this.ctx,u=n.position,f=s.size/2,m=a.top+f,_,v=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),_=this.top+m,v=Re(t.align,v,this.right-y);else{let k=this.columnSizes.reduce((A,E)=>Math.max(A,E.height),0);_=m+Re(t.align,this.top,this.bottom-k-t.labels.padding-this._computeTitleHeight())}let w=Re(u,v,v+y);l.textAlign=r.textAlign(Io(u)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=s.string,Nn(l,n.text,w,_,s)}_computeTitleHeight(){let t=this.options.title,n=me(t.font),s=ze(t.padding);return t.display?n.lineHeight+s.height:0}_getLegendItemAt(t,n){let s,a,r;if(on(t,this.left,this.right)&&on(n,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(a=r[s],on(t,a.left,a.left+a.width)&&on(n,a.top,a.top+a.height))return this.legendItems[s]}return null}handleEvent(t){let n=this.options;if(!B_(t.type,n))return;let s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){let a=this._hoveredItem,r=R_(a,s);a&&!r&&bt(n.onLeave,[t,a,this],this),this._hoveredItem=s,s&&!r&&bt(n.onHover,[t,s,this],this)}else s&&bt(n.onClick,[t,s,this],this)}};function z_(e,t,n,s,a){let r=F_(s,e,t,n),l=N_(a,s,t.lineHeight);return{itemWidth:r,itemHeight:l}}function F_(e,t,n,s){let a=e.text;return a&&typeof a!="string"&&(a=a.reduce((r,l)=>r.length>l.length?r:l)),t+n.size/2+s.measureText(a).width}function N_(e,t,n){let s=e;return typeof t.text!="string"&&(s=md(t,n)),s}function md(e,t){let n=e.text?e.text.length+.5:0;return t*n}function B_(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var j_={id:"legend",_element:Mr,start(e,t,n){let s=e.legend=new Mr({ctx:e.ctx,options:n,chart:e});ti.configure(e,s,n),ti.addBox(e,s)},stop(e){ti.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){let s=e.legend;ti.configure(e,s,n),s.options=n},afterUpdate(e){let t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){let s=t.datasetIndex,a=n.chart;a.isDatasetVisible(s)?(a.hide(s),t.hidden=!0):(a.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){let t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:a,color:r,useBorderRadius:l,borderRadius:u}}=e.legend.options;return e._getSortedDatasetMetas().map(f=>{let m=f.controller.getStyle(n?0:void 0),_=ze(m.borderWidth);return{text:t[f.index].label,fillStyle:m.backgroundColor,fontColor:r,hidden:!f.visible,lineCap:m.borderCapStyle,lineDash:m.borderDash,lineDashOffset:m.borderDashOffset,lineJoin:m.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:m.borderColor,pointStyle:s||m.pointStyle,rotation:m.rotation,textAlign:a||m.textAlign,borderRadius:l&&(u||m.borderRadius),datasetIndex:f.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}},Qo=class extends ki{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){let s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;let a=Jt(s.text)?s.text.length:1;this._padding=ze(s.padding);let r=a*me(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){let t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){let{top:n,left:s,bottom:a,right:r,options:l}=this,u=l.align,f=0,m,_,v;return this.isHorizontal()?(_=Re(u,s,r),v=n+t,m=r-s):(l.position==="left"?(_=s+t,v=Re(u,a,n),f=ie*-.5):(_=r-t,v=Re(u,n,a),f=ie*.5),m=a-n),{titleX:_,titleY:v,maxWidth:m,rotation:f}}draw(){let t=this.ctx,n=this.options;if(!n.display)return;let s=me(n.font),r=s.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:f,rotation:m}=this._drawArgs(r);Nn(t,n.text,0,0,s,{color:n.color,maxWidth:f,rotation:m,textAlign:Io(n.align),textBaseline:"middle",translation:[l,u]})}};function H_(e,t){let n=new Qo({ctx:e.ctx,options:t,chart:e});ti.configure(e,n,t),ti.addBox(e,n),e.titleBlock=n}var V_={id:"title",_element:Qo,start(e,t,n){H_(e,n)},stop(e){let t=e.titleBlock;ti.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){let s=e.titleBlock;ti.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},fr=new WeakMap,Z_={id:"subtitle",start(e,t,n){let s=new Qo({ctx:e.ctx,options:n,chart:e});ti.configure(e,s,n),ti.addBox(e,s),fr.set(e,s)},stop(e){ti.removeBox(e,fr.get(e)),fr.delete(e)},beforeUpdate(e,t,n){let s=fr.get(e);ti.configure(e,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Uo={average(e){if(!e.length)return!1;let t,n,s=0,a=0,r=0;for(t=0,n=e.length;t<n;++t){let l=e[t].element;if(l&&l.hasValue()){let u=l.tooltipPosition();s+=u.x,a+=u.y,++r}}return{x:s/r,y:a/r}},nearest(e,t){if(!e.length)return!1;let n=t.x,s=t.y,a=Number.POSITIVE_INFINITY,r,l,u;for(r=0,l=e.length;r<l;++r){let f=e[r].element;if(f&&f.hasValue()){let m=f.getCenterPoint(),_=Co(t,m);_<a&&(a=_,u=f)}}if(u){let f=u.tooltipPosition();n=f.x,s=f.y}return{x:n,y:s}}};function vn(e,t){return t&&(Jt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Hn(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function W_(e,t){let{element:n,datasetIndex:s,index:a}=t,r=e.getDatasetMeta(s).controller,{label:l,value:u}=r.getLabelAndValue(a);return{chart:e,label:l,parsed:r.getParsed(a),raw:e.data.datasets[s].data[a],formattedValue:u,dataset:r.getDataset(),dataIndex:a,datasetIndex:s,element:n}}function Nu(e,t){let n=e.chart.ctx,{body:s,footer:a,title:r}=e,{boxWidth:l,boxHeight:u}=t,f=me(t.bodyFont),m=me(t.titleFont),_=me(t.footerFont),v=r.length,y=a.length,w=s.length,k=ze(t.padding),A=k.height,E=0,D=s.reduce((W,H)=>W+H.before.length+H.lines.length+H.after.length,0);if(D+=e.beforeBody.length+e.afterBody.length,v&&(A+=v*m.lineHeight+(v-1)*t.titleSpacing+t.titleMarginBottom),D){let W=t.displayColors?Math.max(u,f.lineHeight):f.lineHeight;A+=w*W+(D-w)*f.lineHeight+(D-1)*t.bodySpacing}y&&(A+=t.footerMarginTop+y*_.lineHeight+(y-1)*t.footerSpacing);let z=0,V=function(W){E=Math.max(E,n.measureText(W).width+z)};return n.save(),n.font=m.string,Lt(e.title,V),n.font=f.string,Lt(e.beforeBody.concat(e.afterBody),V),z=t.displayColors?l+2+t.boxPadding:0,Lt(s,W=>{Lt(W.before,V),Lt(W.lines,V),Lt(W.after,V)}),z=0,n.font=_.string,Lt(e.footer,V),n.restore(),E+=k.width,{width:E,height:A}}function U_(e,t){let{y:n,height:s}=t;return n<s/2?"top":n>e.height-s/2?"bottom":"center"}function q_(e,t,n,s){let{x:a,width:r}=s,l=n.caretSize+n.caretPadding;if(e==="left"&&a+r+l>t.width||e==="right"&&a-r-l<0)return!0}function Y_(e,t,n,s){let{x:a,width:r}=n,{width:l,chartArea:{left:u,right:f}}=e,m="center";return s==="center"?m=a<=(u+f)/2?"left":"right":a<=r/2?m="left":a>=l-r/2&&(m="right"),q_(m,e,t,n)&&(m="center"),m}function Bu(e,t,n){let s=n.yAlign||t.yAlign||U_(e,n);return{xAlign:n.xAlign||t.xAlign||Y_(e,t,n,s),yAlign:s}}function X_(e,t){let{x:n,width:s}=e;return t==="right"?n-=s:t==="center"&&(n-=s/2),n}function G_(e,t,n){let{y:s,height:a}=e;return t==="top"?s+=n:t==="bottom"?s-=a+n:s-=a/2,s}function ju(e,t,n,s){let{caretSize:a,caretPadding:r,cornerRadius:l}=e,{xAlign:u,yAlign:f}=n,m=a+r,{topLeft:_,topRight:v,bottomLeft:y,bottomRight:w}=Bn(l),k=X_(t,u),A=G_(t,f,m);return f==="center"?u==="left"?k+=m:u==="right"&&(k-=m):u==="left"?k-=Math.max(_,y)+a:u==="right"&&(k+=Math.max(v,w)+a),{x:we(k,0,s.width-t.width),y:we(A,0,s.height-t.height)}}function pr(e,t,n){let s=ze(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function Hu(e){return vn([],Hn(e))}function $_(e,t,n){return _n(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Vu(e,t){let n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}var gd={beforeTitle:sn,title(e){if(e.length>0){let t=e[0],n=t.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return n[t.dataIndex]}return""},afterTitle:sn,beforeBody:sn,beforeLabel:sn,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");let n=e.formattedValue;return Nt(n)||(t+=n),t},labelColor(e){let n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){let n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:sn,afterBody:sn,beforeFooter:sn,footer:sn,afterFooter:sn};function vi(e,t,n,s){let a=e[t].call(n,s);return typeof a>"u"?gd[t].call(n,s):a}var $o=class extends ki{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let t=this._cachedAnimations;if(t)return t;let n=this.chart,s=this.options.setContext(this.getContext()),a=s.enabled&&n.options.animation&&s.animations,r=new vr(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=$_(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){let{callbacks:s}=n,a=vi(s,"beforeTitle",this,t),r=vi(s,"title",this,t),l=vi(s,"afterTitle",this,t),u=[];return u=vn(u,Hn(a)),u=vn(u,Hn(r)),u=vn(u,Hn(l)),u}getBeforeBody(t,n){return Hu(vi(n.callbacks,"beforeBody",this,t))}getBody(t,n){let{callbacks:s}=n,a=[];return Lt(t,r=>{let l={before:[],lines:[],after:[]},u=Vu(s,r);vn(l.before,Hn(vi(u,"beforeLabel",this,r))),vn(l.lines,vi(u,"label",this,r)),vn(l.after,Hn(vi(u,"afterLabel",this,r))),a.push(l)}),a}getAfterBody(t,n){return Hu(vi(n.callbacks,"afterBody",this,t))}getFooter(t,n){let{callbacks:s}=n,a=vi(s,"beforeFooter",this,t),r=vi(s,"footer",this,t),l=vi(s,"afterFooter",this,t),u=[];return u=vn(u,Hn(a)),u=vn(u,Hn(r)),u=vn(u,Hn(l)),u}_createItems(t){let n=this._active,s=this.chart.data,a=[],r=[],l=[],u=[],f,m;for(f=0,m=n.length;f<m;++f)u.push(W_(this.chart,n[f]));return t.filter&&(u=u.filter((_,v,y)=>t.filter(_,v,y,s))),t.itemSort&&(u=u.sort((_,v)=>t.itemSort(_,v,s))),Lt(u,_=>{let v=Vu(t.callbacks,_);a.push(vi(v,"labelColor",this,_)),r.push(vi(v,"labelPointStyle",this,_)),l.push(vi(v,"labelTextColor",this,_))}),this.labelColors=a,this.labelPointStyles=r,this.labelTextColors=l,this.dataPoints=u,u}update(t,n){let s=this.options.setContext(this.getContext()),a=this._active,r,l=[];if(!a.length)this.opacity!==0&&(r={opacity:0});else{let u=Uo[s.position].call(this,a,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);let f=this._size=Nu(this,s),m=Object.assign({},u,f),_=Bu(this.chart,s,m),v=ju(s,m,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,r={opacity:1,x:v.x,y:v.y,width:f.width,height:f.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,s,a){let r=this.getCaretPosition(t,s,a);n.lineTo(r.x1,r.y1),n.lineTo(r.x2,r.y2),n.lineTo(r.x3,r.y3)}getCaretPosition(t,n,s){let{xAlign:a,yAlign:r}=this,{caretSize:l,cornerRadius:u}=s,{topLeft:f,topRight:m,bottomLeft:_,bottomRight:v}=Bn(u),{x:y,y:w}=t,{width:k,height:A}=n,E,D,z,V,W,H;return r==="center"?(W=w+A/2,a==="left"?(E=y,D=E-l,V=W+l,H=W-l):(E=y+k,D=E+l,V=W-l,H=W+l),z=E):(a==="left"?D=y+Math.max(f,_)+l:a==="right"?D=y+k-Math.max(m,v)-l:D=this.caretX,r==="top"?(V=w,W=V-l,E=D-l,z=D+l):(V=w+A,W=V+l,E=D+l,z=D-l),H=V),{x1:E,x2:D,x3:z,y1:V,y2:W,y3:H}}drawTitle(t,n,s){let a=this.title,r=a.length,l,u,f;if(r){let m=rs(s.rtl,this.x,this.width);for(t.x=pr(this,s.titleAlign,s),n.textAlign=m.textAlign(s.titleAlign),n.textBaseline="middle",l=me(s.titleFont),u=s.titleSpacing,n.fillStyle=s.titleColor,n.font=l.string,f=0;f<r;++f)n.fillText(a[f],m.x(t.x),t.y+l.lineHeight/2),t.y+=l.lineHeight+u,f+1===r&&(t.y+=s.titleMarginBottom-u)}}_drawColorBox(t,n,s,a,r){let l=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:f,boxWidth:m}=r,_=me(r.bodyFont),v=pr(this,"left",r),y=a.x(v),w=f<_.lineHeight?(_.lineHeight-f)/2:0,k=n.y+w;if(r.usePointStyle){let A={radius:Math.min(m,f)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},E=a.leftForLtr(y,m)+m/2,D=k+f/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,Do(t,A,E,D),t.strokeStyle=l.borderColor,t.fillStyle=l.backgroundColor,Do(t,A,E,D)}else{t.lineWidth=Ot(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,t.strokeStyle=l.borderColor,t.setLineDash(l.borderDash||[]),t.lineDashOffset=l.borderDashOffset||0;let A=a.leftForLtr(y,m),E=a.leftForLtr(a.xPlus(y,1),m-2),D=Bn(l.borderRadius);Object.values(D).some(z=>z!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Ts(t,{x:A,y:k,w:m,h:f,radius:D}),t.fill(),t.stroke(),t.fillStyle=l.backgroundColor,t.beginPath(),Ts(t,{x:E,y:k+1,w:m-2,h:f-2,radius:D}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(A,k,m,f),t.strokeRect(A,k,m,f),t.fillStyle=l.backgroundColor,t.fillRect(E,k+1,m-2,f-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,n,s){let{body:a}=this,{bodySpacing:r,bodyAlign:l,displayColors:u,boxHeight:f,boxWidth:m,boxPadding:_}=s,v=me(s.bodyFont),y=v.lineHeight,w=0,k=rs(s.rtl,this.x,this.width),A=function(G){n.fillText(G,k.x(t.x+w),t.y+y/2),t.y+=y+r},E=k.textAlign(l),D,z,V,W,H,X,$;for(n.textAlign=l,n.textBaseline="middle",n.font=v.string,t.x=pr(this,E,s),n.fillStyle=s.bodyColor,Lt(this.beforeBody,A),w=u&&E!=="right"?l==="center"?m/2+_:m+2+_:0,W=0,X=a.length;W<X;++W){for(D=a[W],z=this.labelTextColors[W],n.fillStyle=z,Lt(D.before,A),V=D.lines,u&&V.length&&(this._drawColorBox(n,t,W,k,s),y=Math.max(v.lineHeight,f)),H=0,$=V.length;H<$;++H)A(V[H]),y=v.lineHeight;Lt(D.after,A)}w=0,y=v.lineHeight,Lt(this.afterBody,A),t.y-=r}drawFooter(t,n,s){let a=this.footer,r=a.length,l,u;if(r){let f=rs(s.rtl,this.x,this.width);for(t.x=pr(this,s.footerAlign,s),t.y+=s.footerMarginTop,n.textAlign=f.textAlign(s.footerAlign),n.textBaseline="middle",l=me(s.footerFont),n.fillStyle=s.footerColor,n.font=l.string,u=0;u<r;++u)n.fillText(a[u],f.x(t.x),t.y+l.lineHeight/2),t.y+=l.lineHeight+s.footerSpacing}}drawBackground(t,n,s,a){let{xAlign:r,yAlign:l}=this,{x:u,y:f}=t,{width:m,height:_}=s,{topLeft:v,topRight:y,bottomLeft:w,bottomRight:k}=Bn(a.cornerRadius);n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.beginPath(),n.moveTo(u+v,f),l==="top"&&this.drawCaret(t,n,s,a),n.lineTo(u+m-y,f),n.quadraticCurveTo(u+m,f,u+m,f+y),l==="center"&&r==="right"&&this.drawCaret(t,n,s,a),n.lineTo(u+m,f+_-k),n.quadraticCurveTo(u+m,f+_,u+m-k,f+_),l==="bottom"&&this.drawCaret(t,n,s,a),n.lineTo(u+w,f+_),n.quadraticCurveTo(u,f+_,u,f+_-w),l==="center"&&r==="left"&&this.drawCaret(t,n,s,a),n.lineTo(u,f+v),n.quadraticCurveTo(u,f,u+v,f),n.closePath(),n.fill(),a.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){let n=this.chart,s=this.$animations,a=s&&s.x,r=s&&s.y;if(a||r){let l=Uo[t.position].call(this,this._active,this._eventPosition);if(!l)return;let u=this._size=Nu(this,t),f=Object.assign({},l,this._size),m=Bu(n,t,f),_=ju(t,f,m,n);(a._to!==_.x||r._to!==_.y)&&(this.xAlign=m.xAlign,this.yAlign=m.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(t){let n=this.options.setContext(this.getContext()),s=this.opacity;if(!s)return;this._updateAnimationTarget(n);let a={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;let l=ze(n.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&u&&(t.save(),t.globalAlpha=s,this.drawBackground(r,t,a,n),ar(t,n.textDirection),r.y+=l.top,this.drawTitle(r,t,n),this.drawBody(r,t,n),this.drawFooter(r,t,n),rr(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){let s=this._active,a=t.map(({datasetIndex:u,index:f})=>{let m=this.chart.getDatasetMeta(u);if(!m)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:m.data[f],index:f}}),r=!to(s,a),l=this._positionChanged(a,n);(r||l)&&(this._active=a,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let a=this.options,r=this._active||[],l=this._getActiveElements(t,r,n,s),u=this._positionChanged(l,t),f=n||!to(l,r)||u;return f&&(this._active=l,(a.enabled||a.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),f}_getActiveElements(t,n,s,a){let r=this.options;if(t.type==="mouseout")return[];if(!a)return n;let l=this.chart.getElementsAtEventForMode(t,r.mode,r,s);return r.reverse&&l.reverse(),l}_positionChanged(t,n){let{caretX:s,caretY:a,options:r}=this,l=Uo[r.position].call(this,t,n);return l!==!1&&(s!==l.x||a!==l.y)}};st($o,"positioners",Uo);var K_={id:"tooltip",_element:$o,positioners:Uo,afterInit(e,t,n){n&&(e.tooltip=new $o({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){let t=e.tooltip;if(t&&t._willRender()){let n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){let n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:gd},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},J_=Object.freeze({__proto__:null,Colors:h_,Decimation:p_,Filler:D_,Legend:j_,SubTitle:Z_,Title:V_,Tooltip:K_}),Q_=(e,t,n,s)=>(typeof t=="string"?(n=e.push(t)-1,s.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function tv(e,t,n,s){let a=e.indexOf(t);if(a===-1)return Q_(e,t,n,s);let r=e.lastIndexOf(t);return a!==r?n:a}var ev=(e,t)=>e===null?null:we(Math.round(e),0,t);function Zu(e){let t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var qo=class extends Zn{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){let n=this._addedLabels;if(n.length){let s=this.getLabels();for(let{index:a,label:r}of n)s[a]===r&&s.splice(a,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Nt(t))return null;let s=this.getLabels();return n=isFinite(n)&&s[n]===t?n:tv(s,t,pt(n,t),this._addedLabels),ev(n,s.length-1)}determineDataLimits(){let{minDefined:t,maxDefined:n}=this.getUserBounds(),{min:s,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),n||(a=this.getLabels().length-1)),this.min=s,this.max=a}buildTicks(){let t=this.min,n=this.max,s=this.options.offset,a=[],r=this.getLabels();r=t===0&&n===r.length-1?r:r.slice(t,n+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let l=t;l<=n;l++)a.push({value:l});return a}getLabelForValue(t){return Zu.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){let n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}};st(qo,"id","category"),st(qo,"defaults",{ticks:{callback:Zu}});function iv(e,t){let n=[],{bounds:a,step:r,min:l,max:u,precision:f,count:m,maxTicks:_,maxDigits:v,includeBounds:y}=e,w=r||1,k=_-1,{min:A,max:E}=t,D=!Nt(l),z=!Nt(u),V=!Nt(m),W=(E-A)/(v+1),H=Na((E-A)/k/w)*w,X,$,G,B;if(H<1e-14&&!D&&!z)return[{value:A},{value:E}];B=Math.ceil(E/H)-Math.floor(A/H),B>k&&(H=Na(B*H/k/w)*w),Nt(f)||(X=Math.pow(10,f),H=Math.ceil(H*X)/X),a==="ticks"?($=Math.floor(A/H)*H,G=Math.ceil(E/H)*H):($=A,G=E),D&&z&&r&&gl((u-l)/r,H/1e3)?(B=Math.round(Math.min((u-l)/H,_)),H=(u-l)/B,$=l,G=u):V?($=D?l:$,G=z?u:G,B=m-1,H=(G-$)/B):(B=(G-$)/H,Ms(B,Math.round(B),H/1e3)?B=Math.round(B):B=Math.ceil(B));let ot=Math.max(ja(H),ja($));X=Math.pow(10,Nt(f)?ot:f),$=Math.round($*X)/X,G=Math.round(G*X)/X;let ut=0;for(D&&(y&&$!==l?(n.push({value:l}),$<l&&ut++,Ms(Math.round(($+ut*H)*X)/X,l,Wu(l,W,e))&&ut++):$<l&&ut++);ut<B;++ut){let Q=Math.round(($+ut*H)*X)/X;if(z&&Q>u)break;n.push({value:Q})}return z&&y&&G!==u?n.length&&Ms(n[n.length-1].value,u,Wu(u,W,e))?n[n.length-1].value=u:n.push({value:u}):(!z||G===u)&&n.push({value:G}),n}function Wu(e,t,{horizontal:n,minRotation:s}){let a=Ti(s),r=(n?Math.sin(a):Math.cos(a))||.001,l=.75*t*(""+e).length;return Math.min(t/r,l)}var fo=class extends Zn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Nt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){let{beginAtZero:t}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds(),{min:a,max:r}=this,l=f=>a=n?a:f,u=f=>r=s?r:f;if(t){let f=hi(a),m=hi(r);f<0&&m<0?u(0):f>0&&m>0&&l(0)}if(a===r){let f=r===0?1:Math.abs(r*.05);u(r+f),t||l(a-f)}this.min=a,this.max=r}getTickLimit(){let t=this.options.ticks,{maxTicksLimit:n,stepSize:s}=t,a;return s?(a=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,a>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${a} ticks. Limiting to 1000.`),a=1e3)):(a=this.computeTickLimit(),n=n||11),n&&(a=Math.min(n,a)),a}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let t=this.options,n=t.ticks,s=this.getTickLimit();s=Math.max(2,s);let a={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},r=this._range||this,l=iv(a,r);return t.bounds==="ticks"&&Ba(l,this,"value"),t.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){let t=this.ticks,n=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){let a=(s-n)/Math.max(t.length-1,1)/2;n-=a,s+=a}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(t){return Ps(t,this.chart.options.locale,this.options.ticks.format)}},Yo=class extends fo{determineDataLimits(){let{min:t,max:n}=this.getMinMax(!0);this.min=he(t)?t:0,this.max=he(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){let t=this.isHorizontal(),n=t?this.width:this.height,s=Ti(this.options.ticks.minRotation),a=(t?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,r.lineHeight/a))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}};st(Yo,"id","linear"),st(Yo,"defaults",{ticks:{callback:Oo.formatters.numeric}});var ta=e=>Math.floor(mn(e)),ks=(e,t)=>Math.pow(10,ta(e)+t);function Uu(e){return e/Math.pow(10,ta(e))===1}function qu(e,t,n){let s=Math.pow(10,n),a=Math.floor(e/s);return Math.ceil(t/s)-a}function nv(e,t){let n=t-e,s=ta(n);for(;qu(e,t,s)>10;)s++;for(;qu(e,t,s)<10;)s--;return Math.min(s,ta(e))}function sv(e,{min:t,max:n}){t=ui(e.min,t);let s=[],a=ta(t),r=nv(t,n),l=r<0?Math.pow(10,Math.abs(r)):1,u=Math.pow(10,r),f=a>r?Math.pow(10,a):0,m=Math.round((t-f)*l)/l,_=Math.floor((t-f)/u/10)*u*10,v=Math.floor((m-_)/Math.pow(10,r)),y=ui(e.min,Math.round((f+_+v*Math.pow(10,r))*l)/l);for(;y<n;)s.push({value:y,major:Uu(y),significand:v}),v>=10?v=v<15?15:20:v++,v>=20&&(r++,v=2,l=r>=0?1:l),y=Math.round((f+_+v*Math.pow(10,r))*l)/l;let w=ui(e.max,y);return s.push({value:w,major:Uu(w),significand:v}),s}var Xo=class extends Zn{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){let s=fo.prototype.parse.apply(this,[t,n]);if(s===0){this._zero=!0;return}return he(s)&&s>0?s:null}determineDataLimits(){let{min:t,max:n}=this.getMinMax(!0);this.min=he(t)?Math.max(0,t):null,this.max=he(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!he(this._userMin)&&(this.min=t===ks(this.min,0)?ks(this.min,-1):ks(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:t,maxDefined:n}=this.getUserBounds(),s=this.min,a=this.max,r=u=>s=t?s:u,l=u=>a=n?a:u;s===a&&(s<=0?(r(1),l(10)):(r(ks(s,-1)),l(ks(a,1)))),s<=0&&r(ks(a,-1)),a<=0&&l(ks(s,1)),this.min=s,this.max=a}buildTicks(){let t=this.options,n={min:this._userMin,max:this._userMax},s=sv(n,this);return t.bounds==="ticks"&&Ba(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Ps(t,this.chart.options.locale,this.options.ticks.format)}configure(){let t=this.min;super.configure(),this._startValue=mn(t),this._valueRange=mn(this.max)-mn(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(mn(t)-this._startValue)/this._valueRange)}getValueForPixel(t){let n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}};st(Xo,"id","logarithmic"),st(Xo,"defaults",{ticks:{callback:Oo.formatters.logarithmic,major:{enabled:!0}}});function ic(e){let t=e.ticks;if(t.display&&e.display){let n=ze(t.backdropPadding);return pt(t.font&&t.font.size,de.font.size)+n.height}return 0}function ov(e,t,n){return n=Jt(n)?n:[n],{w:Ml(e,t.string,n),h:n.length*t.lineHeight}}function Yu(e,t,n,s,a){return e===s||e===a?{start:t-n/2,end:t+n/2}:e<s||e>a?{start:t-n,end:t}:{start:t,end:t+n}}function av(e){let t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),s=[],a=[],r=e._pointLabels.length,l=e.options.pointLabels,u=l.centerPointLabels?ie/r:0;for(let f=0;f<r;f++){let m=l.setContext(e.getPointLabelContext(f));a[f]=m.padding;let _=e.getPointPosition(f,e.drawingArea+a[f],u),v=me(m.font),y=ov(e.ctx,v,e._pointLabels[f]);s[f]=y;let w=ci(e.getIndexAngle(f)+u),k=Math.round(Ao(w)),A=Yu(k,_.x,y.w,0,180),E=Yu(k,_.y,y.h,90,270);rv(n,t,w,A,E)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=hv(e,s,a)}function rv(e,t,n,s,a){let r=Math.abs(Math.sin(n)),l=Math.abs(Math.cos(n)),u=0,f=0;s.start<t.l?(u=(t.l-s.start)/r,e.l=Math.min(e.l,t.l-u)):s.end>t.r&&(u=(s.end-t.r)/r,e.r=Math.max(e.r,t.r+u)),a.start<t.t?(f=(t.t-a.start)/l,e.t=Math.min(e.t,t.t-f)):a.end>t.b&&(f=(a.end-t.b)/l,e.b=Math.max(e.b,t.b+f))}function lv(e,t,n){let s=e.drawingArea,{extra:a,additionalAngle:r,padding:l,size:u}=n,f=e.getPointPosition(t,s+a+l,r),m=Math.round(Ao(ci(f.angle+ce))),_=fv(f.y,u.h,m),v=uv(m),y=dv(f.x,u.w,v);return{visible:!0,x:f.x,y:_,textAlign:v,left:y,top:_,right:y+u.w,bottom:_+u.h}}function cv(e,t){if(!t)return!0;let{left:n,top:s,right:a,bottom:r}=e;return!(nn({x:n,y:s},t)||nn({x:n,y:r},t)||nn({x:a,y:s},t)||nn({x:a,y:r},t))}function hv(e,t,n){let s=[],a=e._pointLabels.length,r=e.options,{centerPointLabels:l,display:u}=r.pointLabels,f={extra:ic(r)/2,additionalAngle:l?ie/a:0},m;for(let _=0;_<a;_++){f.padding=n[_],f.size=t[_];let v=lv(e,_,f);s.push(v),u==="auto"&&(v.visible=cv(v,m),v.visible&&(m=v))}return s}function uv(e){return e===0||e===180?"center":e<180?"left":"right"}function dv(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function fv(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function pv(e,t,n){let{left:s,top:a,right:r,bottom:l}=n,{backdropColor:u}=t;if(!Nt(u)){let f=Bn(t.borderRadius),m=ze(t.backdropPadding);e.fillStyle=u;let _=s-m.left,v=a-m.top,y=r-s+m.width,w=l-a+m.height;Object.values(f).some(k=>k!==0)?(e.beginPath(),Ts(e,{x:_,y:v,w:y,h:w,radius:f}),e.fill()):e.fillRect(_,v,y,w)}}function mv(e,t){let{ctx:n,options:{pointLabels:s}}=e;for(let a=t-1;a>=0;a--){let r=e._pointLabelItems[a];if(!r.visible)continue;let l=s.setContext(e.getPointLabelContext(a));pv(n,l,r);let u=me(l.font),{x:f,y:m,textAlign:_}=r;Nn(n,e._pointLabels[a],f,m+u.lineHeight/2,u,{color:l.color,textAlign:_,textBaseline:"middle"})}}function _d(e,t,n,s){let{ctx:a}=e;if(n)a.arc(e.xCenter,e.yCenter,t,0,Qt);else{let r=e.getPointPosition(0,t);a.moveTo(r.x,r.y);for(let l=1;l<s;l++)r=e.getPointPosition(l,t),a.lineTo(r.x,r.y)}}function gv(e,t,n,s,a){let r=e.ctx,l=t.circular,{color:u,lineWidth:f}=t;!l&&!s||!u||!f||n<0||(r.save(),r.strokeStyle=u,r.lineWidth=f,r.setLineDash(a.dash),r.lineDashOffset=a.dashOffset,r.beginPath(),_d(e,n,l,s),r.closePath(),r.stroke(),r.restore())}function _v(e,t,n){return _n(e,{label:n,index:t,type:"pointLabel"})}var Es=class extends fo{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let t=this._padding=ze(ic(this.options)/2),n=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){let{min:t,max:n}=this.getMinMax(!1);this.min=he(t)&&!isNaN(t)?t:0,this.max=he(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ic(this.options))}generateTickLabels(t){fo.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,s)=>{let a=bt(this.options.pointLabels.callback,[n,s],this);return a||a===0?a:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){let t=this.options;t.display&&t.pointLabels.display?av(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,s,a){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((s-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,s,a))}getIndexAngle(t){let n=Qt/(this._pointLabels.length||1),s=this.options.startAngle||0;return ci(t*n+Ti(s))}getDistanceFromCenterForValue(t){if(Nt(t))return NaN;let n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(Nt(t))return NaN;let n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){let n=this._pointLabels||[];if(t>=0&&t<n.length){let s=n[t];return _v(this.getContext(),t,s)}}getPointPosition(t,n,s=0){let a=this.getIndexAngle(t)-ce+s;return{x:Math.cos(a)*n+this.xCenter,y:Math.sin(a)*n+this.yCenter,angle:a}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){let{left:n,top:s,right:a,bottom:r}=this._pointLabelItems[t];return{left:n,top:s,right:a,bottom:r}}drawBackground(){let{backgroundColor:t,grid:{circular:n}}=this.options;if(t){let s=this.ctx;s.save(),s.beginPath(),_d(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){let t=this.ctx,n=this.options,{angleLines:s,grid:a,border:r}=n,l=this._pointLabels.length,u,f,m;if(n.pointLabels.display&&mv(this,l),a.display&&this.ticks.forEach((_,v)=>{if(v!==0){f=this.getDistanceFromCenterForValue(_.value);let y=this.getContext(v),w=a.setContext(y),k=r.setContext(y);gv(this,w,f,l,k)}}),s.display){for(t.save(),u=l-1;u>=0;u--){let _=s.setContext(this.getPointLabelContext(u)),{color:v,lineWidth:y}=_;!y||!v||(t.lineWidth=y,t.strokeStyle=v,t.setLineDash(_.borderDash),t.lineDashOffset=_.borderDashOffset,f=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),m=this.getPointPosition(u,f),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(m.x,m.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){let t=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;let a=this.getIndexAngle(0),r,l;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(a),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((u,f)=>{if(f===0&&!n.reverse)return;let m=s.setContext(this.getContext(f)),_=me(m.font);if(r=this.getDistanceFromCenterForValue(this.ticks[f].value),m.showLabelBackdrop){t.font=_.string,l=t.measureText(u.label).width,t.fillStyle=m.backdropColor;let v=ze(m.backdropPadding);t.fillRect(-l/2-v.left,-r-_.size/2-v.top,l+v.width,_.size+v.height)}Nn(t,u.label,0,-r,_,{color:m.color})}),t.restore()}drawTitle(){}};st(Es,"id","radialLinear"),st(Es,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Oo.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),st(Es,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),st(Es,"descriptors",{angleLines:{_fallback:"grid"}});var Sr={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},bi=Object.keys(Sr);function vv(e,t){return e-t}function Xu(e,t){if(Nt(t))return null;let n=e._adapter,{parser:s,round:a,isoWeekday:r}=e._parseOpts,l=t;return typeof s=="function"&&(l=s(l)),he(l)||(l=typeof s=="string"?n.parse(l,s):n.parse(l)),l===null?null:(a&&(l=a==="week"&&(os(r)||r===!0)?n.startOf(l,"isoWeek",r):n.startOf(l,a)),+l)}function Gu(e,t,n,s){let a=bi.length;for(let r=bi.indexOf(e);r<a-1;++r){let l=Sr[bi[r]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((n-t)/(u*l.size))<=s)return bi[r]}return bi[a-1]}function bv(e,t,n,s,a){for(let r=bi.length-1;r>=bi.indexOf(n);r--){let l=bi[r];if(Sr[l].common&&e._adapter.diff(a,s,l)>=t-1)return l}return bi[n?bi.indexOf(n):0]}function yv(e){for(let t=bi.indexOf(e)+1,n=bi.length;t<n;++t)if(Sr[bi[t]].common)return bi[t]}function $u(e,t,n){if(!n)e[t]=!0;else if(n.length){let{lo:s,hi:a}=Eo(n,t),r=n[s]>=t?n[s]:n[a];e[r]=!0}}function xv(e,t,n,s){let a=e._adapter,r=+a.startOf(t[0].value,s),l=t[t.length-1].value,u,f;for(u=r;u<=l;u=+a.add(u,1,s))f=n[u],f>=0&&(t[f].major=!0);return t}function Ku(e,t,n){let s=[],a={},r=t.length,l,u;for(l=0;l<r;++l)u=t[l],a[u]=l,s.push({value:u,major:!1});return r===0||!n?s:xv(e,s,a,n)}var Os=class extends Zn{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){let s=t.time||(t.time={}),a=this._adapter=new Dm._date(t.adapters.date);a.init(n),xs(s.displayFormats,a.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:Xu(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let t=this.options,n=this._adapter,s=t.time.unit||"day",{min:a,max:r,minDefined:l,maxDefined:u}=this.getUserBounds();function f(m){!l&&!isNaN(m.min)&&(a=Math.min(a,m.min)),!u&&!isNaN(m.max)&&(r=Math.max(r,m.max))}(!l||!u)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),a=he(a)&&!isNaN(a)?a:+n.startOf(Date.now(),s),r=he(r)&&!isNaN(r)?r:+n.endOf(Date.now(),s)+1,this.min=Math.min(a,r-1),this.max=Math.max(a+1,r)}_getLabelBounds(){let t=this.getLabelTimestamps(),n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],s=t[t.length-1]),{min:n,max:s}}buildTicks(){let t=this.options,n=t.time,s=t.ticks,a=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);let r=this.min,l=this.max,u=bl(a,r,l);return this._unit=n.unit||(s.autoSkip?Gu(n.minUnit,this.min,this.max,this._getLabelCapacity(r)):bv(this,u.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:yv(this._unit),this.initOffsets(a),t.reverse&&u.reverse(),Ku(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,s=0,a,r;this.options.offset&&t.length&&(a=this.getDecimalForValue(t[0]),t.length===1?n=1-a:n=(this.getDecimalForValue(t[1])-a)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?s=r:s=(r-this.getDecimalForValue(t[t.length-2]))/2);let l=t.length<3?.5:.25;n=we(n,0,l),s=we(s,0,l),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){let t=this._adapter,n=this.min,s=this.max,a=this.options,r=a.time,l=r.unit||Gu(r.minUnit,n,s,this._getLabelCapacity(n)),u=pt(a.ticks.stepSize,1),f=l==="week"?r.isoWeekday:!1,m=os(f)||f===!0,_={},v=n,y,w;if(m&&(v=+t.startOf(v,"isoWeek",f)),v=+t.startOf(v,m?"day":l),t.diff(s,n,l)>1e5*u)throw new Error(n+" and "+s+" are too far apart with stepSize of "+u+" "+l);let k=a.ticks.source==="data"&&this.getDataTimestamps();for(y=v,w=0;y<s;y=+t.add(y,u,l),w++)$u(_,y,k);return(y===s||a.bounds==="ticks"||w===1)&&$u(_,y,k),Object.keys(_).sort((A,E)=>A-E).map(A=>+A)}getLabelForValue(t){let n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(t,s.tooltipFormat):n.format(t,s.displayFormats.datetime)}format(t,n){let a=this.options.time.displayFormats,r=this._unit,l=n||a[r];return this._adapter.format(t,l)}_tickFormatFunction(t,n,s,a){let r=this.options,l=r.ticks.callback;if(l)return bt(l,[t,n,s],this);let u=r.time.displayFormats,f=this._unit,m=this._majorUnit,_=f&&u[f],v=m&&u[m],y=s[n],w=m&&v&&y&&y.major;return this._adapter.format(t,a||(w?v:_))}generateTickLabels(t){let n,s,a;for(n=0,s=t.length;n<s;++n)a=t[n],a.label=this._tickFormatFunction(a.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){let n=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(t){let n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){let n=this.options.ticks,s=this.ctx.measureText(t).width,a=Ti(this.isHorizontal()?n.maxRotation:n.minRotation),r=Math.cos(a),l=Math.sin(a),u=this._resolveTickFontOptions(0).size;return{w:s*r+u*l,h:s*l+u*r}}_getLabelCapacity(t){let n=this.options.time,s=n.displayFormats,a=s[n.unit]||s.millisecond,r=this._tickFormatFunction(t,0,Ku(this,[t],this._majorUnit),a),l=this._getLabelSize(r),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let t=this._cache.data||[],n,s;if(t.length)return t;let a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(n=0,s=a.length;n<s;++n)t=t.concat(a[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){let t=this._cache.labels||[],n,s;if(t.length)return t;let a=this.getLabels();for(n=0,s=a.length;n<s;++n)t.push(Xu(this,a[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Za(t.sort(vv))}};st(Os,"id","time"),st(Os,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function mr(e,t,n){let s=0,a=e.length-1,r,l,u,f;n?(t>=e[s].pos&&t<=e[a].pos&&({lo:s,hi:a}=en(e,"pos",t)),{pos:r,time:u}=e[s],{pos:l,time:f}=e[a]):(t>=e[s].time&&t<=e[a].time&&({lo:s,hi:a}=en(e,"time",t)),{time:r,pos:u}=e[s],{time:l,pos:f}=e[a]);let m=l-r;return m?u+(f-u)*(t-r)/m:u}var Go=class extends Os{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=mr(n,this.min),this._tableRange=mr(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){let{min:n,max:s}=this,a=[],r=[],l,u,f,m,_;for(l=0,u=t.length;l<u;++l)m=t[l],m>=n&&m<=s&&a.push(m);if(a.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(l=0,u=a.length;l<u;++l)_=a[l+1],f=a[l-1],m=a[l],Math.round((_+f)/2)!==m&&r.push({time:m,pos:l/(u-1)});return r}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;let n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?t=this.normalize(n.concat(s)):t=n.length?n:s,t=this._cache.all=t,t}getDecimalForValue(t){return(mr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){let n=this._offsets,s=this.getDecimalForPixel(t)/n.factor-n.end;return mr(this._table,s*this._tableRange+this._minPos,!0)}};st(Go,"id","timeseries"),st(Go,"defaults",Os.defaults);var wv=Object.freeze({__proto__:null,CategoryScale:qo,LinearScale:Yo,LogarithmicScale:Xo,RadialLinearScale:Es,TimeScale:Os,TimeSeriesScale:Go}),vd=[Om,s_,J_,wv];qi.register(...vd);var sc=qi;var po=Bt(bd());var na=e=>e&&e.enabled&&e.modifierKey,Ld=(e,t)=>e&&t[e+"Key"],uc=(e,t)=>e&&!t[e+"Key"];function cs(e,t,n){return e===void 0?!0:typeof e=="string"?e.indexOf(t)!==-1:typeof e=="function"?e({chart:n}).indexOf(t)!==-1:!1}function oc(e,t){return typeof e=="function"&&(e=e({chart:t})),typeof e=="string"?{x:e.indexOf("x")!==-1,y:e.indexOf("y")!==-1}:{x:!1,y:!1}}function Mv(e,t){let n;return function(){return clearTimeout(n),n=setTimeout(e,t),t}}function Sv({x:e,y:t},n){let s=n.scales,a=Object.keys(s);for(let r=0;r<a.length;r++){let l=s[a[r]];if(t>=l.top&&t<=l.bottom&&e>=l.left&&e<=l.right)return l}return null}function Cd(e,t,n){let{mode:s="xy",scaleMode:a,overScaleMode:r}=e||{},l=Sv(t,n),u=oc(s,n),f=oc(a,n);if(r){let _=oc(r,n);for(let v of["x","y"])_[v]&&(f[v]=u[v],u[v]=!1)}if(l&&f[l.axis])return[l];let m=[];return Lt(n.scales,function(_){u[_.axis]&&m.push(_)}),m}var ac=new WeakMap;function ge(e){let t=ac.get(e);return t||(t={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},ac.set(e,t)),t}function Pv(e){ac.delete(e)}function kd(e,t,n){let s=e.max-e.min,a=s*(t-1),r=e.isHorizontal()?n.x:n.y,l=Math.max(0,Math.min(1,(e.getValueForPixel(r)-e.min)/s||0)),u=1-l;return{min:a*l,max:a*u}}function yd(e,t,n,s,a){let r=n[s];if(r==="original"){let l=e.originalScaleLimits[t.id][s];r=pt(l.options,l.scale)}return pt(r,a)}function Tv(e,t,n){let s=e.getValueForPixel(t),a=e.getValueForPixel(n);return{min:Math.min(s,a),max:Math.max(s,a)}}function mo(e,{min:t,max:n},s,a=!1){let r=ge(e.chart),{id:l,axis:u,options:f}=e,m=s&&(s[l]||s[u])||{},{minRange:_=0}=m,v=yd(r,e,m,"min",-1/0),y=yd(r,e,m,"max",1/0),w=a?Math.max(n-t,_):e.max-e.min,k=(w-n+t)/2;return t-=k,n+=k,t<v?(t=v,n=Math.min(v+w,y)):n>y&&(n=y,t=Math.max(y-w,v)),f.min=t,f.max=n,r.updatedScaleLimits[e.id]={min:t,max:n},e.parse(t)!==e.min||e.parse(n)!==e.max}function Lv(e,t,n,s){let a=kd(e,t,n),r={min:e.min+a.min,max:e.max-a.max};return mo(e,r,s,!0)}function Cv(e,t,n,s){mo(e,Tv(e,t,n),s,!0)}var xd=e=>e===0||isNaN(e)?0:e<0?Math.min(Math.round(e),-1):Math.max(Math.round(e),1);function kv(e){let n=e.getLabels().length-1;e.min>0&&(e.min-=1),e.max<n&&(e.max+=1)}function Av(e,t,n,s){let a=kd(e,t,n);e.min===e.max&&t<1&&kv(e);let r={min:e.min+xd(a.min),max:e.max-xd(a.max)};return mo(e,r,s,!0)}function Ev(e){return e.isHorizontal()?e.width:e.height}function Iv(e,t,n){let a=e.getLabels().length-1,{min:r,max:l}=e,u=Math.max(l-r,1),f=Math.round(Ev(e)/Math.max(u,10)),m=Math.round(Math.abs(t/f)),_;return t<-f?(l=Math.min(l+m,a),r=u===1?l:l-u,_=l===a):t>f&&(r=Math.max(0,r-m),l=u===1?r:r+u,_=r===0),mo(e,{min:r,max:l},n)||_}var Ov={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function Ad(e,t,n,s=!1){let{min:a,max:r,options:l}=e,u=l.time&&l.time.round,f=Ov[u]||0,m=e.getValueForPixel(e.getPixelForValue(a+f)-t),_=e.getValueForPixel(e.getPixelForValue(r+f)-t),{min:v=-1/0,max:y=1/0}=s&&n&&n[e.axis]||{};return isNaN(m)||isNaN(_)||m<v||_>y?!0:mo(e,{min:m,max:_},n,s)}function wd(e,t,n){return Ad(e,t,n,!0)}var rc={category:Av,default:Lv},lc={default:Cv},cc={category:Iv,default:Ad,logarithmic:wd,timeseries:wd};function Dv(e,t,n){let{id:s,options:{min:a,max:r}}=e;if(!t[s]||!n[s])return!0;let l=n[s];return l.min!==a||l.max!==r}function Md(e,t){Lt(e,(n,s)=>{t[s]||delete e[s]})}function go(e,t){let{scales:n}=e,{originalScaleLimits:s,updatedScaleLimits:a}=t;return Lt(n,function(r){Dv(r,s,a)&&(s[r.id]={min:{scale:r.min,options:r.options.min},max:{scale:r.max,options:r.options.max}})}),Md(s,n),Md(a,n),s}function Sd(e,t,n,s){let a=rc[e.type]||rc.default;bt(a,[e,t,n,s])}function Pd(e,t,n,s,a){let r=lc[e.type]||lc.default;bt(r,[e,t,n,s,a])}function Rv(e){let t=e.chartArea;return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function dc(e,t,n="none"){let{x:s=1,y:a=1,focalPoint:r=Rv(e)}=typeof t=="number"?{x:t,y:t}:t,l=ge(e),{options:{limits:u,zoom:f}}=l;go(e,l);let m=s!==1,_=a!==1,v=Cd(f,r,e);Lt(v||e.scales,function(y){y.isHorizontal()&&m?Sd(y,s,r,u):!y.isHorizontal()&&_&&Sd(y,a,r,u)}),e.update(n),bt(f.onZoom,[{chart:e}])}function Ed(e,t,n,s="none"){let a=ge(e),{options:{limits:r,zoom:l}}=a,{mode:u="xy"}=l;go(e,a);let f=cs(u,"x",e),m=cs(u,"y",e);Lt(e.scales,function(_){_.isHorizontal()&&f?Pd(_,t.x,n.x,r):!_.isHorizontal()&&m&&Pd(_,t.y,n.y,r)}),e.update(s),bt(l.onZoom,[{chart:e}])}function zv(e,t,n,s="none"){go(e,ge(e));let a=e.scales[t];mo(a,n,void 0,!0),e.update(s)}function Fv(e,t="default"){let n=ge(e),s=go(e,n);Lt(e.scales,function(a){let r=a.options;s[a.id]?(r.min=s[a.id].min.options,r.max=s[a.id].max.options):(delete r.min,delete r.max)}),e.update(t),bt(n.options.zoom.onZoomComplete,[{chart:e}])}function Nv(e,t){let n=e.originalScaleLimits[t];if(!n)return;let{min:s,max:a}=n;return pt(a.options,a.scale)-pt(s.options,s.scale)}function Bv(e){let t=ge(e),n=1,s=1;return Lt(e.scales,function(a){let r=Nv(t,a.id);if(r){let l=Math.round(r/(a.max-a.min)*100)/100;n=Math.min(n,l),s=Math.max(s,l)}}),n<1?n:s}function Td(e,t,n,s){let{panDelta:a}=s,r=a[e.id]||0;hi(r)===hi(t)&&(t+=r);let l=cc[e.type]||cc.default;bt(l,[e,t,n])?a[e.id]=0:a[e.id]=t}function Id(e,t,n,s="none"){let{x:a=0,y:r=0}=typeof t=="number"?{x:t,y:t}:t,l=ge(e),{options:{pan:u,limits:f}}=l,{onPan:m}=u||{};go(e,l);let _=a!==0,v=r!==0;Lt(n||e.scales,function(y){y.isHorizontal()&&_?Td(y,a,f,l):!y.isHorizontal()&&v&&Td(y,r,f,l)}),e.update(s),bt(m,[{chart:e}])}function Od(e){let t=ge(e);go(e,t);let n={};for(let s of Object.keys(e.scales)){let{min:a,max:r}=t.originalScaleLimits[s]||{min:{},max:{}};n[s]={min:a.scale,max:r.scale}}return n}function jv(e){let t=Od(e);for(let n of Object.keys(e.scales)){let{min:s,max:a}=t[n];if(s!==void 0&&e.scales[n].min!==s||a!==void 0&&e.scales[n].max!==a)return!0}return!1}function yi(e,t){let{handlers:n}=ge(e),s=n[t];s&&s.target&&(s.target.removeEventListener(t,s),delete n[t])}function ia(e,t,n,s){let{handlers:a,options:r}=ge(e),l=a[n];l&&l.target===t||(yi(e,n),a[n]=u=>s(e,u,r),a[n].target=t,t.addEventListener(n,a[n]))}function Hv(e,t){let n=ge(e);n.dragStart&&(n.dragging=!0,n.dragEnd=t,e.update("none"))}function Vv(e,t){let n=ge(e);!n.dragStart||t.key!=="Escape"||(yi(e,"keydown"),n.dragging=!1,n.dragStart=n.dragEnd=null,e.update("none"))}function Dd(e,t,n){let{onZoomStart:s,onZoomRejected:a}=n;if(s){let r=Li(t,e);if(bt(s,[{chart:e,event:t,point:r}])===!1)return bt(a,[{chart:e,event:t}]),!1}}function Zv(e,t){let n=ge(e),{pan:s,zoom:a={}}=n.options;if(t.button!==0||Ld(na(s),t)||uc(na(a.drag),t))return bt(a.onZoomRejected,[{chart:e,event:t}]);Dd(e,t,a)!==!1&&(n.dragStart=t,ia(e,e.canvas,"mousemove",Hv),ia(e,window.document,"keydown",Vv))}function Rd(e,t,n,s){let a=cs(t,"x",e),r=cs(t,"y",e),{top:l,left:u,right:f,bottom:m,width:_,height:v}=e.chartArea,y=Li(n,e),w=Li(s,e);a&&(u=Math.min(y.x,w.x),f=Math.max(y.x,w.x)),r&&(l=Math.min(y.y,w.y),m=Math.max(y.y,w.y));let k=f-u,A=m-l;return{left:u,top:l,right:f,bottom:m,width:k,height:A,zoomX:a&&k?1+(_-k)/_:1,zoomY:r&&A?1+(v-A)/v:1}}function Wv(e,t){let n=ge(e);if(!n.dragStart)return;yi(e,"mousemove");let{mode:s,onZoomComplete:a,drag:{threshold:r=0}}=n.options.zoom,l=Rd(e,s,n.dragStart,t),u=cs(s,"x",e)?l.width:0,f=cs(s,"y",e)?l.height:0,m=Math.sqrt(u*u+f*f);if(n.dragStart=n.dragEnd=null,m<=r){n.dragging=!1,e.update("none");return}Ed(e,{x:l.left,y:l.top},{x:l.right,y:l.bottom},"zoom"),setTimeout(()=>n.dragging=!1,500),bt(a,[{chart:e}])}function Uv(e,t,n){if(uc(na(n.wheel),t)){bt(n.onZoomRejected,[{chart:e,event:t}]);return}if(Dd(e,t,n)!==!1&&(t.cancelable&&t.preventDefault(),t.deltaY!==void 0))return!0}function qv(e,t){let{handlers:{onZoomComplete:n},options:{zoom:s}}=ge(e);if(!Uv(e,t,s))return;let a=t.target.getBoundingClientRect(),r=1+(t.deltaY>=0?-s.wheel.speed:s.wheel.speed),l={x:r,y:r,focalPoint:{x:t.clientX-a.left,y:t.clientY-a.top}};dc(e,l),n&&n()}function Yv(e,t,n,s){n&&(ge(e).handlers[t]=Mv(()=>bt(n,[{chart:e}]),s))}function Xv(e,t){let n=e.canvas,{wheel:s,drag:a,onZoomComplete:r}=t.zoom;s.enabled?(ia(e,n,"wheel",qv),Yv(e,"onZoomComplete",r,250)):yi(e,"wheel"),a.enabled?(ia(e,n,"mousedown",Zv),ia(e,n.ownerDocument,"mouseup",Wv)):(yi(e,"mousedown"),yi(e,"mousemove"),yi(e,"mouseup"),yi(e,"keydown"))}function Gv(e){yi(e,"mousedown"),yi(e,"mousemove"),yi(e,"mouseup"),yi(e,"wheel"),yi(e,"click"),yi(e,"keydown")}function $v(e,t){return function(n,s){let{pan:a,zoom:r={}}=t.options;if(!a||!a.enabled)return!1;let l=s&&s.srcEvent;return l&&!t.panning&&s.pointerType==="mouse"&&(uc(na(a),l)||Ld(na(r.drag),l))?(bt(a.onPanRejected,[{chart:e,event:s}]),!1):!0}}function Kv(e,t){let n=Math.abs(e.clientX-t.clientX),s=Math.abs(e.clientY-t.clientY),a=n/s,r,l;return a>.3&&a<1.7?r=l=!0:n>s?r=!0:l=!0,{x:r,y:l}}function zd(e,t,n){if(t.scale){let{center:s,pointers:a}=n,r=1/t.scale*n.scale,l=n.target.getBoundingClientRect(),u=Kv(a[0],a[1]),f=t.options.zoom.mode,m={x:u.x&&cs(f,"x",e)?r:1,y:u.y&&cs(f,"y",e)?r:1,focalPoint:{x:s.x-l.left,y:s.y-l.top}};dc(e,m),t.scale=n.scale}}function Jv(e,t){t.options.zoom.pinch.enabled&&(t.scale=1)}function Qv(e,t,n){t.scale&&(zd(e,t,n),t.scale=null,bt(t.options.zoom.onZoomComplete,[{chart:e}]))}function Fd(e,t,n){let s=t.delta;s&&(t.panning=!0,Id(e,{x:n.deltaX-s.x,y:n.deltaY-s.y},t.panScales),t.delta={x:n.deltaX,y:n.deltaY})}function t0(e,t,n){let{enabled:s,onPanStart:a,onPanRejected:r}=t.options.pan;if(!s)return;let l=n.target.getBoundingClientRect(),u={x:n.center.x-l.left,y:n.center.y-l.top};if(bt(a,[{chart:e,event:n,point:u}])===!1)return bt(r,[{chart:e,event:n}]);t.panScales=Cd(t.options.pan,u,e),t.delta={x:0,y:0},clearTimeout(t.panEndTimeout),Fd(e,t,n)}function e0(e,t){t.delta=null,t.panning&&(t.panEndTimeout=setTimeout(()=>t.panning=!1,500),bt(t.options.pan.onPanComplete,[{chart:e}]))}var hc=new WeakMap;function i0(e,t){let n=ge(e),s=e.canvas,{pan:a,zoom:r}=t,l=new po.default.Manager(s);r&&r.pinch.enabled&&(l.add(new po.default.Pinch),l.on("pinchstart",()=>Jv(e,n)),l.on("pinch",u=>zd(e,n,u)),l.on("pinchend",u=>Qv(e,n,u))),a&&a.enabled&&(l.add(new po.default.Pan({threshold:a.threshold,enable:$v(e,n)})),l.on("panstart",u=>t0(e,n,u)),l.on("panmove",u=>Fd(e,n,u)),l.on("panend",()=>e0(e,n))),hc.set(e,l)}function n0(e){let t=hc.get(e);t&&(t.remove("pinchstart"),t.remove("pinch"),t.remove("pinchend"),t.remove("panstart"),t.remove("pan"),t.remove("panend"),t.destroy(),hc.delete(e))}var s0="2.0.1";function Tr(e,t,n){let s=n.zoom.drag,{dragStart:a,dragEnd:r}=ge(e);if(s.drawTime!==t||!r)return;let{left:l,top:u,width:f,height:m}=Rd(e,n.zoom.mode,a,r),_=e.ctx;_.save(),_.beginPath(),_.fillStyle=s.backgroundColor||"rgba(225,225,225,0.3)",_.fillRect(l,u,f,m),s.borderWidth>0&&(_.lineWidth=s.borderWidth,_.strokeStyle=s.borderColor||"rgba(225,225,225)",_.strokeRect(l,u,f,m)),_.restore()}var Nd={id:"zoom",version:s0,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(e,t,n){let s=ge(e);s.options=n,Object.prototype.hasOwnProperty.call(n.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(n.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(n.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),po.default&&i0(e,n),e.pan=(a,r,l)=>Id(e,a,r,l),e.zoom=(a,r)=>dc(e,a,r),e.zoomRect=(a,r,l)=>Ed(e,a,r,l),e.zoomScale=(a,r,l)=>zv(e,a,r,l),e.resetZoom=a=>Fv(e,a),e.getZoomLevel=()=>Bv(e),e.getInitialScaleBounds=()=>Od(e),e.isZoomedOrPanned=()=>jv(e)},beforeEvent(e){let t=ge(e);if(t.panning||t.dragging)return!1},beforeUpdate:function(e,t,n){let s=ge(e);s.options=n,Xv(e,n)},beforeDatasetsDraw(e,t,n){Tr(e,"beforeDatasetsDraw",n)},afterDatasetsDraw(e,t,n){Tr(e,"afterDatasetsDraw",n)},beforeDraw(e,t,n){Tr(e,"beforeDraw",n)},afterDraw(e,t,n){Tr(e,"afterDraw",n)},stop:function(e){Gv(e),po.default&&n0(e),Pv(e)},panFunctions:cc,zoomFunctions:rc,zoomRectFunctions:lc};var ei=Bt(Vt());sc.register(Nd);var Bd=Je.extend({options:{title:"Profile overlays",profile:!0,profileColor:"#FF00FF",spectrum:!0,spectrumColor:"#A000FF",collapsed:!0,position:"topleft",chartZoomOptions:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0},drag:{enabled:!0,modifierKey:"shift"},scaleMode:"xy",mode:"xy"},pan:{enabled:!0,scaleMode:"xy"},limits:{x:{min:"original",max:"original"},y:{min:"original",max:"original"}}}},initialize:function(e){ei.Util.setOptions(this,e),this._className="visiomatic-control",this._id="visiomatic-profile",this._layers={},this._sideClass="profile",this._handlingClick=!1},_initDialog:function(){let e=this,t=this.options,n=this._className,s=this._addDialogBox();if(this._wcs=this._map.options.crs,t.profile){let a=this._addDialogLine("Profile:",s),r=this._addDialogElement(a),l=this._addColorPicker(n+"-color",r,"profile",t.profileColor,"visiomaticProfile",title="Click to set line color");this._addButton(n+"-button",r,"start","Start drawing a profile line",()=>{if(this._currProfileLine)this._updateLine();else{let u=e._map,f=u.getCenter(),m=this._currProfileLine=(0,ei.polyline)([f,f],{color:l.value,weight:7,opacity:.5}),_=this._currProfileLength=(0,ei.divIcon)({className:n+"-length",html:'<p style="font-size: 15pt; color: '+l.value+';">0&#34;</p>'}),v=this._currProfileLengthMarker=(0,ei.marker)(f,{icon:_});m.nameColor=l.value,m.addTo(u),v.addTo(u),u.on("drag",this._updateLine,this)}}),this._addButton(n+"-button",r,"end","End line and plot",this._profileEnd)}if(t.spectrum){let a=this._addDialogLine("Spectrum:",s),r=this._addDialogElement(a),l=this._addColorPicker(n+"-color",r,"spectrum",t.spectrumColor,"visiomaticSpectra",title="Click to set marker color");this._addButton(n+"-button",r,"spectrum","Plot a spectrum at the current map position",()=>{let u=e._map,f=u.getCenter(),m=e._wcs.options.nzoom-1,_=u.project(f,m).floor().add([.5,.5]),v=u.unproject(_,m),y=this._spectrumMarker=(0,ei.circleMarker)(v,{color:l.value,radius:6,title:"Spectrum"}).addTo(u),w=ei.DomUtil.create("div",this._className+"-popup"),k=ei.DomUtil.create("div",this._className+"-activity",w);w.id="leaflet-spectrum-plot",y.bindPopup(w,{minWidth:16,maxWidth:1024,closeOnClick:!1}).openPopup(),De.requestURL(this._layer._url.replace(/\&.*$/g,"")+"&PFL="+_.x.toFixed(0)+","+_.y.toFixed(0)+":"+_.x.toFixed(0)+","+_.y.toFixed(0),"getting layer spectrum",this._plotSpectrum,this)})}},_updateLine:function(e){let t=this._map,n=this._wcs.options.nzoom-1,s=this._currProfileLine.getLatLngs(),a=t.project(s[0],n),r=t.project(t.getCenter(),n);s[1]=t.unproject(r,n),this._currProfileLength.options.html=this._currProfileLength.options.html.replace(/>[\d.&#;]+</,">"+this._getDistanceString(s[0],s[1])+"<"),this._currProfileLengthMarker.setLatLng(this._currProfileLine.getCenter()),this._currProfileLengthMarker.setIcon(this._currProfileLength),this._currProfileLine.redraw()},_profileEnd:async function(){let e=this._map,t=this._wcs,n=e.getCenter(),s=this._profileLine=this._currProfileLine;e.off("drag",this._updateLine,this),this._currProfileLengthMarker.remove(),this._currProfileLengthMarker=void 0,this._currProfileLine=void 0;let a=this._popDiv=ei.DomUtil.create("div","visiomatic-profile-plot"),r=ei.DomUtil.create("div",this._className+"-activity",a);s.bindPopup(a,{minWidth:16,maxWidth:1024,closeOnClick:!1}).openPopup();let l=t.options.nzoom-1,u=s.getLatLngs(),f=t.project(u[0]),m=t.project(u[1]);if(m.x<f.x){let y=m.x,w=m.y;m.x=f.x,f.x=y,m.y=f.y,f.y=w,s.lr=!1}else s.lr=!0;let _=this._layer,v=_.visio;response=await fetch(_._url.replace(/\&.*$/g,"")+(v.mixingMode==="mono"?`&CHAN=${v.channel+1}`:v.rgb.map((y,w)=>`&CHAN=${w+1}`).join(""))+"&PFL="+f.x.toFixed(0)+","+f.y.toFixed(0)+":"+m.x.toFixed(0)+","+m.y.toFixed(0)),response.status==200?this._plotProfile(await response):alert("Error "+response.status+" while getting profile.")},_getDistanceString:function(e,t){let n=this._wcs.distance(e,t);var s;return n>=1?s="&#176;":(n*=60,n>=1?s="&#39;":(n*=60,s="&#34;")),n.toFixed(2)+s},_plotProfile:async function(e){let t=await e.json(),n=t.profile,s=this._layer,a=s.visio,r=this._profileLine,l=this._popDiv,u=[],f=[];this.addLayer(r,"Image profile");let m=a.mixingMode==="mono",_=new sc(ei.DomUtil.create("canvas",this._className+"-canvas",l),{type:"line",data:{labels:n.map(v=>[v.x,v.y]),datasets:m?[{label:"profile",data:n.map(v=>v.values[0])}]:a.rgb.map((v,y)=>({label:a.channelLabels[y],borderColor:v.toStr()})).filter(Boolean).map((v,y)=>({...v,data:n.map(w=>w.values[y])}))},options:{pointRadius:0,stepped:"middle",scales:{x:{title:{display:!0,text:"position along line",color:getComputedStyle(this._map._container).getPropertyValue("--dialog-color")}},y:{title:{display:!0,text:"Pixel value",color:getComputedStyle(this._map._container).getPropertyValue("--dialog-color")}}},maintainAspectRatio:!1,interaction:{mode:"nearest",intersect:!0},plugins:{title:{display:!0,text:m?"Image profile for "+a.channelLabels[a.channel]:"Image profiles",color:getComputedStyle(this._map._container).getPropertyValue("--dialog-color")},legend:{display:!m},zoom:this.options.chartZoomOptions}}});this._map.on("themeChange",()=>{_.options.scales.x.title.color=_.options.scales.y.title.color=getComputedStyle(this._map._container).getPropertyValue("--dialog-color"),_.options.plugins.title.color=getComputedStyle(this._map._container).getPropertyValue("--dialog-color"),_.update()}),l.removeChild(l.childNodes[0]),r._popup.update()},_extractProfile:function(e,t,n){let s=e.visio.nChannel,a=t.length,r=[];for(let l=0;l<a;l++)r.push(t[l][2][n]);return r},_plotSpectrum:function(e,t){if(t.readyState===4&&t.status===200){let n=JSON.parse(t.responseText),s=n.profile,a=e._layer,r=a.visio,l=e._spectrumMarker,u=document.getElementById("leaflet-spectrum-plot"),f=[],m=[],_="Image Spectrum",v="Average pixel value";e.addLayer(l,"Image spectrum");for(let y=0;y<r.nChannel;y++)f.push([r.channelLabels[y],e._extractAverage(a,s,y)]);u.removeChild(u.childNodes[0]),l._popup.update()}},_extractAverage:function(e,t,n){let s=e.visio.nChannel,a=t.length/s,r=0;if(a===0)return 0;for(let l=0;l<a;l++)r+=t[l].values[n];return r/a}}),o0=function(e){return new Bd(e)};var Ai=Bt(Vt());var jd=Je.extend({options:{title:"Region overlays",nativeCelSys:!0,color:"#00FFFF",timeOut:30,collapsed:!0,position:"topleft"},initialize:function(e,t){Ai.Util.setOptions(this,t),this._className="visiomatic-control",this._id="visiomatic-region",this._layers={},this._handlingClick=!1,this._sideClass="region",this._regions=e&&e[0]?e:[]},_initDialog:function(){let e=this._className,t=this._regions,n=this._addDialogBox(),s=this._addDialogLine("Regions:",n),a=this._addDialogElement(s),r=this._addColorPicker(e+"-color",a,"region",this.options.color,"visiomaticRegion",title="Click to set region color"),l=this._regionSelect=this._addSelectMenu(this._className+"-select",a,t.map(function(m){return m.name}),t.map(function(m){return!!m.load}),-1,"Select region");this._addButton(e+"-button",this._addDialogElement(s),"region","Display region",function(){let m=l.selectedIndex-1;if(m>=0){let _=this._regions[m];_.color=r.value,l.selectedIndex=0,l.opt[m].disabled=!0,this._getRegion(_,this.options.timeOut)}});for(var u=0;u<t.length;u++){var f=t[u];f.index=u,f.load===!0&&(f.color||(f.color=this.options.color),this._getRegion(t[u],this.options.timeOut))}},_resetDialog:function(){},_getRegion:function(e,t){let n=this,s=this._map,a=s.options.crs,r=!a.equatorialFlag&&!this.options.nativeCelSys,l=new Ai.LayerGroup(null);l.notReady=!0,this.addLayer(l,e.name),De.requestURL(e.url,"loading "+e.name+" data",function(u,f){n._loadRegion(e,l,u,f)},this,this.options.timeOut)},_loadRegion:function(e,t,n,s){if(s.readyState===4)if(s.status===200){let a=n._map.options.crs,r=s.responseText,l=(0,Ai.geoJson)(JSON.parse(r),{onEachFeature:function(u,f){u.properties&&u.properties.description?f.bindPopup(u.properties.description):e.description&&f.bindPopup(e.description)},coordsToLatLng:function(u){if(a.equatorialFlag)return new Ai.LatLng(u[1],u[0],u[2]);{let f=a.eqToCelSys(f(u[1],u[0]));return new Ai.LatLng(f.lat,f.lng,u[2])}},style:function(u){return{color:e.color,weight:2}},pointToLayer:function(u,f){return e.drawPoint?e.drawPoint(u,f):(0,Ai.marker)(f)}});l.nameColor=e.color,l.addTo(n._map),n.removeLayer(t),n.addLayer(l,e.name,e.index),Ai.DomEvent.on(l,"trash",function(u){(u.index||u.index===0)&&(n._regionSelect.opt[u.index].disabled=!1)},n)}else s.status!==0&&alert("Error "+s.status+" while downloading "+e.url+"."),n.removeLayer(t),n._regionSelect.opt[e.index].disabled=!1}}),a0=function(e,t){return new jd(e,t)};var Ds=Bt(Vt()),Hd=Ds.Control.extend({initialize:function(e){Ds.Util.setOptions(this,e)},onAdd:function(e){let t=this._reticle=Ds.DomUtil.create("div","leaflet-reticle",this._map._controlContainer),n=t.style;return n.position="absolute",n.left="50%",n.bottom="50%",n.textAlign="center",n.verticalAlign="middle",n.pointerEvents="none",t.innerHTML="",this._container=Ds.DomUtil.create("div","leaflet-dummy")},onRemove:function(e){this._reticle.parentNode.removeChild(this._reticle)}}),r0=function(e){return new Hd(e)};var xn=Bt(Vt()),Vd=xn.Control.Scale.extend({options:{title:"Scale",position:"bottomleft",maxWidth:128,metric:!1,imperial:!1,degrees:!0,pixels:!1,custom:!1,customScale:1,customUnits:"",planetRadius:6378137,updateWhenIdle:!1},initialize:function(e){xn.Util.setOptions(this,e)},_addScales:function(e,t,n){e.metric&&(this._mScale=xn.DomUtil.create("div",t,n),this._mScale.title=e.metricTitle?e.metricTitle:e.title),e.imperial&&(this._iScale=xn.DomUtil.create("div",t,n),this._iScale.title=e.imperialTitle?e.imperialTitle:e.title),e.degrees&&(this._dScale=xn.DomUtil.create("div",t,n),this._dScale.title=e.degreesTitle?e.degreesTitle:e.title),e.pixels&&(this._pScale=xn.DomUtil.create("div",t,n),this._pScale.title=e.pixelsTitle?e.pixelsTitle:e.title),e.custom&&(this._cScale=xn.DomUtil.create("div",t,n),this._cScale.title=e.customTitle?e.customTitle:e.title),this.angular=e.metric||e.imperial||e.degrees},_update:function(){let e=this.options,t=this._map,n=t.options.crs;if(e.pixels&&n.options&&n.options.nzoom){let s=Math.pow(2,n.options.nzoom-1-t.getZoom());this._updatePixels(s*e.maxWidth)}if(e.custom&&n.options&&n.options.nzoom){let s=Math.pow(2,n.options.nzoom-1-t.getZoom())*e.customScale;this._updateCustom(s*e.maxWidth,e.customUnits)}if(this.angular){let s=t.getCenter(),a=Math.cos(s.lat*Math.PI/180),r=Math.sqrt(this._jacobian(s))*a,l=r*e.maxWidth;e.metric&&this._updateMetric(l*Math.PI/180*e.planetRadius),e.imperial&&this._updateImperial(l*Math.PI/180*e.planetRadius),e.degrees&&this._updateDegrees(l)}},_jacobian:function(e){let t=this._map,n=t.project(e),s=t.unproject(n.add([10,0])),a=t.unproject(n.add([0,10]));return .01*Math.abs((s.lng-e.lng)*(a.lat-e.lat)-(a.lng-e.lng)*(s.lat-e.lat))},_updateCustom:function(e,t){let n=this._cScale;if(e>1e9){var s=e*1e-9,a=this._getRoundNum(s);this._updateScale(n,a+" G"+t,a/s)}else if(e>1e6){var r=e*1e-6,l=this._getRoundNum(r);this._updateScale(n,l+" M"+t,l/r)}else if(e>1e3){var u=e*.001,f=this._getRoundNum(u);this._updateScale(n,f+" k"+t,f/u)}else{var m=this._getRoundNum(e);this._updateScale(n,m+" "+t,m/e)}},_updatePixels:function(e){let t=this._pScale;if(e>1e6){var n=e*1e-6,s=this._getRoundNum(n);this._updateScale(t,s+" Mpx",s/n)}else if(e>1e3){var a=e*.001,r=this._getRoundNum(a);this._updateScale(t,r+" kpx",r/a)}else{var l=this._getRoundNum(e);this._updateScale(t,l+" px",l/e)}},_updateDegrees:function(e){let t=e*3600,n=this._dScale;if(t<1){var s=t*1e3,a=this._getRoundNum(s);this._updateScale(n,a+" mas",a/s)}else if(t<60){var r=this._getRoundNum(t);this._updateScale(n,r+" &#34;",r/t)}else if(t<3600){var l=e*60,u=this._getRoundNum(l);this._updateScale(n,u+" &#39;",u/l)}else{var f=this._getRoundNum(e);this._updateScale(n,f+" &#176;",f/e)}}}),l0=function(e){return new Vd(e)};var at=Bt(Vt()),Zd=at.Control.extend({includes:at.Evented&&at.Evented.prototype,options:{title:"Toggle advanced menu",position:"left",collapsed:!0,forceSeparateButton:!1},initialize:function(e){at.Util.setOptions(this,e),this._sidebar=at.DomUtil.create("div","leaflet-container sidebar"),this.options.collapsed?at.DomUtil.addClass(this._sidebar,"collapsed"):at.DomUtil.addClass(this._sidebar,"closed"),at.DomUtil.addClass(this._sidebar,"sidebar-"+this.options.position),at.Browser.touch&&at.DomUtil.addClass(this._sidebar,"leaflet-touch"),this._tabs=at.DomUtil.create("div","sidebar-tabs",this._sidebar),this._tabitems=[],this._container=at.DomUtil.create("div","sidebar-content",this._sidebar),this._panes=[],this._closeButtons=[]},addTo:function(e){let t="leaflet-control-zoom-sidebar",n=e._controlContainer;var s;return at.DomUtil.addClass(e._container,"sidebar-map"),n.insertBefore(this._sidebar,n.firstChild),at.DomEvent.disableClickPropagation(this._sidebar).disableScrollPropagation(this._sidebar),this._map=e,e.zoomControl&&!this.options.forceSeparateButton?s=e.zoomControl._container:s=at.DomUtil.create("div","leaflet-bar"),this._toggleButton=this._addButton(this.options.title,t+(this.options.collapsed?" collapsed":""),s),this},addTabList:function(){return this._tablist=at.DomUtil.create("ul","",this._tabs),this._tablist.setAttribute("role","tablist"),this._tablist},addTab:function(e,t,n,s,a){let r=this._tablist?this._tablist:this.addTabList(),l=at.DomUtil.create("li","",r),u=at.DomUtil.create("a",t,l);l.setAttribute("role","tab"),l._sidebar=this,u.href="#"+e,u.id=e+"-toggle",u.title=n,at.DomEvent.on(u,"click",L.DomEvent.preventDefault),at.DomEvent.on(u,"click",this._onClick,l),l.sideClass=a,this._tabitems.push(l);let f=at.DomUtil.create("div","sidebar-pane",this._container),m=at.DomUtil.create("h1","sidebar-header",f);m.innerHTML=n;let _=at.DomUtil.create("div","sidebar-close",m),v=at.DomUtil.create("div","sidebar-close-icon",_);return this._closeButtons.push(_),at.DomEvent.on(_,"click",this._onCloseClick,this),f.id=e,f.sideClass=a,f.appendChild(s),this._panes.push(f),f},removeFrom:function(e){this._map=null;for(var t=this._tabitems.length-1;t>=0;t--){var n=this._tabitems[t];at.DomEvent.off(n.querySelector("a"),"click",this._onClick)}for(var t=this._closeButtons.length-1;t>=0;t--){var n=this._closeButtons[t];at.DomEvent.off(n,"click",this._onCloseClick,this)}return this},open:function(e){for(var t=this._panes.length-1;t>=0;t--){var n=this._panes[t];n.id===e?(at.DomUtil.addClass(n,"active"),n.sideClass&&at.DomUtil.addClass(this._sidebar,n.sideClass)):at.DomUtil.hasClass(n,"active")&&(at.DomUtil.removeClass(n,"active"),n.sideClass&&at.DomUtil.removeClass(this._sidebar,n.sideClass))}for(var t=this._tabitems.length-1;t>=0;t--){var n=this._tabitems[t];n.querySelector("a").hash==="#"+e?at.DomUtil.addClass(n,"active"):at.DomUtil.hasClass(n,"active")&&at.DomUtil.removeClass(n,"active")}return this.fire("content",{id:e}),at.DomUtil.hasClass(this._sidebar,"closed")&&(this.fire("opening"),at.DomUtil.removeClass(this._sidebar,"closed")),this},close:function(){for(var e=this._tabitems.length-1;e>=0;e--){var t=this._tabitems[e];at.DomUtil.hasClass(t,"active")&&(at.DomUtil.removeClass(t,"active"),t.sideClass&&at.DomUtil.removeClass(this._sidebar,t.sideClass))}return at.DomUtil.hasClass(this._sidebar,"closed")||(this.fire("closing"),at.DomUtil.addClass(this._sidebar,"closed")),this},toggle:function(){this.close(),at.DomUtil.hasClass(this._sidebar,"collapsed")?(at.DomUtil.addClass(this._sidebar,"closed"),this.fire("expanding"),at.DomUtil.removeClass(this._sidebar,"collapsed"),at.DomUtil.removeClass(this._toggleButton,"collapsed")):(at.DomUtil.removeClass(this._sidebar,"closed"),this.fire("collapsing"),at.DomUtil.addClass(this._sidebar,"collapsed"),at.DomUtil.addClass(this._toggleButton,"collapsed"))},_onClick:function(){at.DomUtil.hasClass(this,"active")?this._sidebar.close():at.DomUtil.hasClass(this,"disabled")||this._sidebar.open(this.querySelector("a").hash.slice(1))},_onCloseClick:function(){this.close()},_addButton:function(e,t,n){let s=at.DomUtil.create("a",t,n);return s.href="#",s.title=e,at.DomEvent.addListener(s,"click",at.DomEvent.stopPropagation).addListener(s,"click",at.DomEvent.preventDefault).addListener(s,"click",this.toggle,this),s}}),c0=function(e,t){return new Zd(e,t)};var Wd=Bt(Vt());var Ud=Je.extend({options:{title:"Snapshots",collapsed:!0,position:"topleft"},initialize:function(e){Wd.Util.setOptions(this,e),this._className="visiomatic-control",this._id="visiomatic-snapshot",this._sideClass="snapshot"},_initDialog:function(){let e=this,t=this._className,n=this._layer,s=n.visio,a=this._map,r=this._addDialogLine("Snap:",this._dialog),l=this._addDialogElement(r),u=["Screen pixels","Native pixels"];this._snapType=0,this._snapSelect=this._addSelectMenu(this._className+"-select",l,u,void 0,this._snapType,"Select snapshot resolution",function(){this._snapType=parseInt(this._snapSelect.selectedIndex-1,10)});let f=document.createElement("a"),m=this._addButton(t+"-button",l,"snapshot","Take a snapshot of the displayed image",function(v){let y=a.getCenter(),w=a.getPixelBounds(),k=a.options.crs,A=a.getZoom();var E;A>s.maxZoom?(E=Math.pow(2,A-s.maxZoom),A=s.maxZoom):E=1;let D=s.imageSize[A].x*E,z=s.imageSize[A].y*E,V=w.max.x-w.min.x,W=w.max.y-w.min.y;f.href=n.getTileUrl({x:1,y:1}).replace(/JTL\=\d+\,\d+/g,"RGN="+w.min.x/D+","+w.min.y/z+","+V/D+","+W/z+"&WID="+(this._snapType===0?Math.floor(V/E):Math.floor(V/E/n.wcs.scale(A)))+"&CVT=jpeg"),f.download=n._title+"_"+k.latLngToHMSDMS(y).replace(/[\s\:\.]/g,"")+".jpg",f.click()});document.body.appendChild(f);let _=this._addDialogLine("Print:",this._dialog);this._addButton(t+"-button",this._addDialogElement(_),"print","Print current map",function(v){var y=document.querySelector("#map > .leaflet-control-container");y.style.display="none",window.print(),y.style.display="unset"})}}),h0=function(e){return new Ud(e)};var yc={};Kn(yc,{CAR:()=>mc,CEA:()=>gc,COE:()=>pc,Pixel:()=>bc,TAN:()=>Lr,TPV:()=>_c,WCS:()=>Cr,ZEA:()=>vc,wcs:()=>u0});var an=Bt(Vt());var sa=Bt(Vt());var Gt=Bt(Vt());var hs=Gt.Class.extend({bounds:(0,Gt.bounds)([-.5,-.5],[.5,.5]),defaultProjParam:{name:"",ctype:{x:"PIXEL",y:"PIXEL"},naxis:[256,256],crpix:[129,129],crval:[0,0],cd:[[1,0],[0,1]],natpole:[90,999],pv:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],npv:0,jd:[0,0],obslatlng:[0,0]},initialize:function(e,t){if(this._paramUpdate(this.defaultProjParam),this.options=t,this._readWCS(e),t&&this._paramUpdate(t),this._projInit(),projparam=this.projparam,!projparam._pixelFlag){switch(projparam.ctype.x.substr(0,1)){case"G":projparam._celsyscode="galactic";break;case"E":projparam._celsyscode="ecliptic";break;case"S":projparam._celsyscode="supergalactic";break;default:projparam._celsyscode="equatorial";break}this.equatorialFlag=!projparam.nativeCelSys||projparam._celsyscode=="equatorial",this.celSysConvFlag=!projparam.nativeCelSys&&projparam._celsyscode!=="equatorial",this.celSysConvFlag&&(projparam._celsysmat=this._celsysmatInit(this.celsyscode))}},_paramUpdate:function(e){this.projparam||(this.projparam={}),projparam=this.projparam,e.ctype&&(projparam.ctype={x:e.ctype.x,y:e.ctype.y}),e.naxis&&(projparam.naxis=(0,Gt.point)(e.naxis)),e.crval&&(projparam.crval=projparam.cpole=(0,Gt.latLng)(e.crval)),e.crpix&&(projparam.crpix=(0,Gt.point)(e.crpix)),e.cd&&(projparam.cd=[[e.cd[0][0],e.cd[0][1]],[e.cd[1][0],e.cd[1][1]]]),e.natpole&&(projparam.natpole=(0,Gt.latLng)(e.natpole)),e.pv&&(projparam.pv=[],projparam.pv[0]=e.pv[0].slice(),projparam.pv[1]=e.pv[1].slice()),e.npv&&(projparam.npv=(0,Gt.point)(e.npv)),e.jd&&(projparam.jd=[e.jd[0],e.jd[1]]),e.obslatlng&&(projparam.obslatlng=[e.obslatlng[0],e.obslatlng[1]]),projparam.dataslice=e.dataslice?e.dataslice:[[1,projparam.naxis[0],1],[1,projparam.naxis[1],1]],e.detslice&&(projparam.detslice=e.detslice)},_readWCS:function(e){let t=this.projparam,n=-1;var s;this.name=t.name,(s=e.EXTNAME)&&(this.name=s),(s=e.CTYPE1)&&(t.ctype.x=s),(s=e.CTYPE2)&&(t.ctype.y=s),(s=e.NAXIS1)&&(t.naxis.x=s),(s=e.NAXIS2)&&(t.naxis.y=s),(s=e.CRPIX1)&&(t.crpix.x=s),(s=e.CRPIX2)&&(t.crpix.y=s),(s=e.CRVAL1)&&(t.crval.lng=s),(s=e.CRVAL2)&&(t.crval.lat=s),(s=e.LONPOLE)&&(t.natpole.lng=s),(s=e.LATPOLE)&&(t.natpole.lat=s),(s=e.CD1_1)&&(t.cd[0][0]=s),(s=e.CD1_2)&&(t.cd[0][1]=s),(s=e.CD2_1)&&(t.cd[1][0]=s),(s=e.CD2_2)&&(t.cd[1][1]=s);for(var a=0;a<2;a++)for(var r=t.pv[a],l=0;l<40;l++)(s=e["PV"+(a+1)+"_"+l])&&(r[l]=s,n=l>n?l:n);t.npv=n+1,(s=e["MJD-OBS"])||(s=e.MJDSTART)?t.jd[0]=s+24000005e-1:(s=e["DATE-OBS"])&&(t.jd[0]=new Date(s).getTime()/864e5+24405875e-1),(s=e.MJDEND)?t.jd[1]=s+24000005e-1:(s=e.EXPTIME)?t.jd[1]=t.jd[0]+s/86400:t.jd[1]=t.jd[0]+1/86400,(s=e.LONGITUD)&&(t.obslatlng[1]=s),(s=e.LATITUDE)&&(t.obslatlng[0]=s)},_shiftWCS:function(e){let t=e.crpix,n=e.cd,s=e.dataslice,a=e.detslice;t.x=a[0][0]+a[0][2]*(t.x-s[0][0]),t.y=a[1][0]+a[1][2]*(t.y-s[1][0]),n[0][0]*=a[0][2],n[0][1]*=a[1][2],n[1][0]*=a[0][2],n[1][1]*=a[1][2]},_celsysmatInit:function(e){let t=Math.PI/180,n=[];var s,a;switch(e){case"galactic":s=(0,Gt.latLng)(-28.93617242,266.40499625),a=(0,Gt.latLng)(27.1282512,192.85948123);break;case"ecliptic":s=(0,Gt.latLng)(0,0),a=(0,Gt.latLng)(66.99111111,273.85261111);break;case"supergalactic":s=(0,Gt.latLng)(59.52315,42.29235),a=(0,Gt.latLng)(15.7048,283.7514);break;default:s=(0,Gt.latLng)(0,0),a=(0,Gt.latLng)(0,0);break}return n[0]=a.lng*t,n[1]=Math.asin(Math.cos(s.lat*t)*Math.sin((a.lng-s.lng)*t)),n[2]=Math.cos(a.lat*t),n[3]=Math.sin(a.lat*t),n},project:function(e){let t=this._raDecToPhiTheta(this.celSysConvFlag?this.eqToCelSys(e):e);return t.lat=this._thetaToR(t.lat),this._redToPix(this._phiRToRed(t))},unproject:function(e){let t=this._redToPhiR(this._pixToRed(e));t.lat=this._rToTheta(t.lat);let n=this._phiThetaToRADec(t);return n.lng<-180&&(n.lng+=360),this.celSysConvFlag?this.celSysToEq(n):n},celSysToEq:function(e){let t=this.projparam._celsysmat,n=Math.PI/180,s=180/Math.PI,a=e.lng*n-t[1],r=e.lat*n,l=Math.sin(r),u=Math.cos(r)*t[2],f=l*t[3]-u*Math.cos(a);return L.latLng(Math.asin(f)*s,((Math.atan2(u*Math.sin(a),l-f*t[3])+t[0])*s+360)%360)},eqToCelSys:function(e){let t=this.projparam._celsysmat,n=Math.PI/180,s=180/Math.PI,a=e.lng*n-t[0],r=Math.sin(e.lat*n),l=Math.cos(e.lat*n)*t[2],u=r*t[3]+l*Math.cos(a);return L.latLng(Math.asin(u)*s,((Math.atan2(l*Math.sin(a),u*t[3]-r)+t[1])*s+360)%360)},_getCenter(e){let t=this.projparam,n=t.detslice;return n?(0,Gt.point)(n[0][0],n[1][0])._add((0,Gt.point)(n[0][1],n[1][1]))._divideBy(2):(0,Gt.point)((t.naxis.x+1)/2,(t.naxis.y+1)/2)},_natpole:function(){let e=Math.PI/180,t=this.projparam,n=(0,Gt.latLng)(90,180);return t._natrval.lat===90?(t.natpole.lng===999&&(n.lng=180),n.lat=t.crval.lat):t.natpole.lng===999&&(n.lng=t.crval.lat<t._natrval.lat?180:0),n},_cpole:function(){let e=Math.PI/180,t=this.projparam,n=t._natpole.lng-t._natrval.lng,s=Math.cos(n*e),a=Math.sin(n*e),r=Math.cos(t._natrval.lat*e),l=Math.sin(t._natrval.lat*e),u=Math.cos(t.crval.lat*e),f=Math.sin(t.crval.lat*e),m=Math.acos(f/Math.sqrt(1-r*r*a*a))/e,_=Math.atan2(l,r*s)/e,v=_+m,y=_-m;v<-180?v+=360:v>180&&(v-=360),y<-180?y+=360:y>180&&(y-=360),v>90?_=y:y<-90?_=v:_=Math.abs(v-t._natpole.lat)<Math.abs(y-t._natpole.lat)?v:y;let w=Math.abs(t.crval.lat)===90?t.crval.lng:_===90?t.crval.lng+t._natpole.lng-t._natrval.lng-180:_===-90?t.crval.lng-t._natpole.lng+t._natrval.lng:t.crval.lng-Math.atan2(a*r/u,(l-Math.sin(_*e)*f)/(Math.cos(_*e)*u))/e;return(0,Gt.latLng)(_,w)},_phiThetaToRADec:function(e){let t=this.projparam,n=Math.PI/180,s=180/Math.PI,a=e.lat*n,r=Math.cos(a),l=Math.sin(a),u=t._cpole.lat*n,f=Math.cos(u),m=Math.sin(u),_=(e.lng-t._natpole.lng)*n,v=Math.cos(_),y=l*m+r*f*v;return y>1?y=1:y<-1&&(y=-1),(0,Gt.latLng)(Math.asin(y)*s,t._cpole.lng+Math.atan2(-r*Math.sin(_),l*f-r*m*v)*s)},_raDecToPhiTheta:function(e){let t=this.projparam,n=Math.PI/180,s=180/Math.PI,a=(e.lng-t._cpole.lng)*n,r=Math.cos(a),l=Math.sin(a),u=e.lat*n,f=Math.cos(u),m=Math.sin(u),_=t._cpole.lat*n,v=Math.cos(_),y=Math.sin(_),w=m*y+f*v*r,k=(0,Gt.latLng)(Math.asin(w>1?1:w<-1?-1:w)*s,t._natpole.lng+Math.atan2(-f*l,m*v-f*y*r)*s);return k.lng>180?k.lng-=360:k.lng<-180&&(k.lng+=360),k},_pixToRed:function(e){let t=this.projparam,n=t.cd,s=e.subtract(t.crpix);return(0,Gt.point)(s.x*n[0][0]+s.y*n[0][1],s.x*n[1][0]+s.y*n[1][1])},_redToPix:function(e){let t=this.projparam,n=t._cdinv;return(0,Gt.point)(e.x*n[0][0]+e.y*n[0][1],e.x*n[1][0]+e.y*n[1][1]).add(t.crpix)},_pixToMulti:function(e){let t=this.projparam.dataslice,n=this.projparam.detslice;return(0,Gt.point)([(e.x-t[0][0])*n[0][2]+n[0][0],(e.y-t[1][0])*n[1][2]+n[1][0]])},_multiToPix:function(e){let t=this.projparam.dataslice,n=this.projparam.detslice;return(0,Gt.point)([(e.x-n[0][0])*n[0][2]+t[0][0],(e.y-n[1][0])*n[1][2]+t[1][0]])},_invertCD:function(e){let t=1/(e[0][0]*e[1][1]-e[0][1]*e[1][0]);return[[e[1][1]*t,-e[0][1]*t],[-e[1][0]*t,e[0][0]*t]]}});Conical=hs.extend({_redToPhiR:function(e){let t=Math.PI/180,n=this.projparam,s=n._y0-e.y,a=n._sthetaA*Math.sqrt(e.x*e.x+s*s);return(0,sa.latLng)(a,Math.atan2(e.x/a,s/a)/n._c/t)},_phiRToRed:function(e){let t=Math.PI/180,n=this.projparam._c*e.lng*t;return(0,sa.point)(e.lat*Math.sin(n),this.projparam._y0-e.lat*Math.cos(n))}});var pc=Conical.extend({_projInit:function(){let e=Math.PI/180,t=this.projparam;t._cdinv=this._invertCD(t.cd),t._thetaA=t.pv[1][1],t._eta=t.pv[1][2],t._sthetaA=t._thetaA>=0?1:-1;let n=t._thetaA-t._eta,s=t._thetaA+t._eta,a=Math.sin(n*e),r=Math.sin(s*e);t._gamma=a+r,t._s1s2p1=a*r+1,t._c=t._gamma/2,t._y0=2/t._gamma*Math.sqrt(t._s1s2p1-t._gamma*Math.sin(t._thetaA*e))/e,t._natrval=(0,sa.latLng)(t._thetaA,0),t._natpole=this._natpole(),t._cpole=this._cpole(),t._infinite=!0,t._pixelFlag=!1},_rToTheta:function(e){let t=Math.PI/180,n=this.projparam._gamma,s=this.projparam._s1s2p1/n-n*e*e*t*t/4;return s<-1?s=-1:s>1&&(s=1),Math.asin(s)/t},_thetaToR:function(e){let t=Math.PI/180,n=this.projparam._gamma;return 2/n*Math.sqrt(this.projparam._s1s2p1-n*Math.sin(e*t))/t}});var Rs=Bt(Vt());Cylindrical=hs.extend({_projInit:function(){let e=Math.PI/180,t=this.projparam;t._cdinv=this._invertCD(t.cd),t._lambda=t.pv[1][1],t._lambda===0&&(t._lambda=1),t._natrval=(0,Rs.latLng)(0,0),t._natpole=this._natpole(),t._cpole=this._cpole(),t._infinite=!0,t._pixelFlag=!1},_rToTheta:function(e){return e},_thetaToR:function(e){return e}});var mc=Cylindrical.extend({_redToPhiR:function(e){return(0,Rs.latLng)(e.y,e.x)},_phiRToRed:function(e){return(0,Rs.point)(e.lng,e.lat)}}),gc=Cylindrical.extend({_redToPhiR:function(e){let t=Math.PI/180,n=e.y*this.projparam._lambda*t;return(0,Rs.latLng)(n>-1?n<1?Math.asin(n)/t:90:-90,e.x)},_phiRToRed:function(e){let t=Math.PI/180;return(0,Rs.point)(e.lng,Math.sin(e.lat*t)/(this.projparam._lambda*t))}});var us=Bt(Vt());Zenithal=hs.extend({_projInit:function(){let e=this.projparam;e._cdinv=this._invertCD(e.cd),e._natrval=(0,us.latLng)(90,0),e._natpole=this._natpole(),e._cpole=this._cpole(),e._infinite=!0,e._pixelFlag=!1},_redToPhiR:function(e){return(0,us.latLng)(Math.sqrt(e.x*e.x+e.y*e.y),Math.atan2(e.x,-e.y)*180/Math.PI)},_phiRToRed:function(e){let t=Math.PI/180,n=e.lng*t;return(0,us.point)(e.lat*Math.sin(n),-e.lat*Math.cos(n))}});var Lr=Zenithal.extend({code:"TAN",_rToTheta:function(e){return Math.atan2(180,Math.PI*e)*180/Math.PI},_thetaToR:function(e){return Math.tan((90-e)*Math.PI/180)*180/Math.PI}}),_c=Lr.extend({code:"TPV",_pixToRed:function(e){let t=this.projparam,n=t.cd,s=e.subtract(t.crpix);return this._dRedToRed((0,us.point)(s.x*n[0][0]+s.y*n[0][1],s.x*n[1][0]+s.y*n[1][1]))},_redToPix:function(e){let t=this.projparam,n=t._cdinv;return dred=this._redToDRed(e),(0,us.point)(dred.x*n[0][0]+dred.y*n[0][1],dred.x*n[1][0]+dred.y*n[1][1]).add(t.crpix)},_dRedToRed:function(e){let t=this.projparam,n=t.pv[0],s=t.pv[1],a=e.x,r=e.y,l=n[0],u=s[0],f=t.npv;do{if(!--f||(l+=n[1]*a,u+=s[1]*r,!--f)||(l+=n[2]*r,u+=s[2]*a,!--f))break;let m=Math.sqrt(a*a+r*r);if(l+=n[3]*m,u+=s[3]*m,!--f)break;let _=a*a,v=r*r;if(l+=n[4]*_,u+=s[4]*v,!--f)break;let y=a*r;if(l+=n[5]*y,u+=s[5]*y,!--f||(l+=n[6]*v,u+=s[6]*_,!--f))break;let w=_*a,k=v*r;if(l+=n[7]*w,u+=s[7]*k,!--f||(l+=n[8]*_*r,u+=s[8]*v*a,!--f)||(l+=n[9]*a*v,u+=s[9]*r*_,!--f)||(l+=n[10]*k,u+=s[10]*w,!--f))break;let A=m*m*m;if(l+=n[11]*A,u+=s[11]*A,!--f)break;let E=_*_,D=v*v;if(l+=n[12]*E,u+=s[12]*D,!--f||(l+=n[13]*w*r,u+=s[13]*k*a,!--f)||(l+=n[14]*_*v,u+=s[14]*v*_,!--f)||(l+=n[15]*a*k,u+=s[15]*r*w,!--f)||(l+=n[16]*D,u+=s[16]*E,!--f))break;let z=E*a,V=D*r;if(l+=n[17]*z,u+=s[17]*V,!--f||(l+=n[18]*E*r,u+=s[18]*D*a,!--f)||(l+=n[19]*w*v,u+=s[19]*k*_,!--f)||(l+=n[20]*_*k,u+=s[20]*v*w,!--f)||(l+=n[21]*a*D,u+=s[21]*r*E,!--f)||(l+=n[22]*V,u+=s[22]*z,!--f))break;let W=A*m*m;if(l+=n[23]*W,u+=s[23]*W,!--f)break;let H=z*a,X=V*r;if(l+=n[24]*H,u+=s[24]*X,!--f||(l+=n[25]*z*r,u+=s[25]*V*a,!--f)||(l+=n[26]*E*v,u+=s[26]*D*_,!--f)||(l+=n[27]*w*k,u+=s[27]*k*w,!--f)||(l+=n[28]*_*D,u+=s[28]*v*E,!--f)||(l+=n[29]*a*V,u+=s[29]*r*z,!--f)||(l+=n[30]*X,u+=s[30]*H,!--f))break;let $=H*a,G=X*r;if(l+=n[31]*$,u+=s[31]*G,!--f||(l+=n[32]*H*r,u+=s[32]*X*a,!--f)||(l+=n[33]*z*v,u+=s[33]*V*_,!--f)||(l+=n[34]*E*k,u+=s[34]*D*w,!--f)||(l+=n[35]*w*D,u+=s[35]*k*E,!--f)||(l+=n[36]*_*V,u+=s[36]*v*z,!--f)||(l+=n[37]*a*X,u+=s[37]*r*H,!--f)||(l+=n[38]*G,u+=s[38]*$,!--f))break;let B=W*m*m;l+=n[39]*B,u+=s[39]*B}while(!1);return(0,us.point)(l,u)},_redToDRed:function(e){let t=this.projparam,n=e.x,s=e.y,a=e.multiplyBy(2).subtract(this._dRedToRed(e));return a.add(e.subtract(this._dRedToRed(a)))}}),vc=Zenithal.extend({code:"ZEA",_rToTheta:function(e){let t=e*Math.PI/360;return Math.abs(t)<1?90-2*Math.asin(t)*180/Math.PI:90},_thetaToR:function(e){return Math.sin((90-e)*Math.PI/360)*360/Math.PI}});var zs=Bt(Vt());var bc=hs.extend({code:"PIX",_projInit:function(){let e=this.projparam;this.options.crval||(e.crval=(0,zs.latLng)((e.naxis.y+1)/2,(e.naxis.x+1)/2)),e._cdinv=this._invertCD(e.cd),e._cpole=e.crval,this.bounds=(0,zs.bounds)([.5,this.projparam.naxis.y-.5],[this.projparam.naxis.x-.5,.5]),e._pixelFlag=!0,e._infinite=!1},project:function(e){return(0,zs.point)(e.lng,e.lat)},unproject:function(e){return(0,zs.latLng)(e.y,e.x)}});CRSclass=an.Class.extend(an.CRS);var Cr=CRSclass.extend({code:"WCS",options:{nzoom:9,nativeCelSys:!1},initialize:function(e,t,n){let s=t.length;n=an.Util.setOptions(this,n),this.nzoom=n.nzoom,this.projection=this.getProjection(e,n);let a=this.projection;if(s>1){this.projections=new Array(s);for(let[l,u]of t.entries()){var r=this.getProjection(u.header,{nativeCelSys:n.nativeCelSys,dataslice:u.dataslice,detslice:u.detslice});r.name===""&&(r.name="#"+str(l+1)),r.centerPnt=r._getCenter(a),this.projections[l]=r}this.latLngToPoint=this.multiLatLngToPoint,this.pointToLatLng=this.multiPointToLatLng,this.project=this.multiProject,this.unproject=this.multiUnproject}this.naxis=a.projparam.naxis,this.centerLatLng=a.unproject(a._getCenter(a)),this.wrapLng=[.5,this.naxis.x-.5],this.wrapLat=[this.naxis.y-.5,.5],this.transformation=new an.Transformation(1,-.5,-1,this.naxis.y+.5),this.code+=":"+a.code,this.equatorialFlag=a.equatorialFlag,this.celSysCode=a.projparam._celsyscode,this.pixelFlag=a.projparam._pixelFlag,this.infinite=a.projparam._infinite,this.jd=a.projparam.jd,this.obslatlng=a.projparam.obslatlng},transform(e,t){return this.transformation._transform(e,this.scale(t))},untransform(e,t){return this.transformation.untransform(e,this.scale(t))},multiLatLngToPoint(e,t){return this.transform(this.multiProject(e),t)},multiPointToLatLng(e,t){return this.multiUnproject(this.untransform(e,t))},multiProject(e){let t=this.projections[this.multiLatLngToIndex(e)],n=t._pixToMulti(t.project(e)),s=this.projections[this.multiPntToIndex(n)];return s._pixToMulti(s.project(e))},multiUnproject(e){let t=this.projections[this.multiPntToIndex(e)];return t.unproject(t._multiToPix(e))},multiLatLngToIndex(e){return this.multiPntToIndex(this.projection.project(e))},multiPntToIndex(e){let t=1e30,n=-1;for(var s in this.projections){var a=this.projections[s].centerPnt;(d=e.distanceTo(a))<t&&(n=s,t=d)}return n},getProjection:function(e,t){switch((e.CTYPE1||"PIXEL").substr(5,3)){case"ZEA":proj=new vc(e,t);break;case"TAN":proj=new Lr(e,t);break;case"TPV":proj=new _c(e,t);break;case"CAR":proj=new mc(e,t);break;case"CEA":proj=new gc(e,t);break;case"COE":proj=new pc(e,t);break;default:proj=new bc(e,t);break}return proj},scale:function(e){return Math.pow(2,e-this.nzoom+1)},zoom:function(e){return Math.log(e)/Math.LN2+this.nzoom-1},rawPixelScale:function(e){let t=this.projection.project(e),n=this.projection.unproject(t.add([10,0])),s=this.projection.unproject(t.add([0,10])),a=n.lng-e.lng,r=s.lng-e.lng;return a>180?a-=360:a<-180&&(a+=360),r>180?r-=360:r<-180&&(r+=360),.1*Math.sqrt(Math.abs(a*(s.lat-e.lat)-r*(n.lat-e.lat))*Math.cos(e.lat*Math.PI/180))},pixelScale:function(e,t){return this.rawPixelScale(t)/this.scale(e)},fovToZoom:function(e,t,n){let s=e.getSize(),a=this.rawPixelScale(n);return t<a&&(t=a),a*=Math.sqrt(s.x*s.x+s.y*s.y),t>0?this.zoom(a/t):this.nzoom-1},zoomToFov:function(e,t,n){let s=e.getSize(),a=this.rawPixelScale(n)*Math.sqrt(s.x*s.x+s.y*s.y),r=this.scale(t);return r>0?a/r:a},distance:function(e,t){let n=Math.PI/180,s=e.lat*n,a=t.lat*n,r=Math.sin(s)*Math.sin(a)+Math.cos(s)*Math.cos(a)*Math.cos((t.lng-e.lng)*n);return 180/Math.PI*Math.acos(Math.min(r,1))},parseCoords:function(e){let t=this.hmsDMSToLatLng(e);if(typeof t>"u"){let n=/(?:%J\s|^)([-+]?\d+\.?\d*)\s*[,\s]+\s*([-+]?\d+\.?\d*)/g.exec(e);n&&n.length>=3&&(t=(0,an.latLng)(Number(n[2]),Number(n[1])))}if(t)return this.projection.celSysConvFlag&&(t=this.projection.eqToCelSys(t)),t},latLngToHMSDMS:function(e){let t=(e.lng+360)/360;t=(t-Math.floor(t))*24;let n=Math.floor(t),s=(t-n)*60,a=Math.floor(s),r=(s-a)*60;r>=60&&(a++,r=0),a===60&&(n++,a=0);let l=(n<10?"0":"")+n.toString()+":"+(a<10?"0":"")+a.toString()+":"+(r<10?"0":"")+r.toFixed(3),u=Math.abs(e.lat),f=e.lat<0?"-":"+",m=Math.floor(u);return s=(u-m)*60,a=Math.floor(s),r=(s-a)*60,r>=60&&(a++,r=0),a===60&&(n++,a=0),l+" "+f+(m<10?"0":"")+m.toString()+":"+(a<10?"0":"")+a.toString()+":"+(r<10?"0":"")+r.toFixed(2)},hmsDMSToLatLng:function(e){var t;if(t=/^\s*(\d+)[h:](\d+)[m':](\d+\.?\d*)[s"]?\s*,?\s*([-+]?)(\d+)[d:](\d+)[m':](\d+\.?\d*)[s"]?/g.exec(e),t&&t.length>=8){let n=Number(t[4]+"1");return(0,an.latLng)(n*(Number(t[5])+Number(t[6])/60+Number(t[7])/3600),Number(t[1])*15+Number(t[2])/4+Number(t[3])/240)}else return},_deltaLng:function(e,t){let n=e.lng-t.lng;return n>180?n-360:n<-180?n+360:n}}),u0=function(e,t,n){return new Cr(e,t,n)};var xc={};Kn(xc,{VTileLayer:()=>qd,vTileLayer:()=>d0});var Me=Bt(Vt());var qd=Me.TileLayer.extend({options:{title:null,crs:null,nativeCelSys:!1,center:null,fov:null,minZoom:0,maxZoom:null,maxNativeZoom:18,noWrap:!0,brightness:null,contrast:null,colorSaturation:null,gamma:null,cMap:"grey",invertCMap:!1,quality:null,mixingMode:"color",channelColors:[],channelLabels:[],channelLabelMatch:".*",channelUnits:[],minMaxValues:[],defaultChannel:0,framerate:null,sesameURL:"https://cdsweb.u-strasbg.fr/cgi-bin/nph-sesame",credentials:null},visioDefault:{brightness:0,contrast:1,colorSaturation:1.5,gamma:2.2,cMap:"grey",invertCMap:!1,minValue:[],maxValue:[],channelColors:[[""],["#FFFFFF"],["#00BAFF","#FFBA00"],["#0000FF","#00BA00","#FF0000"],["#0000E0","#00BA88","#88BA00","#E00000"],["#0000CA","#007BA8","#00CA00","#A87B00","#CA0000"],["#0000BA","#00719B","#009B71","#719B00","#9B7100","#BA0000"]],quality:90,framerate:1},initialize:function(e,t){return this.type="tilelayer",this._url=e.replace(/\&.*$/g,""),t=Me.Util.setOptions(this,t),t.detectRetina&&L.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom=Math.max(0,t.minZoom),t.maxZoom--),typeof t.subdomains=="string"&&(t.subdomains=t.subdomains.split("")),this.tileSize={x:256,y:256},this.visio={imageSize:[[this.tileSize]],gridSize:[{x:1,y:1}],bpp:8,mixingMode:t.mixingMode,channel:0,nChannel:1,minZoom:t.minZoom,maxZoom:t.maxZoom,brightness:t.brightness,contrast:t.contrast,colorSaturation:t.colorSaturation,gamma:t.gamma,cMap:t.cMap,invertCMap:t.invertCMap,backgroundLevel:[0],backgroundMAD:[1],minValue:[0],maxValue:[255],mix:[[]],rgb:[],channelLabels:[],channelFlags:[],channelUnits:[],quality:t.quality,framerate:t.framerate},this._title=t.title?t.title:this._url.match(/^.*\/(.*)\..*$/)[1],this.getMetaData(this._url),Me.Browser.android||this.on("tileunload",this._onTileRemove),this},getMetaData:async function(e){let t=await fetch(e+"&INFO",{method:"GET"}),n=await t.json();if(t.status==200&&n.type=="visiomatic"){let a=this.options,r=this.visio,l=this.visioDefault,u={x:n.full_size[0],y:n.full_size[1]};this.tileSize={x:n.tile_size[0],y:n.tile_size[1]},a.tileSize=this.tileSize.x,r.maxZoom=n.tile_levels-1,r.minZoom>a.minZoom&&(a.minZoom=r.minZoom),a.maxZoom||(a.maxZoom=r.maxZoom+6),a.maxNativeZoom>r.maxZoom&&(a.maxNativeZoom=r.maxZoom);for(let B=0;B<=r.maxZoom;B++)r.imageSize[B]={x:Math.floor(u.x/Math.pow(2,r.maxZoom-B)),y:Math.floor(u.y/Math.pow(2,r.maxZoom-B))},r.gridSize[B]={x:Math.ceil(r.imageSize[B].x/this.tileSize.x),y:Math.ceil(r.imageSize[B].y/this.tileSize.y)};for(let B=r.maxZoom;B<=a.maxZoom;B++)r.gridSize[B]=r.gridSize[r.maxZoom];r.bpp=n.bits_per_channel,nchannel=r.nChannel=n.channels,n.brightness&&(l.brightness=n.brightness),r.brightness||(r.brightness=l.brightness),n.contrast&&(l.contrast=n.contrast),r.contrast||(r.contrast=l.contrast),n.color_saturation&&(l.colorSaturation=n.color_saturation),r.colorSaturation||(r.colorSaturation=l.colorSaturation),n.gamma&&(l.gamma=n.gamma),r.gamma||(r.gamma=l.gamma),n.quality&&(l.quality=n.quality),r.quality||(r.quality=l.quality),n.framerate&&(l.framerate=n.framerate),r.framerate||(r.framerate=l.framerate),images=n.images;for(let B=0;B<nchannel;B++)r.backgroundLevel[B]=images[0].background_level[B],r.backgroundMAD[B]=images[0].background_mad[B];for(let B=0;B<nchannel;B++)l.minValue[B]=images[0].min_max[B][0],l.maxValue[B]=images[0].min_max[B][1];let f=a.minMaxValues;if(f.length)for(let B=0;B<nchannel;B++)f[B]!==void 0&&f[B].length?(r.minValue[B]=f[B][0],r.maxValue[B]=f[B][1]):(r.minValue[B]=l.minValue[B],r.maxValue[B]=l.maxValue[B]);else for(let B=0;B<nchannel;B++)r.minValue[B]=l.minValue[B],r.maxValue[B]=l.maxValue[B];r.channel=a.defaultChannel;let m=a.channelLabels,_=m.length,v=r.channelLabels,y=a.channelUnits,w=y.length,k=r.channelUnits,A=De.readFITSKey,E="Channel";nchannel===1&&(filter=images[0].header.FILTER)&&(E=filter);for(let B=0;B<nchannel;B++)B<_?v[B]=m[B]:v[B]=nchannel>1?"Channel #"+(B+1).toString():filter;let D=n.header&&(unit=n.header.BUNIT)?unit:"ADU";for(let B in y)k[B]=y[B];for(let B=0;B<nchannel;B++)k[B]||(k[B]=D);let z=r.mix,V=a.channelColors,W=r.rgb,H=new RegExp(a.channelLabelMatch),X=r.channelFlags,$=0,G=0;for(var s=0;s<nchannel;s++)X[s]=H.test(v[s]),X[s]&&G++;if(G>=l.channelColors.length&&(G=l.channelColors.length-1),V.length)for(let B in V)W[B]=Dn(V[B][0],V[B][1],V[B][2]),z[B]=[],this.rgbToMix(B);else W[0]=Dn(l.channelColors[3][0]),W[Math.floor(nchannel/2)]=Dn(l.channelColors[3][1]),W[nchannel-1]=Dn(l.channelColors[3][2]);a.bounds&&(a.bounds=(0,Me.latLngBounds)(a.bounds)),this.wcs=a.crs?a.crs:new Cr(n.header,n.images,{nativeCelSys:this.options.nativeCelSys,nzoom:r.maxZoom+1}),r.metaReady=!0,this.fire("metaload")}else alert("VisiOmatic metadata query error: "+n.detail[0].msg+".")},getChannelColor:function(e){let t=this.visio.rgb;return e in t?this.visio.rgb[e].toStr():""},rgbToMix:function(e,t){let n=this.visio;if(t)n.rgb[e]=t.clone();else if(t==!1){delete n.rgb[e],delete n.mix[e];return}else t=n.rgb[e];let s=this._gammaCorr(t.r),a=this._gammaCorr(t.g),r=this._gammaCorr(t.b),l=(s+a+r)/3,u=n.colorSaturation/3;n.mix[e]=[],n.mix[e][0]=l+u*(2*s-a-r),n.mix[e][1]=l+u*(2*a-s-r),n.mix[e][2]=l+u*(2*r-s-a)},updateMono:function(){this.visio.mixingMode="mono"},updateMix:function(e){let t=e||this,n=t.visio;n.mixingMode="color";for(let s in n.rgb)t.rgbToMix(s)},_gammaCorr:function(e){return e>0?Math.pow(e,this.visio.gamma):0},_readVisioKey:function(e,t,n){return new RegExp(t+":"+n).exec(e)},_setAttr:function(e,t,n=void 0){let s=e.split(/\[|\]/);s[1]?this.visio[s[0]][parseInt(s[1],10)]=t:this.visio[s[0]]=t,n&&n(this),this.redraw()},addTo:function(e){return this.visio.metaReady?this._addToMap(e):(this._loadActivity=Me.DomUtil.create("div","visiomatic-layer-activity",e._controlContainer),this.once("metaload",function(){this._addToMap(e),e._controlContainer.removeChild(this._loadActivity)},this)),this},_addToMap:function(e){let t=this.wcs,n=e.options.crs,s=e._prevcrs,a=e._loaded;var r,l;if(a&&(n._prevLatLng=e.getCenter(),n._prevZoom=e.getZoom()),e._prevcrs=e.options.crs=t,Me.TileLayer.prototype.addTo.call(this,e),s&&t!==n&&a&&t.pixelFlag===n.pixelFlag){l=n._prevLatLng,r=n._prevZoom;let u=s.pixelScale(r,l),f=t.pixelScale(r,l);u>1e-20&&f>1e-20&&(r+=Math.round(Math.LOG2E*Math.log(f/u)))}else if(t._prevLatLng)l=t._prevLatLng,r=t._prevZoom;else if(this.options.center){let u=typeof this.options.center=="string"?t.parseCoords(decodeURI(this.options.center)):this.options.center;u?(this.options.fov&&(r=t.fovToZoom(e,this.options.fov,u)),e.setView(u,r,{reset:!0,animate:!1})):De.requestURL(this.options.sesameURL+"/-oI/A?"+this.options.center,"getting coordinates for "+this.options.center,function(f,m){if(m.readyState===4)if(m.status===200){let _=m.responseText,v=t.parseCoords(_);v?(f.options.fov&&(r=t.fovToZoom(e,f.options.fov,v)),e.setView(v,r,{reset:!0,animate:!1})):(e.setView(t.crval,r,{reset:!0,animate:!1}),alert(_+": Unknown location"))}else e.setView(t.crval,r,{reset:!0,animate:!1}),alert("Error with Sesame query at CDS")},this,10)}else e.setView(t.centerLatLng,r,{reset:!0,animate:!1})},_isValidTile:function(e){let t=this._map.options.crs;if(!t.infinite){let a=this._globalTileRange;if(!t.wrapLng&&(e.x<a.min.x||e.x>a.max.x)||!t.wrapLat&&(e.y<a.min.y||e.y>a.max.y))return!1}let n=this._getZoomForUrl(),s=e.clone();return this._wrapCoords(s),s.x<0||s.x>=this.visio.gridSize[n].x||s.y<0||s.y>=this.visio.gridSize[n].y?!1:this.options.bounds?(0,Me.latLngBounds)(this.options.bounds).intersects(this._tileCoordsToBounds(e)):!0},createTile:function(e,t){let n=Me.TileLayer.prototype.createTile.call(this,e,t);return n.coords=e,n},getTileUrl:function(e){let t=this.visio,n=this.visioDefault,s=this._getZoomForUrl(),a=this._url;t.cMap!==n.cMap&&(a+="&CMP="+t.cMap),t.invertCMap!==n.invertCMap&&(a+="&INV"),t.brightness!==n.brightness&&(a+="&BRT="+t.brightness.toString()),t.contrast!==n.contrast&&(a+="&CNT="+t.contrast.toString()),t.gamma!==n.gamma&&(a+="&GAM="+(1/t.gamma).toFixed(4));let r=t.nChannel,l=t.mix;if(t.mixingMode==="color"){for(let u=0;u<t.nChannel;u++)(t.minValue[u]!==n.minValue[u]||t.maxValue[u]!==n.maxValue[u])&&(a+="&MINMAX="+(u+1).toString()+":"+t.minValue[u].toString()+","+t.maxValue[u].toString());for(let u in l){a+="&MIX="+(parseInt(u,10)+1).toString()+":";for(let f=0;f<3;f++)f&&(a+=","),a+=l[u][f].toFixed(3)}}else{let u=t.channel,f=u+1;f>r&&(f=1),a+="&CHAN="+f.toString(),(t.minValue[u]!==n.minValue[u]||t.maxValue[u]!==n.maxValue[u])&&(a+="&MINMAX="+f.toString()+":"+t.minValue[u].toString()+","+t.maxValue[u].toString())}return t.quality!==n.quality&&(a+="&QLT="+t.quality.toString()),a+"&JTL="+s.toString()+","+(e.x+t.gridSize[s].x*e.y).toString()},_initTile:function(e){Me.DomUtil.addClass(e,"leaflet-tile"),this._tileZoom>=this.options.maxNativeZoom&&(e.style.imageRendering="pixelated"),e.onselectstart=Me.Util.falseFn,e.onmousemove=Me.Util.falseFn,Me.Browser.ielt9&&this.options.opacity<1&&Me.DomUtil.setOpacity(e,this.options.opacity),Me.Browser.android&&!Me.Browser.android23&&(e.style.WebkitBackfaceVisibility="hidden")},_refreshTileUrl:function(e,t){let n=new Image;n.onload=function(){L.Util.requestAnimFrame(function(){e.el.src=t})},n.src=t},redraw:function(){let e=this._map._fadeAnimated;this._map._fadeAnimated=!1;for(var t in this._tiles)if(tile=this._tiles[t],tile.current&&tile.active){let n=tile.el.src,s=this.getTileUrl(tile.coords);n!=s&&this._refreshTileUrl(tile,s)}e&&setTimeout(function(){map._fadeAnimated=e},1e6)}}),d0=function(e,t){return new qd(e,t)};function f0(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var p0=f0();p0.V=wc;})();
/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */
/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */
/*!
 * Chart.js v4.3.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */
/*!
* chartjs-plugin-zoom v2.0.1
* undefined
 * (c) 2016-2023 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
/**
 * spectrum-vanilla.js
 *
 * @copyright  Copyright (C) 2023.
 * @license    MIT
 */
